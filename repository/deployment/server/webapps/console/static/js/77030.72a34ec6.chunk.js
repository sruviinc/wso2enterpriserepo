"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[77030],{77030:(e,t,n)=>{n.r(t),n.d(t,{RoleGroupsList:()=>x});var l=n(14603),r=n(90268),o=n(81816),a=n(39345),s=n(24285),i=n(26109),u=n(67127),c=n(52983),d=n(9202),p=n(54221),m=n(21921),f=n(94635),g=n(10594),h=n(73949),v=n(75917),y=n(14969),b=n(74691),E=n(88171),S=n(30640),C=n(79232),Z=n(85814);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==O(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var l=n.call(e,t||"default");if("object"!==O(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===O(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||j(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,r,o,a,s=[],i=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(l=o.call(n)).done)&&(s.push(l.value),s.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}(e,t)||j(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}var x=function(e){var t=e.role,n=e.onRoleUpdate,O=e.isReadOnly,w=(0,d.$)().t,I=(0,p.I0)(),j=k((0,c.useState)(!1),2),L=j[0],x=j[1],A=k((0,c.useState)([]),2),H=A[0],T=A[1],U=k((0,c.useState)([]),2),N=U[0],D=U[1],G=k((0,c.useState)([]),2),M=G[0],z=G[1],F=k((0,c.useState)([]),2),J=F[0],$=F[1],_=k((0,c.useState)(void 0),2),q=_[0],Q=_[1],X=k((0,c.useState)(void 0),2),K=X[0],B=X[1],V=k((0,c.useState)([]),2),W=V[0],Y=V[1],ee=k((0,c.useState)([]),2),te=ee[0],ne=ee[1],le=k((0,c.useState)(!1),2),re=le[0],oe=le[1],ae=k((0,c.useState)(!1),2),se=ae[0],ie=ae[1],ue=k((0,c.useState)([]),2),ce=ue[0],de=ue[1],pe=k((0,c.useState)(!1),2),me=pe[0],fe=pe[1],ge=k((0,o.IK)(),3),he=ge[0],ve=ge[1],ye=ge[2];(0,c.useEffect)((function(){t&&(be(),de(t.groups))}),[]),(0,c.useEffect)((function(){ne(se?N:[])}),[se]),(0,c.useEffect)((function(){Y(re?H:[])}),[re]),(0,c.useEffect)((function(){t&&(be(),de(t.groups))}),[t]),(0,c.useEffect)((function(){(0,C.hI)(null).then((function(e){Q(e.data.Resources)}))}),[]);var be=function(){var e=new Map;t.groups&&t.groups instanceof Array?((0,i.Z)(t.groups,(function(t){var n=t.display.split("/");n[0]!==Z.Fn&&n[0]!==Z.eT&&e.set(t.display,t.value)})),B(e)):B(void 0)},Ee=function(){oe(!re)},Se=function(){ie(!se)},Ce=function(){var e=P(N);(null==W?void 0:W.length)>0&&W.map((function(t){null!=N&&N.includes(t)||e.push(t)})),D(e),$(e),T(H.filter((function(t){return!(null!=e&&e.includes(t))}))),z(H.filter((function(t){return!(null!=e&&e.includes(t))}))),ne([]),oe(!1)},Ze=function(){var e=P(H);(null==te?void 0:te.length)>0&&te.map((function(t){null!=H&&H.includes(t)||e.push(t)})),T(e),z(e),D(null==N?void 0:N.filter((function(t){return!(null!=e&&e.includes(t))}))),$(null==N?void 0:N.filter((function(t){return!(null!=e&&e.includes(t))}))),Y([]),ie(!1)},Oe=function(){!function(){var e=q?P(q):[],t=[];if(e&&K){var n=Array.from(null==K?void 0:K.values());(0,s.Z)(e,(function(e){n.includes(null==e?void 0:e.id)&&t.push(e)}))}D(t),$(t),T(e.filter((function(e){return!(null!=t&&t.includes(e))}))),z(e.filter((function(e){return!(null!=t&&t.includes(e))})))}(),x(!0)},we=function(){x(!1)},Re=function(e){var t=e.value,n=[];if((0,u.Z)(t))T(M);else{var l=new RegExp((0,a.Z)(t),"i");H&&H.map((function(e){l.test(e.displayName)&&(n.push(e),T(n))}))}},Ie=function(e){var t=e.value,n=[];if((0,u.Z)(t))D(J);else{var l=new RegExp((0,a.Z)(t),"i");N&&(null==N||N.map((function(e){l.test(e.displayName)&&(n.push(e),D(n))})))}},Pe=function(e){var t=null==e?void 0:e.split("/"),n={labelColor:"olive",labelText:Z.$R};return t[0]!==Z.Fn&&t[0]!==Z.eT&&(null==t?void 0:t.length)>1&&(n=R(R({},n),{},{labelText:t[0]})),n},ke=function(e){var t,n=null===(t=e)||void 0===t?void 0:t.split("/");return 1!==(null==n?void 0:n.length)&&(e=n[1]),e};return c.createElement(c.Fragment,null,c.createElement(o.X6,{as:"h4"},w("console:manage.features.roles.edit.groups.heading"),c.createElement(o.X6,{subHeading:!0,ellipsis:!0,as:"h6"},w("console:manage.features.roles.edit.groups.subHeading"))),c.createElement(v.Z,{hidden:!0}),c.createElement(f.Z,null,c.createElement(f.Z.Row,null,c.createElement(f.Z.Column,{computer:8},(null==K?void 0:K.size)>0?c.createElement(o.pJ,{"data-testid":"role-mgt-groups-list",className:"user-role-edit-header-segment"},c.createElement(f.Z.Row,null,c.createElement(f.Z.Column,null,c.createElement(y.Z,{"data-testid":"role-mgt-groups-list-search-input",icon:c.createElement(b.Z,{name:"search"}),onChange:function(e){var n=e.value,l=[];if((0,u.Z)(n))de(t.groups);else{var r=new RegExp((0,a.Z)(n),"i");ce&&(null==ce||ce.map((function(e){1===e.display.split("/").length&&r.test(e.display)&&(l.push(e),de(l))})))}},placeholder:w("console:manage.features.user.updateUser.groups.editGroups.searchPlaceholder"),floated:"left",size:"small"}),!O&&c.createElement(E.Z,{"data-testid":"role-mgt-groups-list-update-button",size:"medium",icon:"pencil",floated:"right",onClick:Oe}))),c.createElement(f.Z.Row,null,c.createElement(g.Z,{singleLine:!0,compact:!0},c.createElement(g.Z.Header,null,c.createElement(g.Z.Row,null,c.createElement(g.Z.HeaderCell,null,c.createElement("strong",null,w("console:manage.features.user.updateUser.groups.editGroups.groupList.headers.0"))),c.createElement(g.Z.HeaderCell,null,c.createElement("strong",null,w("console:manage.features.user.updateUser.groups.editGroups.groupList.headers.1"))))),c.createElement(g.Z.Body,null,null==ce?void 0:ce.map((function(e,t){var n,l=null==e||null===(n=e.display)||void 0===n?void 0:n.split("/");if(l[0]!==Z.Fn&&l[0]!==Z.eT)return c.createElement(g.Z.Row,{key:t},c.createElement(g.Z.Cell,null,1===(null==l?void 0:l.length)?c.createElement(h.Z,{color:"olive"},Z.$R):c.createElement(h.Z,{color:"olive"},l[0])),c.createElement(g.Z.Cell,null,1===(null==l?void 0:l.length)?null==e?void 0:e.display:l[1]))})))))):c.createElement(o.pJ,null,c.createElement(o.$J,{"data-testid":"role-mgt-empty-groups-list",title:w("console:manage.features.roles.edit.groups.placeholders.emptyPlaceholder.title"),subtitle:[w("console:manage.features.roles.edit.groups.emptyPlaceholder.subtitles")],action:!O&&c.createElement(o.KM,{"data-testid":"role-mgt-empty-groups-list-assign-group-button",icon:"plus",onClick:Oe},w("console:manage.features.roles.edit.groups.placeholders.emptyPlaceholder.action")),image:(0,S.jF)().emptyList,imageSize:"tiny"}))))),c.createElement(m.Z,{"data-testid":"role-mgt-update-groups-modal",open:L,size:"small",className:"user-roles"},c.createElement(m.Z.Header,null,w("console:manage.features.roles.edit.groups.addGroupsModal.heading"),c.createElement(o.X6,{subHeading:!0,ellipsis:!0,as:"h6"},w("console:manage.features.roles.edit.groups.addGroupsModal.subHeading"))),c.createElement(m.Z.Content,{image:!0},he&&ye,c.createElement(o.IX,{searchPlaceholder:w("console:manage.features.transferList.searchPlaceholder",{type:"groups"}),addItems:Ce,removeItems:Ze,handleUnelectedListSearch:Re,handleSelectedListSearch:Ie,"data-testid":"role-mgt-update-groups-modal"},c.createElement(o.Jv,{isListEmpty:!((null==H?void 0:H.length)>0),listType:"unselected",listHeaders:[w("console:manage.features.transferList.list.headers.0"),w("console:manage.features.transferList.list.headers.1"),""],handleHeaderCheckboxChange:Ee,isHeaderCheckboxChecked:re,emptyPlaceholderContent:w("console:manage.features.transferList.list.emptyPlaceholders.roles.unselected",{type:"groups"}),"data-testid":"role-mgt-update-groups-modal-unselected-groups-select-all-checkbox",emptyPlaceholderDefaultContent:w("console:manage.features.transferList.list.emptyPlaceholders.default")},null==H?void 0:H.map((function(e,t){return c.createElement(o.qT,{handleItemChange:function(){return function(e){var t=P(W);null!=t&&t.includes(e)?(t.splice(t.indexOf(e),1),Y(t)):(t.push(e),Y(t))}(e)},key:t,listItem:ke(null==e?void 0:e.displayName),listItemId:e.id,listItemIndex:t,listItemTypeLabel:Pe(null==e?void 0:e.displayName),isItemChecked:W.includes(e),showSecondaryActions:!1,"data-testid":"role-mgt-update-groups-modal-unselected-groups"})}))),c.createElement(o.Jv,{isListEmpty:!((null==N?void 0:N.length)>0),listType:"selected",listHeaders:[w("console:manage.features.transferList.list.headers.0"),w("console:manage.features.transferList.list.headers.1")],handleHeaderCheckboxChange:Se,isHeaderCheckboxChecked:se,emptyPlaceholderContent:w("console:manage.features.transferList.list.emptyPlaceholders.roles.selected",{type:"groups"}),"data-testid":"role-mgt-update-groups-modal-selected-groups-select-all-checkbox",emptyPlaceholderDefaultContent:w("console:manage.features.transferList.list.emptyPlaceholders.default")},null==N?void 0:N.map((function(e,t){return c.createElement(o.qT,{handleItemChange:function(){return function(e){var t=P(te);null!=t&&t.includes(e)?(t.splice(t.indexOf(e),1),ne(t)):(t.push(e),ne(t))}(e)},key:t,listItem:ke(null==e?void 0:e.displayName),listItemId:null==e?void 0:e.id,listItemIndex:t,listItemTypeLabel:Pe(null==e?void 0:e.displayName),isItemChecked:te.includes(e),showSecondaryActions:!1,"data-testid":"role-mgt-update-groups-modal-selected-groups"})}))))),c.createElement(m.Z.Actions,null,c.createElement(f.Z,null,c.createElement(f.Z.Row,{columns:2},c.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},c.createElement(o.Qj,{"data-testid":"role-mgt-update-groups-modal-cancel-button",floated:"left",onClick:we},w("common:cancel"))),c.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},c.createElement(o.KM,{"data-testid":"role-mgt-update-groups-modal-save-button",floated:"right",loading:me,disabled:me,onClick:function(){return function(e,t){var o,a=[];t.map((function(e){a.push(e.id)}));var s,i,u={Operations:[],failOnErrors:1,schemas:["urn:ietf:params:scim:api:messages:2.0:BulkRequest"]},c={data:{Operations:[]},method:"PATCH",path:"/Roles/"+e.id},d=[],p=[],m=[],f=[];K&&(m=P(K.values())),(null==a?void 0:a.length)>0&&a.map((function(e){var t;null!==(t=m)&&void 0!==t&&t.includes(e)?m.splice(m.indexOf(e),1):f.push(e)})),m&&(null===(o=m)||void 0===o?void 0:o.length)>0&&(m.map((function(e){var t={op:"remove",path:"groups[value eq ".concat(e,"]")};d.push(t)})),(s=c.data.Operations).push.apply(s,d),u.Operations.push(c)),f&&(null==f?void 0:f.length)>0&&(f.map((function(e){p.push({op:"add",value:{groups:[{value:e}]}})})),(i=c.data.Operations).push.apply(i,p),u.Operations.push(c)),fe(!0),(0,S.fU)(u).then((function(){I((0,r.V_)({description:w("console:manage.features.roles.notifications.updateRole.success.description"),level:l.QU.SUCCESS,message:w("console:manage.features.roles.notifications.updateRole.success.message")})),we(),n(e.id)})).catch((function(e){var t,n,r,o,a,s;404!==(null==e||null===(t=e.response)||void 0===t?void 0:t.status)&&(null!=e&&e.response&&null!=e&&null!==(n=e.response)&&void 0!==n&&n.data&&null!=e&&null!==(r=e.response)&&void 0!==r&&null!==(o=r.data)&&void 0!==o&&o.description?ve({description:null===(a=e.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.description,level:l.QU.ERROR,message:w("console:manage.features.roles.notifications.updateRole.error.message")}):ve({description:w("console:manage.features.roles.notifications.updateRole.genericError.description"),level:l.QU.ERROR,message:w("console:manage.features.roles.notifications.updateRole.genericError.message")}))})).finally((function(){fe(!1)}))}(t,N)}},w("common:save"))))))))}}}]);