"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[5910],{5910:(e,n,t)=>{t.r(n),t.d(n,{ConsumerUserProfile:()=>q});var a=t(7955),r=t(96433),o=t(83374),i=t(14603),s=t(90268),l=t(83831),c=t(13318),u=t(81816),d=t(67127),m=t(6901),f=t.n(m),p=t(52983),g=t(9202),C=t(39990),E=t(54221),v=t(94635),S=t(16029),b=t(14969),A=t(88171),_=t(75917),I=t(30967),y=t(2653),h=t(30640),O=t(80617),U=t(26021),M=t(39872),T=t(9447),R=t(7502),N=t(85585),D=t(67680),L=t(99839),H=t(28438);function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function k(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||V(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=V(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}function w(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?w(Object(t),!0).forEach((function(n){x(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function x(e,n,t){return(n=function(e){var n=function(e,n){if("object"!==Z(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var a=t.call(e,n||"default");if("object"!==Z(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===Z(n)?n:String(n)}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function F(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,r,o,i,s=[],l=!0,c=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(a=o.call(t)).done)&&(s.push(a.value),s.length!==n);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(c)throw r}}return s}}(e,n)||V(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function V(e,n){if(e){if("string"==typeof e)return B(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?B(e,n):void 0}}function B(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var q=function(e){var n,t,m,Z,w,V,B=e.onAlertFired,q=e.user,j=e.handleUserUpdate,G=e.isReadOnly,W=e.isUserProfileLoading,K=e.featureConfig,Q=e.isReadOnlyUserStore,z=e.connectorProperties,J=e["data-testid"],X=(0,g.$)().t,$=(0,E.I0)(),ee=(0,p.useRef)([]),ne=(0,E.v9)((function(e){return e.profile.profileSchemas})),te=(0,E.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),ae=(0,E.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.username})),re=(0,E.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.isPrivilegedUser})),oe=F((0,p.useState)(new Map),2),ie=oe[0],se=oe[1],le=F((0,p.useState)(),2),ce=le[0],ue=le[1],de=F((0,p.useState)(!1),2),me=de[0],fe=de[1],pe=F((0,p.useState)(void 0),2),ge=pe[0],Ce=pe[1],Ee=F((0,p.useState)(void 0),2),ve=Ee[0],Se=Ee[1],be=F((0,p.useState)(!1),2),Ae=be[0],_e=be[1],Ie=F((0,p.useState)(!1),2),ye=Ie[0],he=Ie[1],Oe=F((0,p.useState)(!1),2),Ue=Oe[0],Me=Oe[1],Te=F((0,p.useState)({accountDisable:"false",accountLock:"false",forcePasswordReset:"false"}),2),Re=Te[0],Ne=Te[1],De=F((0,p.useState)(!1),2),Le=De[0],He=De[1],Ze=F((0,p.useState)(!1),2),ke=Ze[0],Pe=Ze[1],we=F((0,p.useState)(void 0),2),Ye=we[0],xe=we[1],Fe=F((0,p.useState)(void 0),2),Ve=Fe[0],Be=Fe[1],qe=F((0,p.useState)(void 0),2),je=qe[0],Ge=qe[1],We=F((0,p.useState)([]),2),Ke=We[0],Qe=We[1],ze=F((0,p.useState)(void 0),2),Je=ze[0],Xe=ze[1],$e=F((0,p.useState)(!0),2),en=$e[0],nn=$e[1],tn=F((0,p.useState)(!0),2),an=tn[0],rn=tn[1],on=F((0,p.useState)(void 0),2),sn=on[0],ln=on[1],cn=F((0,p.useState)(void 0),2),un=cn[0],dn=cn[1],mn=null==q||null===(n=q.meta)||void 0===n?void 0:n.created,fn=null==q||null===(t=q.meta)||void 0===t?void 0:t.lastModified,pn=(0,N.W)().data;(0,p.useEffect)((function(){pn&&(ln((0,T.P_)(pn)),dn((0,R.t)(pn)))}),[pn]),(0,p.useEffect)((function(){if(z&&Array.isArray(z)&&(null==z?void 0:z.length)>0){var e,n=Y({},Re),t=P(z);try{for(t.s();!(e=t.n()).done;){var a=e.value;a.name===O.vH.ACCOUNT_DISABLING_ENABLE?n=Y(Y({},n),{},{accountDisable:a.value}):a.name===O.vH.RECOVERY_LINK_PASSWORD_RESET||a.name===O.vH.OTP_PASSWORD_RESET||a.name===O.vH.OFFLINE_PASSWORD_RESET?"true"===a.value&&(n=Y(Y({},n),{},{forcePasswordReset:a.value})):a.name===O.vH.ACCOUNT_LOCK_ON_CREATION&&(n=Y(Y({},n),{},{accountLock:a.value}))}}catch(r){t.e(r)}finally{t.f()}Ne(n)}}),[z]),(0,p.useEffect)((function(){if(void 0!==(null==q?void 0:q.id)){var e=M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ONETIME_PASSWORD");(0,U.M_)(null==q?void 0:q.id,e).then((function(e){var n;Ge(null===(n=e[r.Cb.SCIM2_WSO2_USER_SCHEMA])||void 0===n?void 0:n.oneTimePassword)}))}}),[ke]),(0,p.useEffect)((function(){if(void 0!==(null==q?void 0:q.id)){var e=M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")+","+M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_DISABLED")+","+M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ONETIME_PASSWORD");(0,U.M_)(null==q?void 0:q.id,e).then((function(e){var n,t,a;xe(null===(n=e[r.Cb.SCIM2_WSO2_USER_SCHEMA])||void 0===n?void 0:n.accountLocked),Be(null===(t=e[r.Cb.SCIM2_WSO2_USER_SCHEMA])||void 0===t?void 0:t.accountDisabled),Ge(null===(a=e[r.Cb.SCIM2_WSO2_USER_SCHEMA])||void 0===a?void 0:a.oneTimePassword)}))}}),[q]),(0,p.useEffect)((function(){void 0!==q&&Xe(q[D.SCIMConfigs.scim.enterpriseSchema])}),[q]),(0,p.useEffect)((function(){Qe(l.CommonUtils.getCountryList())}),[]);var gn=(0,p.useCallback)((function(e){null!==e&&(e.children[0].children[1].children[0].role="presentation")}),[]);(0,p.useEffect)((function(){(0,d.Z)(ce)||(0,d.Z)(ie)||!Je||hn()}),[ie,Je]);(0,p.useEffect)((function(){var e,n=null===(e=l.ProfileUtils.flattenSchemas(k(ne)))||void 0===e?void 0:e.sort((function(e,n){return e.displayOrder?n.displayOrder?parseInt(e.displayOrder,10)-parseInt(n.displayOrder,10):1:-1}));ue(n)}),[ne]),(0,p.useEffect)((function(){!function(e,n){if(!(0,d.Z)(ce)&&!(0,d.Z)(n)){var t=new Map;e.forEach((function(e){var a=e.name.split("."),o=!1,i=a[0].split("#");if(1!==i.length&&(o=!0),1===a.length)if("emails"===a[0]){if(l.ProfileUtils.isStringArray(n[a[0]])){var s=n[a[0]].find((function(e){return"string"==typeof e}));t.set(e.name,s)}}else{if(e.extended&&n[r.Cb.SCIM2_ENT_USER_SCHEMA]&&n[r.Cb.SCIM2_ENT_USER_SCHEMA][a[0]])return void t.set(e.name,n[r.Cb.SCIM2_ENT_USER_SCHEMA][a[0]]);if(e.extended&&n[r.Cb.SCIM2_WSO2_CUSTOM_SCHEMA]&&n[r.Cb.SCIM2_WSO2_CUSTOM_SCHEMA][a[0]])return void t.set(e.name,n[r.Cb.SCIM2_WSO2_CUSTOM_SCHEMA][a[0]]);t.set(e.name,n[a[0]])}else if(o){var c,u=-1;if(null===(c=n[i[0]])||void 0===c||c.forEach((function(e){i[1]===(null==e?void 0:e.type)&&(u=n[i[0]].indexOf(e))})),u>-1){var d=n[i[0]][u][a[1]];"addresses"===i[0]&&t.set(e.name,d)}}else if("name"===a[0])a[1]&&n[a[0]]&&n[a[0]][a[1]]&&t.set(e.name,n[a[0]][a[1]]);else{var m=n[a[0]]&&Array.isArray(n[a[0]])&&n[a[0]].find((function(e){return e.type===a[1]}));if("addresses"===a[0])t.set(e.name,m?m.formatted:"");else if(e.extended){if(n[r.Cb.SCIM2_ENT_USER_SCHEMA]&&n[r.Cb.SCIM2_ENT_USER_SCHEMA][a[0]])return void t.set(e.name,n[r.Cb.SCIM2_ENT_USER_SCHEMA][a[0]][a[1]])}else t.set(e.name,m?m.value:"")}})),se(t)}}(ce,q)}),[ce,q]);var Cn,En,vn,Sn,bn,An=function(e){return e.name&&(e.name.givenName||e.name.familyName)?((0,d.Z)(e.name.givenName)?"":e.name.givenName+" ")+((0,d.Z)(e.name.familyName)?"":e.name.familyName):e.emails&&void 0!==e.emails?void(0,o.r1)(null==e?void 0:e.emails):e.userName},_n=function(e){var n,t,a,r,o,i;(Se({name:null==e||null===(n=e.target)||void 0===n?void 0:n.id,value:null==e||null===(t=e.target)||void 0===t?void 0:t.checked}),null!=e&&null!==(a=e.target)&&void 0!==a&&a.checked)?(null==e||null===(r=e.target)||void 0===r?void 0:r.id)===M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")?he(!0):_e(!0):(He(!0),In(null==e||null===(o=e.target)||void 0===o?void 0:o.id,null==e||null===(i=e.target)||void 0===i?void 0:i.checked).finally((function(){He(!1),_e(!1),Se(void 0)})))},In=function(e,n){e===M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")&&(he(!1),xe(n.toString()));var t={Operations:[{op:"replace",value:x({},r.Cb.SCIM2_WSO2_USER_SCHEMA,x({},e.split(".")[1],n))}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]};return(0,U.gS)(q.id,t).then((function(){B({description:e===M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")?X(n?"console:manage.features.user.profile.notifications.lockUserAccount.success.description":"console:manage.features.user.profile.notifications.unlockUserAccount.success.description"):X(n?"console:manage.features.user.profile.notifications.disableUserAccount.success.description":"console:manage.features.user.profile.notifications.enableUserAccount.success.description"),level:i.QU.SUCCESS,message:e===M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")?n?(0,d.Z)(An(q))?X("console:manage.features.user.profile.notifications.lockUserAccount.success.genericMessage"):X("console:manage.features.user.profile.notifications.lockUserAccount.success.message",{name:An(q)}):(0,d.Z)(An(q))?X("console:manage.features.user.profile.notifications.unlockUserAccount.success.genericMessage"):X("console:manage.features.user.profile.notifications.unlockUserAccount.success.message",{name:An(q)}):n?(0,d.Z)(An(q))?X("console:manage.features.user.profile.notifications.disableUserAccount.success.genericMessage"):X("console:manage.features.user.profile.notifications.disableUserAccount.success.message",{name:An(q)}):(0,d.Z)(An(q))?X("console:manage.features.user.profile.notifications.enableUserAccount.success.genericMessage"):X("console:manage.features.user.profile.notifications.enableUserAccount.success.message",{name:An(q)})}),j(q.id)})).catch((function(n){n.response&&n.response.data&&n.response.data.description?B({description:n.response.data.description,level:i.QU.ERROR,message:e===M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")?X("console:manage.features.user.profile.notifications.lockUserAccount.error.message"):X("console:manage.features.user.profile.notifications.disableUserAccount.error.message")}):B({description:(null==ve?void 0:ve.name)===M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")?X("console:manage.features.user.profile.notifications.lockUserAccount.genericError.description"):X("console:manage.features.user.profile.notifications.disableUserAccount.genericError.description"),level:i.QU.ERROR,message:(null==ve?void 0:ve.name)===M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED")?X("console:manage.features.user.profile.notifications.lockUserAccount.genericError.message"):X("console:manage.features.user.profile.notifications.disableUserAccount.genericError.message")})}))},yn=function(e){return!(0,d.Z)(ie.get(e.name))||!G&&e.mutability!==r.Cb.READONLY_SCHEMA},hn=function(){var e,n=P(ce);try{for(n.s();!(e=n.n()).done;){var t=e.value;if(r.Cb&&t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ROLES_DEFAULT")&&t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("GROUPS")&&t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("PROFILE_URL")&&t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ACCOUNT_LOCKED")&&t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ACCOUNT_DISABLED")&&t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ONETIME_PASSWORD")&&t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("EMAILS"))if((0,d.Z)(null==Je?void 0:Je.userSourceId)){if(yn(t)){nn(!1);break}}else if(t.name!==r.Cb.SCIM2_SCHEMA_DICTIONARY.get("USERNAME")&&!(0,d.Z)(ie.get(t.name))){nn(!1);break}}}catch(a){n.e(a)}finally{n.f()}},On=function(e){ee.current.find((function(n){return(null==n?void 0:n.id)===e})).scrollIntoView({behavior:"smooth",block:"center"})},Un=function(e,n,t){return e&&(e.id=n),ee.current[t]=e,e},Mn=function(e,n){var t;if("userName"!==e.name||(0,d.Z)(null==Je?void 0:Je.userSourceId)){var a=X("console:manage.features.user.profile.fields."+e.name.replace(".","_"),{defaultValue:e.displayName}),o=null==ie||null===(t=ie.get(e.name))||void 0===t?void 0:t.toString().split("/");return p.createElement(v.Z.Row,{columns:1,key:n},p.createElement(v.Z.Column,{mobile:12,tablet:12,computer:6},"userName"===e.name&&o.length>1&&(0,d.Z)(null==Je?void 0:Je.userSourceId)?p.createElement(S.Z.Field,{ref:function(t){return Un(t,e.name,n)}},p.createElement("label",null,"false"===(null==un?void 0:un.enableValidator)?"Email ("+a+")":a),p.createElement(b.Z,{"data-testid":"".concat(J,"-profile-form-").concat(e.name,"-input"),name:e.name,required:e.required,requiredErrorMessage:a+" is required",placeholder:"Enter the "+a,type:"text",value:o[1],key:n,readOnly:G||e.mutability===r.Cb.READONLY_SCHEMA||"userName"===e.name,maxLength:e.maxLength?e.maxLength:r.Cb.CLAIM_VALUE_MAX_LENGTH})):function(e,n,t){if("BOOLEAN"===e.type.toUpperCase())return p.createElement(c.gN,{"data-testid":"".concat(J,"-profile-form-").concat(e.name,"-input"),name:e.name,required:e.required,requiredErrorMessage:n+" is required",type:"checkbox",value:ie.get(e.name)?[e.name]:[],children:[{label:n,value:e.name}],readOnly:G||e.mutability===r.Cb.READONLY_SCHEMA,key:t,ref:function(n){return Un(n,e.name,t)}});if("country"===e.name)return p.createElement(c.gN,{"data-testid":"".concat(J,"-profile-form-").concat(e.name,"-input"),name:e.name,label:n,required:e.required,requiredErrorMessage:n+" is required",placeholder:"Select the "+n,type:"dropdown",value:ie.get(e.name),children:[{"data-testid":"".concat(J,"-profile-form-country-dropdown-empty"),key:"empty-country",text:"Select your country",value:""}].concat(Ke?Ke.map((function(e){return{"data-testid":"".concat(J,"-profile-form-country-dropdown-")+e.value,flag:e.flag,key:e.key,text:e.text,value:e.value}})):[]),key:t,disabled:!1,readOnly:G||e.mutability===r.Cb.READONLY_SCHEMA,clearable:!e.required,ref:function(n){Un(n,e.name,t),gn(n)},search:!0,selection:!0,fluid:!0,scrolling:!0});if("dateOfBirth"===e.name){var a="".concat(X("console:manage.features.user.editUser.dateOfBirth.placeholder.part1")," ").concat(n," ").concat(X("console:manage.features.user.editUser.dateOfBirth.placeholder.part2"));return p.createElement(c.gN,{"data-testid":"".concat(J,"-profile-form-").concat(e.name,"-input"),name:e.name,label:n,required:e.required,requiredErrorMessage:n+" is required",placeholder:a,type:"text",value:ie.get(e.name),key:t,disabled:!1,readOnly:G||e.mutability===r.Cb.READONLY_SCHEMA,validation:function(e,t){f()(e,"YYYY-MM-DD",!0).isValid()?f()().isBefore(e)&&(t.isValid=!1,t.errorMessages.push(X("console:manage.features.users.forms.validation.futureDateError",{field:n}))):(t.isValid=!1,t.errorMessages.push(X("console:manage.features.users.forms.validation.dateFormatError",{field:n})))},maxLength:e.maxLength?e.maxLength:r.Cb.CLAIM_VALUE_MAX_LENGTH,ref:function(n){return Un(n,e.name,t)}})}var o="Enter the "+n;return p.createElement(c.gN,{"data-testid":"".concat(J,"-profile-form-").concat(e.name,"-input"),name:e.name,label:"profileUrl"===e.name?"Profile Image URL":n,required:e.required,requiredErrorMessage:n+" is required",placeholder:o,type:"text",value:"boolean"==typeof ie.get(e.name)?ie.get(e.name)?"true":"false":ie.get(e.name),key:t,disabled:"userName"===e.name,hidden:"userName"===e.name&&!(0,d.Z)(null==Je?void 0:Je.userSourceId),readOnly:G||e.mutability===r.Cb.READONLY_SCHEMA||"userName"===e.name,validation:function(t,a){RegExp(e.regEx).test(t)?t.includes("/")&&e.name.toLowerCase().includes("url")&&(l.URLUtils.isHttpsUrl(t)||l.URLUtils.isHttpUrl(t)||(a.isValid=!1,a.errorMessages.push(X("console:manage.features.users.forms.validation.formatError",{field:n}))),l.URLUtils.isMobileDeepLink(t)||(a.isValid=!1,a.errorMessages.push(X("console:manage.features.users.forms.validation.formatError",{field:n})))):(a.isValid=!1,"phoneNumbers.mobile"===e.name?a.errorMessages.push(X("console:manage.features.users.forms.validation.mobileFormatError",{field:n})):a.errorMessages.push(X("console:manage.features.users.forms.validation.formatError",{field:n})))},maxLength:e.name.toLowerCase().includes("url")?1024:e.maxLength?e.maxLength:r.Cb.CLAIM_VALUE_MAX_LENGTH,ref:function(n){return Un(n,e.name,t)}})}(e,a,n)))}};return p.createElement(p.Fragment,null,W?p.createElement(u.pO,null):(0,d.Z)(ie)||en?p.createElement(u.pJ,{padded:!1},p.createElement(u.$J,{"data-testid":"".concat(J,"-empty-list-empty-placeholder"),title:X("console:manage.features.user.profile.placeholders.userProfile.emptyListPlaceholder.title"),subtitle:[X("console:manage.features.user.profile.placeholders.userProfile.emptyListPlaceholder.subtitles")]})):p.createElement(u.pJ,{padded:"very"},p.createElement(c.Es,{"data-testid":"".concat(J,"-form"),onSubmit:function(e){return function(e){var n,t={Operations:[],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]},a={op:"replace",value:{}},o=new Set(ce.map((function(e){return"BOOLEAN"===e.type.toUpperCase()?e.name:null}))),c=P(e.entries());try{for(c.s();!(n=c.n()).done;){var u=F(n.value,2),m=u[0],f=u[1];o.has(m)&&e.set(m,String(!(null==f||!f.length)))}}catch(p){c.e(p)}finally{c.f()}ce.forEach((function(n){if(n.mutability!==r.Cb.READONLY_SCHEMA){var o={},i=n.name.split("."),s=!1,c=i[0].split("#");if(1!==c.length&&(s=!0),"roles.default"!==n.name&&void 0!==e.get(n.name)&&void 0!==e.get(n.name).toString())if(l.ProfileUtils.isMultiValuedSchemaAttribute(ce,i[0])||"phoneNumbers"===i[0]){var u=[],m=new Map;if(1===i.length||"phoneNumbers.mobile"===n.name){var f,g=P(e.keys());try{for(g.s();!(f=g.n()).done;){var C=f.value;C.split(".")[0]===i[0]&&m.set(C,e.get(C))}}catch(p){g.e(p)}finally{g.f()}var E,v=P(m);try{for(v.s();!(E=v.n()).done;){var S=F(E.value,2),b=S[0],A=S[1],_=b.split(".");A&&""!==A&&(1===_.length?u.push(A):u.push({type:_[1],value:A}))}}catch(p){v.e(p)}finally{v.f()}o=x({},i[0],u)}else i[0]===M._F.SCIM2_SCHEMA_DICTIONARY.get("EMAILS")&&(o=x({},i[0],[{type:i[1],value:e.get(n.name)}]))}else if(1===i.length)if(n.extended){var I,y,h=t.Operations.find((function(e){return e.value[n.schemaId]}));h?h.value[n.schemaId][i[0]]="BOOLEAN"===n.type.toUpperCase()?!(null===(I=e.get(n.name))||void 0===I||!I.includes(n.name)):e.get(i[0]):o=x({},n.schemaId,x({},i[0],"BOOLEAN"===n.type.toUpperCase()?!(null===(y=e.get(n.name))||void 0===y||!y.includes(n.name)):e.get(i[0])))}else o=i[0]===M._F.SCIM2_SCHEMA_DICTIONARY.get("EMAILS")?{emails:[e.get(n.name)]}:x({},i[0],e.get(i[0]));else if(i[0]===M._F.SCIM2_SCHEMA_DICTIONARY.get("NAME"))o={name:x({},i[1],e.get(n.name))};else if("addresses"===i[0])o=x({},i[0],[{formatted:e.get(n.name),type:i[1]}]);else if(s&&"addresses"===c[0]){var O;o=x({},c[0],[(O={},x(O,i[1],e.get(n.name)),x(O,"type",c[1]),O)])}else if(n.extended)o=x({},n.schemaId,x({},i[0],x({},i[1],e.get(n.name))));else if("emails"!==i[0]&&"phoneNumbers"!==i[0]){var U;o=x({},i[0],[{type:i[1],value:"BOOLEAN"===n.type.toUpperCase()?!(null===(U=e.get(n.name))||void 0===U||!U.includes(n.name)):e.get(n.name)}])}(0,d.Z)(o)||(a={op:"replace",value:o}),"addresses"!==i[0]&&"addresses"!==c[0]||(a.op="add"),!(0,d.Z)(o)&&t.Operations.push(a)}})),rn(!0),(0,U.gS)(q.id,t).then((function(){B({description:X("console:manage.features.user.profile.notifications.updateProfileInfo.success.description"),level:i.QU.SUCCESS,message:X("console:manage.features.user.profile.notifications.updateProfileInfo.success.message")}),j(q.id)})).catch((function(e){var n,t,a,r,o,l,c,u;null!=e&&null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.detail||null!=e&&null!==(a=e.response)&&void 0!==a&&null!==(r=a.data)&&void 0!==r&&r.description?$((0,s.V_)({description:(null==e||null===(o=e.response)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.detail)||(null==e||null===(c=e.response)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.description),level:i.QU.ERROR,message:X("console:manage.features.user.profile.notifications.updateProfileInfo.error.message")})):$((0,s.V_)({description:X("console:manage.features.user.profile.notifications.updateProfileInfo.genericError.description"),level:i.QU.ERROR,message:X("console:manage.features.user.profile.notifications.updateProfileInfo.genericError.message")}))}))}(e)},onChange:function(){return rn(!1)},onSubmitError:function(e,n){for(var t=e.entries(),a=t.next();!a.done;){if(!a.value[1]||!n.get(a.value[0]).isValid){On(a.value[0]);break}a=t.next()}}},p.createElement(v.Z,null,q.id&&p.createElement(v.Z.Row,{columns:1},p.createElement(v.Z.Column,{mobile:12,tablet:12,computer:6},p.createElement(S.Z.Field,null,p.createElement("label",null,X("extensions:manage.users.editUserProfile.userId")),p.createElement(b.Z,{name:"userID",type:"text",value:q.id,readOnly:!0})))),ce&&ce.map((function(e,n){if(!(e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ROLES_DEFAULT"))||e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ACTIVE"))||e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("GROUPS"))||e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("PROFILE_URL"))||e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ACCOUNT_LOCKED"))||e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ACCOUNT_DISABLED"))||e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("ONETIME_PASSWORD"))||e.name===(null===r.Cb||void 0===r.Cb?void 0:r.Cb.SCIM2_SCHEMA_DICTIONARY.get("EMAILS"))&&"false"===(null==un?void 0:un.enableValidator)||"id"===e.name&&"urn:ietf:params:scim:schemas:core:2.0"===e.schemaId)&&yn(e))return Mn(e,n)})),mn&&p.createElement(v.Z.Row,{columns:1},p.createElement(v.Z.Column,{mobile:12,tablet:12,computer:6},p.createElement(S.Z.Field,null,p.createElement("label",null,X("console:manage.features.user.profile.fields.createdDate")),p.createElement(b.Z,{name:"createdDate",type:"text",value:mn?f()(mn).format("YYYY-MM-DD"):"",readOnly:!0})))),fn&&p.createElement(v.Z.Row,{columns:1},p.createElement(v.Z.Column,{mobile:12,tablet:12,computer:6},p.createElement(S.Z.Field,null,p.createElement("label",null,X("console:manage.features.user.profile.fields.modifiedDate")),p.createElement(b.Z,{name:"modifiedDate",type:"text",value:fn?f()(fn).format("YYYY-MM-DD"):"",readOnly:!0})))),je&&p.createElement(v.Z.Row,{columns:1},p.createElement(v.Z.Column,{mobile:12,tablet:12,computer:6},p.createElement(c.gN,{"data-testid":"".concat(J,"\n                                                                    -profile-form-one-time-pw -input"),name:"oneTimePassword",label:X("console:manage.features.user.profile.fields.oneTimePassword"),required:!1,requiredErrorMessage:"",type:"text",hidden:void 0===je,value:je&&je,readOnly:!0}))),p.createElement(v.Z.Row,{columns:1},p.createElement(v.Z.Column,{mobile:16,tablet:16,computer:8},!G&&p.createElement(A.Z,{"data-testid":"".concat(J,"-form-update-button"),primary:!0,type:"submit",size:"small",className:"form-button",disabled:an},"Update")))))),p.createElement(_.Z,{hidden:!0}),W||!(0,o.hasRequiredScopes)(null==K?void 0:K.users,null==K||null===(Cn=K.users)||void 0===Cn||null===(En=Cn.scopes)||void 0===En?void 0:En.update,te)||re&&H.UserManagementUtils.isAuthenticatedUser(ae,null==q?void 0:q.userName)?null:p.createElement(a.di,{when:y.T.USER_DELETE||y.T.USER_EDIT},p.createElement(u.v9,{sectionHeader:X("console:manage.features.user.editUser.dangerZoneGroup.header")},!G&&!Q&&q.userName!==L.ADMIN_USER_NAME&&p.createElement(u.cN,{"data-testid":"".concat(J,"-change-password"),actionTitle:X("console:manage.features.user.editUser.dangerZoneGroup.passwordResetZone.actionTitle"),header:X("console:manage.features.user.editUser.dangerZoneGroup.passwordResetZone.header"),subheader:X("console:manage.features.user.editUser.dangerZoneGroup.passwordResetZone.subheader"),onActionClick:function(){Me(!0)},isButtonDisabled:Ye?"true"===Ye:"true"===(null===(vn=q[r.Cb.SCIM2_WSO2_USER_SCHEMA])||void 0===vn?void 0:vn.accountLocked),buttonDisableHint:X("console:manage.features.user.editUser.dangerZoneGroup.passwordResetZone.buttonHint")}),q.userName!==L.ADMIN_USER_NAME&&p.createElement(a.di,{when:y.T.USER_DELETE},!G&&"true"===(null==Re?void 0:Re.accountDisable)&&p.createElement(a.di,{when:y.T.USER_EDIT},p.createElement(u.cN,{"data-testid":"".concat(J,"-danger-zone"),actionTitle:X("console:manage.features.user.editUser.dangerZoneGroup.disableUserZone.actionTitle"),header:X("console:manage.features.user.editUser.dangerZoneGroup.disableUserZone.header"),subheader:X("console:manage.features.user.editUser.dangerZoneGroup.disableUserZone.subheader"),onActionClick:void 0,toggle:{checked:Ve?"true"===Ve:"true"===(null===(Sn=q[r.Cb.SCIM2_WSO2_USER_SCHEMA])||void 0===Sn?void 0:Sn.accountDisabled),id:M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_DISABLED"),onChange:_n}})),p.createElement(a.di,{when:y.T.USER_EDIT},p.createElement(u.cN,{"data-testid":"".concat(J,"-danger-zone"),actionTitle:X("console:manage.features.user.editUser.dangerZoneGroup.lockUserZone.actionTitle"),header:X("extensions:manage.users.editUserProfile.accountLock.title"),subheader:X("extensions:manage.users.editUserProfile.accountLock.description"),onActionClick:void 0,toggle:{checked:Ye?"true"===Ye:"true"===(null===(bn=q[r.Cb.SCIM2_WSO2_USER_SCHEMA])||void 0===bn?void 0:bn.accountLocked),id:M._F.SCIM2_ATTRIBUTES_DICTIONARY.get("ACCOUNT_LOCKED"),onChange:_n}})),p.createElement(a.di,{when:y.T.USER_DELETE},p.createElement(u.cN,{"data-testid":"".concat(J,"-danger-zone"),actionTitle:X("console:manage.features.user.editUser.dangerZoneGroup.deleteUserZone.actionTitle"),header:X("console:manage.features.user.editUser.dangerZoneGroup.deleteUserZone.header"),subheader:X("console:manage.features.user.editUser.dangerZoneGroup.deleteUserZone.subheader"),onActionClick:function(){fe(!0),Ce(q)},isButtonDisabled:Q,buttonDisableHint:X("console:manage.features.user.editUser.dangerZoneGroup.deleteUserZone.buttonDisableHint")}))))),ge&&p.createElement(u.cV,{primaryActionLoading:Le,"data-testid":"".concat(J,"-confirmation-modal"),onClose:function(){return fe(!1)},type:"negative",open:me,assertionHint:X("console:manage.features.user.deleteUser.confirmationModal.assertionHint"),assertionType:"checkbox",primaryAction:X("common:confirm"),secondaryAction:X("common:cancel"),onSecondaryActionClick:function(){return fe(!1)},onPrimaryActionClick:function(){var e;He(!0),(e=ge.id,(0,U.h8)(e).then((function(){B({description:X("console:manage.features.users.notifications.deleteUser.success.description"),level:i.QU.SUCCESS,message:X("console:manage.features.users.notifications.deleteUser.success.message")}),h.m8.push(L.UsersConstants.getPaths().get("USERS_PATH"))})).catch((function(e){e.response&&e.response.data&&e.response.data.description?B({description:e.response.data.description,level:i.QU.ERROR,message:X("console:manage.features.users.notifications.deleteUser.error.message")}):B({description:X("console:manage.features.users.notifications.deleteUser.genericError.description"),level:i.QU.ERROR,message:X("console:manage.features.users.notifications.deleteUser.genericError.message")})}))).finally((function(){He(!1),fe(!1)}))},closeOnDimmerClick:!1},p.createElement(u.cV.Header,{"data-testid":"".concat(J,"-confirmation-modal-header")},X("console:manage.features.user.deleteUser.confirmationModal.header")),p.createElement(u.cV.Message,{"data-testid":"".concat(J,"-confirmation-modal-message"),attached:!0,negative:!0},X("console:manage.features.user.deleteUser.confirmationModal.message")),p.createElement(u.cV.Content,null,X("console:manage.features.user.deleteUser.confirmationModal.content"))),ve&&p.createElement(u.cV,{primaryActionLoading:Le,"data-testid":"".concat(J,"-confirmation-modal"),onClose:function(){_e(!1),Se(void 0)},type:"negative",open:Ae,assertion:null==q||null===(m=q.userName)||void 0===m?void 0:m.split("/")[1],assertionHint:p.createElement("p",null,p.createElement(C.c,{i18nKey:"console:manage.features.user.disableUser.confirmationModal.assertionHint",tOptions:{userName:null==q||null===(Z=q.userName)||void 0===Z?void 0:Z.split("/")[1]}},"Please type ",p.createElement("strong",null,null==q||null===(w=q.userName)||void 0===w?void 0:w.split("/")[1])," to confirm.")),assertionType:"input",primaryAction:X("common:confirm"),secondaryAction:X("common:cancel"),onSecondaryActionClick:function(){Se(void 0),j(q.id),_e(!1)},onPrimaryActionClick:function(){He(!0),In(ve.name,ve.value).finally((function(){He(!1),_e(!1),Se(void 0)}))},closeOnDimmerClick:!1},p.createElement(u.cV.Header,{"data-testid":"".concat(J,"-confirmation-modal-header")},X("console:manage.features.user.disableUser.confirmationModal.header")),p.createElement(u.cV.Message,{"data-testid":"".concat(J,"-disable-confirmation-modal-message"),attached:!0,negative:!0},X("console:manage.features.user.disableUser.confirmationModal.message")),p.createElement(u.cV.Content,null,X("console:manage.features.user.disableUser.confirmationModal.content"))),ve&&p.createElement(u.cV,{primaryActionLoading:Le,"data-testid":"".concat(J,"-lock-confirmation-modal"),onClose:function(){he(!1),Se(void 0)},type:"negative",open:ye,assertion:null==q||null===(V=q.userName)||void 0===V?void 0:V.split("/")[1],assertionHint:X("console:manage.features.user.lockUser.confirmationModal.assertionHint"),assertionType:"checkbox",primaryAction:X("common:confirm"),secondaryAction:X("common:cancel"),onSecondaryActionClick:function(){Se(void 0),j(q.id),he(!1)},onPrimaryActionClick:function(){He(!0),In(ve.name,ve.value).finally((function(){He(!1),_e(!1),Se(void 0)}))},closeOnDimmerClick:!1},p.createElement(u.cV.Header,{"data-testid":"".concat(J,"-lock-confirmation-modal-header")},X("console:manage.features.user.lockUser.confirmationModal.header")),p.createElement(u.cV.Message,{"data-testid":"".concat(J,"-confirmation-modal-message"),attached:!0,negative:!0},X("console:manage.features.user.lockUser.confirmationModal.message")),p.createElement(u.cV.Content,null,X("console:manage.features.user.lockUser.confirmationModal.content"))),p.createElement(I.ChangePasswordComponent,{handleForcePasswordResetTrigger:function(){return Pe(!0)},handleCloseChangePasswordModal:function(){return Me(!1)},openChangePasswordModal:Ue,onAlertFired:B,user:q,handleUserUpdate:j,connectorProperties:z,passwordConfig:sn,isEmailAvailable:void 0!==ie.get("emails"),usernameConfig:un}))};q.defaultProps={"data-testid":"asgardeo-user-mgt-user-profile"}}}]);