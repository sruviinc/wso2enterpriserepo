"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[53214],{53214:(e,t,n)=>{n.r(t),n.d(t,{AddRoleUsers:()=>C});var a=n(13318),l=n(81816),r=n(39345),o=n(67127),i=n(52983),s=n(9202),c=n(21921),u=n(97860),m=n(94635),d=n(10594),f=n(14969),v=n(74691),h=n(30640),p=n(18319),g=n(99839);function y(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,l,r,o,i=[],s=!0,c=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=r.call(n)).done)&&(i.push(a.value),i.length!==t);s=!0);}catch(e){c=!0,l=e}finally{try{if(!s&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw l}}return i}}(e,t)||b(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var C=function(e){var t=e.triggerSubmit,n=e.onSubmit,S=e.assignedUsers,C=e.isEdit,N=e.initialValues,Z=e.isGroup,I=e.userStore,w=e.isReadOnly,A=e.handleTempUsersListChange,L=e["data-testid"],R=(0,s.$)().t,U=E((0,l.IK)(),3),z=U[0],P=U[2],k=E((0,i.useState)([]),2),M=k[0],T=k[1],O=E((0,i.useState)([]),2),x=O[0],j=O[1],_=E((0,i.useState)([]),2),F=_[0],W=_[1],J=E((0,i.useState)([]),2),D=J[0],H=J[1],K=E((0,i.useState)([]),2),X=K[0],$=K[1],q=E((0,i.useState)(0),1)[0],G=E((0,i.useState)(0),2),B=G[0],Q=G[1],V=E((0,i.useState)(void 0),2),Y=V[0],ee=V[1],te=E((0,i.useState)(!1),2),ne=te[0],ae=te[1],le=E((0,i.useState)(!0),2),re=le[0],oe=le[1],ie=E((0,i.useState)(!1),2),se=ie[0],ce=ie[1];(0,i.useEffect)((function(){if(M){var e=me(x,S,!0);j(e),$(e)}}),[S]),(0,i.useEffect)((function(){var e=[];ne&&(e=M),W(e),A&&A(e)}),[ne]),(0,i.useEffect)((function(){Q(h.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),ee(new Map([["name","name"],["emails","emails"],["name","name"],["userName","userName"],["id",""],["profileUrl","profileUrl"],["meta.lastModified","meta.lastModified"],["meta.created",""]]))}),[]),(0,i.useEffect)((function(){if(Y){var e=de(Y.values());ue(B,q,null,e,Z?I:null)}}),[q,B]);var ue=function(e,t,n,a,l){oe(!0),(0,p.Fp)(e,t,n,a,l).then((function(e){var t=e.Resources.filter((function(e){return e.userName.split("/")[0]!==g.CONSUMER_USERSTORE}));if(t.sort((function(e,t){var n,a,l;return null===(n=e.name)||void 0===n||null===(a=n.givenName)||void 0===a?void 0:a.localeCompare(null===(l=t.name)||void 0===l?void 0:l.givenName)})),T(y(t)),S&&0!==S.length){var n=[];t&&t instanceof Array&&(t.slice().reverse().forEach((function(e){S.forEach((function(a){e.id===a.value&&(n.push(e),t.splice(t.indexOf(e),1))}))})),n.sort((function(e,t){var n,a,l;return null===(n=e.name)||void 0===n||null===(a=n.givenName)||void 0===a?void 0:a.localeCompare(null===(l=t.name)||void 0===l?void 0:l.givenName)})),j(n),$(n))}if(N&&N instanceof Array){var a=[];t&&t instanceof Array&&(t.forEach((function(e){N.forEach((function(t){e.id===t.id&&a.push(e)}))})),a.sort((function(e,t){var n,a,l;return null===(n=e.name)||void 0===n||null===(a=n.givenName)||void 0===a?void 0:a.localeCompare(null===(l=t.name)||void 0===l?void 0:l.givenName)})),T(t.filter((function(e){return-1==a.indexOf(e)}))),j(a),$(a))}})).finally((function(){oe(!1)}))},me=function(e,t,n){if((0,o.Z)(t))return[];var a=[];a=(0,o.Z)(e)&&N&&Array.isArray(N)&&N.length>0?N:y(e);var l=[];return a.filter((function(e){t.forEach((function(t){e.id===t.value&&l.push(e)}))})),n&&l.sort((function(e,t){var n,a,l;return null===(n=e.name)||void 0===n||null===(a=n.givenName)||void 0===a?void 0:a.localeCompare(null===(l=t.name)||void 0===l?void 0:l.givenName)})),l},de=function(e){var t,n=[],a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=b(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,l=function(){};return{s:l,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,r=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw r}}}}(e[Symbol.iterator]());try{for(a.s();!(t=a.n()).done;){var l=t.value;""!==l&&n.push(l)}}catch(r){a.e(r)}finally{a.f()}return n.toString()},fe=function(e,t,n,a){var l=[];if(!(0,o.Z)(t)){var i=new RegExp((0,r.Z)(t),"i");return n&&n.map((function(e){i.test(e.userName)&&l.push(e)})),void a(l)}a(n)},ve=function(e){var t=y(F);t.includes(e)?t.splice(t.indexOf(e),1):t.push(e),W(t),A(t)},he=function(){H(M),W(x),ae((null==x?void 0:x.length)===(null==M?void 0:M.length)),ce(!0)},pe=function(){H(M),W([]),ae(!1),ce(!1)},ge=function(){return i.createElement(c.Z,{"data-testid":"".concat(L,"-assign-user-wizard-modal"),dimmer:"blurring",open:se,size:"small",className:"user-roles"},i.createElement(c.Z.Header,null,R("console:manage.features.roles.addRoleWizard.users.assignUserModal.heading",{type:"Group"}),i.createElement(l.X6,{subHeading:!0,ellipsis:!0,as:"h6"},R("console:manage.features.roles.addRoleWizard.users.assignUserModal.subHeading",{type:"group"}))),i.createElement(c.Z.Content,{image:!0},z&&P,i.createElement(l.IX,{compact:!0,basic:!0,bordered:!0,className:"one-column-selection",selectionComponent:!0,searchPlaceholder:R("console:manage.features.roles.addRoleWizard.users.assignUserModal.list.searchPlaceholder"),isLoading:re,handleUnelectedListSearch:function(e,t){var n=t.value;fe(0,n,M,H)},"data-testid":"".concat(L,"-user-list-transfer")},i.createElement(l.Jv,{selectionComponent:!0,isListEmpty:!1,isLoading:re,listType:"unselected","data-testid":"".concat(L,"-unselected-transfer-list"),emptyPlaceholderContent:R("console:manage.features.transferList.list.emptyPlaceholders.roles.selected",{type:"users"}),emptyPlaceholderDefaultContent:R("console:manage.features.transferList.list.emptyPlaceholders.default")},null==D?void 0:D.map((function(e,t){var n,a=e.name&&void 0!==e.name.givenName?e.name.givenName+" "+(e.name.familyName?e.name.familyName:""):void 0,r=(null===(n=e.userName.split("/"))||void 0===n?void 0:n.length)>1?e.userName.split("/")[1]:e.userName.split("/")[0];return i.createElement(l.qT,{handleItemChange:function(){return ve(e)},key:t,listItem:null!=a?a:r,listItemId:e.id,listItemIndex:t,isItemChecked:F&&F.includes(e),showSecondaryActions:!1,showListSubItem:!0,listSubItem:a&&i.createElement(u.Z,{as:"h6"},i.createElement(u.Z.Content,null,i.createElement(u.Z.Subheader,{"data-testid":"".concat(L,"-item-sub-heading")},r))),"data-testid":"".concat(L,"-unselected-transfer-list-item-").concat(t)})}))))),i.createElement(c.Z.Actions,null,i.createElement(m.Z,null,i.createElement(m.Z.Row,{columns:2},i.createElement(m.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(l.Qj,{"data-testid":"".concat(L,"-assign-user-wizard-modal-cancel-button"),onClick:pe,floated:"left"},R("common:cancel"))),i.createElement(m.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(l.KM,{"data-testid":"".concat(L,"-assign-user-wizard-modal-save-button"),onClick:function(){n(F),j(F),ce(!1)},floated:"right"},R("common:save")))))))};return i.createElement(i.Fragment,null,C?i.createElement(m.Z,null,(null==x?void 0:x.length)>0?i.createElement(i.Fragment,null,i.createElement(m.Z.Row,null,i.createElement(m.Z.Column,{mobile:16,tablet:16,computer:12},i.createElement(f.Z,{"data-testid":"".concat(L,"-users-list-search-input"),icon:i.createElement(v.Z,{name:"search"}),onChange:function(e,t){var n=t.value;fe(0,n,x,$)},placeholder:R("console:manage.features.roles.addRoleWizard.users.assignUserModal.list.searchPlaceholder"),floated:"left",size:"small"}),!w&&i.createElement(l.zx,{"data-testid":"".concat(L,"-users-list-edit-button"),size:"medium",icon:"pencil",floated:"right",onClick:he}))),i.createElement(m.Z.Row,null,i.createElement(m.Z.Column,{mobile:16,tablet:16,computer:12},i.createElement(d.Z,{singleLine:!0,compact:!0},i.createElement(d.Z.Body,null,null==X?void 0:X.map((function(e){return function(e){var t,n=e.name&&void 0!==e.name.givenName?e.name.givenName+" "+(e.name.familyName?e.name.familyName:""):void 0,a=(null===(t=e.userName.split("/"))||void 0===t?void 0:t.length)>1?e.userName.split("/")[1]:e.userName.split("/")[0];return i.createElement(d.Z.Row,{key:e.id},i.createElement(d.Z.Cell,null,i.createElement(u.Z,{image:!0,as:"h6",className:"header-with-icon","data-testid":"".concat(L,"-item-heading")},i.createElement(l.Yt,{"data-testid":"".concat(L,"-users-list-").concat(e.userName,"-avatar"),name:a,spaced:"right",size:"mini",floated:"left",image:e.profileUrl}),i.createElement(u.Z.Content,null,null!=n?n:a,i.createElement(u.Z.Subheader,{"data-testid":"".concat(L,"-item-sub-heading")},n&&a)))))}(e)}))))))):re?i.createElement(l.pO,null):i.createElement(m.Z.Row,null,i.createElement(m.Z.Column,{mobile:16,tablet:16,computer:12},i.createElement(l.pJ,null,i.createElement(l.$J,{title:R("console:manage.features.roles.edit.users.list.emptyPlaceholder.title"),subtitle:[R("console:manage.features.roles.edit.users.list.emptyPlaceholder.subtitles",{type:"role"})],action:!w&&i.createElement(l.KM,{"data-testid":"".concat(L,"-users-list-empty-assign-users-button"),onClick:he,icon:"plus"},R("console:manage.features.roles.edit.users.list.emptyPlaceholder.action")),image:(0,h.jF)().emptyList,imageSize:"tiny"})))),ge()):i.createElement(a.Es,{onSubmit:function(){n(F)},submitState:t},i.createElement(m.Z,null,i.createElement(m.Z.Row,{columns:2},i.createElement(l.IX,{compact:!0,basic:!0,bordered:!0,className:"one-column-selection",selectionComponent:!0,searchPlaceholder:R("console:manage.features.roles.addRoleWizard.users.assignUserModal.list.searchPlaceholder"),isLoading:re,handleUnelectedListSearch:function(e,t){var n=t.value;fe(0,n,M,H)},"data-testid":"".concat(L,"-transfer-component")},i.createElement(l.Jv,{selectionComponent:!0,isListEmpty:!re&&(null==M?void 0:M.length)<1,isLoading:re,listType:"unselected",selectAllCheckboxLabel:"Select all users",emptyPlaceholderContent:"There are no users available at the moment to assign to this role.","data-testid":"".concat(L,"-unselected-transfer-list"),emptyPlaceholderDefaultContent:R("console:manage.features.transferList.list.emptyPlaceholders.default")},null==M?void 0:M.map((function(e,t){var n,a,r=e.name&&void 0!==e.name.givenName?"".concat(e.name.givenName," ").concat(null!==(n=e.name.familyName)&&void 0!==n?n:""):void 0,o=(null===(a=e.userName.split("/"))||void 0===a?void 0:a.length)>1?e.userName.split("/")[1]:e.userName.split("/")[0];return i.createElement(l.qT,{handleItemChange:function(){return ve(e)},key:t,listItem:null!=r?r:o,listItemId:e.id,listItemIndex:t,isItemChecked:F.includes(e),showSecondaryActions:!1,showListSubItem:!0,listSubItem:r&&i.createElement(u.Z,{as:"h6"},i.createElement(u.Z.Content,null,i.createElement(u.Z.Subheader,{"data-testid":"".concat(L,"-item-sub-heading")},o))),"data-testid":"".concat(L,"-unselected-transfer-list-item-").concat(t)})}))))),C&&i.createElement(m.Z.Row,{columns:1},i.createElement(m.Z.Column,{mobile:16,tablet:16,computer:8},i.createElement(l.zx,{"data-testid":"".concat(L,"-update-user-list-button"),primary:!0,type:"submit",size:"small",className:"form-button"},R("common.update")))))))};C.defaultProps={isLoading:!1}}}]);