"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[17009],{17009:(e,n,t)=>{t.r(n),t.d(n,{SessionManagementSettingsPage:()=>w,default:()=>G});var o,r=t(57477),i=t(83374),a=t(14603),s=t(90268),l=t(59206),c=t(81816),u=t(53337),m=t(52983),d=t(9202),E=t(54221),f=t(94635),g=t(28141),_=t(75917),S=t(16184),p=t(30640),N=t(93967),M=t(85850),O=t(43991),T=t(65790);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function C(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,b(o.key),o)}}function v(e,n,t){return n&&C(e.prototype,n),t&&C(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,n,t){return(n=b(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function b(e){var n=function(e,n){if("object"!==I(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!==I(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===I(n)?n:String(n)}var h=v((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}));o=h,A(h,"IDLE_SESSION_TIMEOUT_PATH","/idleSessionTimeoutPeriod"),A(h,"REMEMBER_ME_PERIOD_PATH","/rememberMePeriod"),A(h,"REPLACE_OPERATION","REPLACE"),A(h,"SESSION_MANAGEMENT_CONFIG_FETCH_ERROR_CODE","SMC-00001"),A(h,"SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE","SMC-00002"),A(h,"SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE","SMC-00003"),A(h,"SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH",0),A(h,"SESSION_MANAGEMENT_CONFIG_FIELD_MAX_LENGTH",100),A(h,"ErrorMessages",{SESSION_MANAGEMENT_CONFIG_FETCH_ERROR_CODE:new T.O(o.SESSION_MANAGEMENT_CONFIG_FETCH_ERROR_CODE,"An error occurred while fetching the session management configurations.","Error while fetching the session management configurations",null),SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE:new T.O(o.SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE,"Received an invalid status code while fetching the session management configurations.","Invalid Status Code while fetching the session management configurations",null),SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE:new T.O(o.SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE,"An error occurred while updating the session management configurations.","Error while updating the session management configurations",null)});var R=N.AsgardeoSPAClient.getInstance().httpRequest.bind(N.AsgardeoSPAClient.getInstance());function y(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,i,a,s=[],l=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(o=i.call(t)).done)&&(s.push(o.value),s.length!==n);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return P(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return P(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}var w=function(e){var n,t,o,N,T=e["data-componentid"],I=(0,m.useRef)(null),C=(0,m.useRef)(null),v=(0,E.v9)((function(e){return e.config.ui.features})),A=(0,E.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),b=(0,m.useMemo)((function(){var e,n;return!(0,i.hasRequiredScopes)(null==v?void 0:v.governanceConnectors,null==v||null===(e=v.governanceConnectors)||void 0===e||null===(n=e.scopes)||void 0===n?void 0:n.update,A)}),[v,A]),P=(0,E.I0)(),w=(0,d.$)().t,G=y((0,m.useState)(!1),2),D=G[0],L=G[1],F=y((0,m.useState)(void 0),2),H=F[0],Z=F[1],U=(n={headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.GET,url:M.De.getServiceResourceEndpoints().serverConfigurations},t=(0,O.Z)(n),o=t.data,N=t.error,{data:o,error:N,isLoading:!N&&!o,isValidating:t.isValidating,mutate:t.mutate}),j=U.data,k=U.isLoading,V=U.mutate,x=U.error;(0,m.useEffect)((function(){j instanceof r.u||x?q():j&&j.idleSessionTimeoutPeriod&&j.rememberMePeriod&&Z({idleSessionTimeout:parseInt(j.idleSessionTimeoutPeriod),rememberMePeriod:parseInt(j.rememberMePeriod)})}),[j]);var q=function(){P((0,s.V_)({description:w("console:sessionManagement.notifications.getConfiguration.error.description"),level:a.QU.ERROR,message:w("console:sessionManagement.notifications.getConfiguration.error.message")}))};return m.createElement(c.Xg,{title:w("console:sessionManagement.title"),pageTitle:w("console:sessionManagement.title"),description:w("console:sessionManagement.description"),backButton:{onClick:function(){p.m8.push(p.$x.getPaths().get("LOGIN_AND_REGISTRATION"))},text:w("console:manage.features.governanceConnectors.goBackLoginAndRegistration")},bottomMargin:!1,contentTopMargin:!1,pageHeaderMaxWidth:!0,"data-componentid":"".concat(T,"-form-layout")},m.createElement(S.R,{innerRef:I},m.createElement(f.Z,{className:"mt-2"},m.createElement(f.Z.Row,{columns:1},m.createElement(f.Z.Column,{width:16},m.createElement(c.pJ,{className:"form-wrapper",padded:"very"},k?m.createElement(f.Z.Row,{columns:1},m.createElement("div",null,m.createElement("div",{className:"ui card fluid settings-card","data-testid":"".concat(T,"-loading-card")},m.createElement("div",{className:"content no-padding"},m.createElement("div",{className:"header-section"},m.createElement(g.Z,null,m.createElement(g.Z.Header,null,m.createElement(g.Z.Line,{length:"medium"}),m.createElement(g.Z.Line,{length:"full"}))),m.createElement(_.Z,{hidden:!0}))),m.createElement("div",{className:"content extra extra-content"},m.createElement("div",{className:"action-button"},m.createElement(g.Z,null,m.createElement(g.Z.Line,{length:"very short"}))))),m.createElement(_.Z,{hidden:!0}))):m.createElement(m.Fragment,null,m.createElement(l.l0,{id:"session-management-config-form",uncontrolledForm:!0,onSubmit:function(e){L(!0),function(e){var n={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:a.f2.PATCH,url:M.De.getServiceResourceEndpoints().serverConfigurations};return R(n).then((function(e){if(200!==e.status&&201!==e.status)throw new r.u(h.ErrorMessages.SESSION_MANAGEMENT_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE.getErrorMessage(),null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var n,t,o=h.ErrorMessages.SESSION_MANAGEMENT_CONFIG_UPDATE_ERROR_CODE.getErrorMessage();throw new r.u(o,e.stack,null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}([{operation:h.REPLACE_OPERATION,path:h.IDLE_SESSION_TIMEOUT_PATH,value:e.idleSessionTimeout.toString()},{operation:h.REPLACE_OPERATION,path:h.REMEMBER_ME_PERIOD_PATH,value:e.rememberMePeriod.toString()}]).then((function(){P((0,s.V_)({description:w("console:sessionManagement.notifications.updateConfiguration.success.description"),level:a.QU.SUCCESS,message:w("console:sessionManagement.notifications.updateConfiguration.success.message")})),V()})).catch((function(){P((0,s.V_)({description:w("console:sessionManagement.notifications.updateConfiguration.error.description"),level:a.QU.ERROR,message:w("console:sessionManagement.notifications.updateConfiguration.error.message")}))})).finally((function(){L(!1)}))},initialValues:H,enableReinitialize:!0,ref:C,noValidate:!0,validate:function(e){var n={idleSessionTimeout:void 0,rememberMePeriod:void 0};return null!=e&&e.idleSessionTimeout&&(!u.I.isInteger(e.idleSessionTimeout)||e.idleSessionTimeout<0)&&(n.idleSessionTimeout=w("console:sessionManagement.form.validation.idleSessionTimeout")),null!=e&&e.rememberMePeriod&&(!u.I.isInteger(e.rememberMePeriod)||e.rememberMePeriod<0)&&(n.rememberMePeriod=w("console:sessionManagement.form.validation.rememberMePeriod")),n},autoComplete:"new-password"},m.createElement(f.Z,null,m.createElement(f.Z.Row,{columns:2,key:1},m.createElement(f.Z.Column,{key:"idleSessionTimeout"},m.createElement(l.gN.Input,{min:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,ariaLabel:"Idle Session Timeout Field",inputType:"number",name:"idleSessionTimeout",label:w("console:sessionManagement.form.idleSessionTimeout.label"),placeholder:w("console:sessionManagement.form.idleSessionTimeout.placeholder"),hint:w("console:sessionManagement.form.idleSessionTimeout.hint"),required:!0,value:null==H?void 0:H.idleSessionTimeout,readOnly:b,maxLength:null,minLength:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,width:16,"data-componentid":"".concat(T,"-idle-session-timeout"),autoComplete:"new-password"})),m.createElement(f.Z.Column,{key:"rememberMePeriod"},m.createElement(l.gN.Input,{min:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,ariaLabel:"Remember Me Period Field",inputType:"number",name:"rememberMePeriod",label:w("console:sessionManagement.form.rememberMePeriod.label"),placeholder:w("console:sessionManagement.form.rememberMePeriod.placeholder"),hint:w("console:sessionManagement.form.rememberMePeriod.hint"),required:!0,value:null==H?void 0:H.rememberMePeriod,readOnly:b,maxLength:null,minLength:h.SESSION_MANAGEMENT_CONFIG_FIELD_MIN_LENGTH,width:16,"data-componentid":"".concat(T,"-remember-me-period"),autoComplete:"new-password"}))))),!b&&m.createElement(m.Fragment,null,m.createElement(_.Z,{hidden:!0}),m.createElement(f.Z.Row,{columns:1,className:"mt-6"},m.createElement(f.Z.Column,{mobile:16,tablet:16,computer:16},m.createElement(c.KM,{size:"small",loading:D,onClick:function(){var e;null==C||null===(e=C.current)||void 0===e||e.triggerSubmit()},ariaLabel:"Session management form update button","data-componentid":"".concat(T,"-update-button")},w("common:update"))))))))))))};w.defaultProps={"data-componentid":"session-management-settings-page"};const G=w}}]);