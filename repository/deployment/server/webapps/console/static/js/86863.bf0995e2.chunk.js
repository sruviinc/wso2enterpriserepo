"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[86863,67273,11638,94486,49748],{86863:(e,t,n)=>{n.r(t),n.d(t,{AttributeMappings:()=>r.AttributeMappings,AttributeMappingsComponent:()=>r.AttributeMappingsComponent,GeneralUserStoreDetails:()=>r.GeneralUserStoreDetails,SetupGuideTab:()=>r.SetupGuideTab,UserStoreGeneralSettings:()=>r.UserStoreGeneralSettings});var r=n(97603);n(67273)},67273:(e,t,n)=>{n.r(t);n(94486),n(11638),n(49748)},11638:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var r=n(14603),a=n(90268),o=n(13318),i=n(81816),s=n(52983),l=n(9202),u=n(54221),c=n(75917),f=n(94635),d=n(33614),m=n(68836),p=n(30640),g=n(40764),E=n(77499),S=n(63793),v=n(28689),h=n(97603),R=n(2540);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const U=function(e){var t=e["data-testid"],n=(0,l.$)().t,b=(0,u.I0)(),U=(0,u.v9)((function(e){return e.config.ui.features})),_=(0,u.v9)((function(e){var t,n;return null==e||null===(t=e.config)||void 0===t||null===(n=t.ui)||void 0===n?void 0:n.enableIdentityClaims})),A=y((0,o.cC)(),2),T=A[0],I=A[1],O=y((0,o.cC)(),2),C=O[0],w=O[1],M=y((0,s.useState)(null),2),L=M[0],P=M[1],x=y((0,s.useState)({description:"",name:""}),2),D=x[0],N=x[1],j=y((0,s.useState)(R.RemoteUserStoreTypes.LDAP),2),k=j[0],G=j[1],$=y((0,s.useState)(R.RemoteUserStoreAccessTypes.ReadOnly),2),Y=$[0],Z=$[1],Q=y((0,s.useState)(!1),2),V=Q[0],B=Q[1],z=y((0,s.useState)(!1),2),F=z[0],X=z[1],H=y((0,s.useState)(null),2),W=H[0],q=H[1];(0,s.useEffect)((function(){J(null,null,null,null,!_)}),[]),(0,s.useEffect)((function(){(0,g.E4)(R.RemoteUserStoreConstants.OUTBOUND_USER_STORE_TYPE_ID,null).then((function(e){P(e)}))}),[]);var J=function(e,t,o,i,s){X(!0);var l={"exclude-identity-claims":s,filter:i||null,limit:e||null,offset:o||null,sort:t||null};(0,d.WN)(l).then((function(e){q(e.filter((function(e){return e.claimURI===m.Q.USER_NAME_CLAIM_URI||e.claimURI===m.Q.USER_ID_CLAIM_URI})))})).catch((function(e){var t,o,i,s;b((0,a.V_)({description:(null==e||null===(t=e.response)||void 0===t||null===(o=t.data)||void 0===o?void 0:o.description)||n("console:manage.features.claims.local.notifications.getClaims.genericError.description"),level:r.QU.ERROR,message:(null==e||null===(i=e.response)||void 0===i||null===(s=i.data)||void 0===s?void 0:s.message)||n("console:manage.features.claims.local.notifications.getClaims.genericError.message")}))})).finally((function(){X(!1)}))},K=function(e){switch(e){case R.RemoteUserStoreConstants.PROPERTY_NAME_CONNECTED_USERSTORE_TYPE:return k.toString();case R.RemoteUserStoreConstants.PROPERTY_NAME_READ_ONLY:return Y.toString()}},ee=function(e){if(V){var t=[],o=function(){var e=[];return L.properties.Mandatory.map((function(t){e.push({name:t.name,value:K(t.name)})})),L.properties.Optional.map((function(t){e.push({name:t.name,value:t.defaultValue})})),e.push({name:R.RemoteUserStoreConstants.PROPERTY_NAME_READ_ONLY,value:K(R.RemoteUserStoreConstants.PROPERTY_NAME_READ_ONLY)}),e}();e.forEach((function(e,n){t.push({claimURI:n,mappedAttribute:e})}));var i,s={claimAttributeMappings:t,description:D.description,name:D.name,properties:o,typeId:R.RemoteUserStoreConstants.OUTBOUND_USER_STORE_TYPE_ID};i=s,(0,g.yS)(i).then((function(e){b((0,a.V_)({description:n("console:manage.features.userstores.notifications.addUserstore.success.description"),level:r.QU.SUCCESS,message:n("console:manage.features.userstores.notifications.addUserstore.success.message")})),b((0,a.V_)({description:n("console:manage.features.userstores.notifications.delay.description"),level:r.QU.WARNING,message:n("console:manage.features.userstores.notifications.delay.message")})),p.m8.push({pathname:p.$x.getPaths().get("USERSTORES_EDIT").replace(":id",e.id).replace("edit-user-store",S.userstoresConfig.userstoreEdit.remoteUserStoreEditPath)+"#tab=1",search:"?isNew=true"})})).catch((function(e){var t,o,i;403===(null===(t=e.response)||void 0===t?void 0:t.status)&&(null===(o=e.response.data)||void 0===o?void 0:o.code)===E.u4.ERROR_CREATE_LIMIT_REACHED.getErrorCode()&&b((0,a.V_)({description:n(E.u4.ERROR_CREATE_LIMIT_REACHED.getErrorDescription()),level:r.QU.ERROR,message:n(E.u4.ERROR_CREATE_LIMIT_REACHED.getErrorMessage())})),b((0,a.V_)({description:n("console:manage.features.userstores.notifications.addUserstore.genericError.description"),level:r.QU.ERROR,message:null!==(i=null==e?void 0:e.message)&&void 0!==i?i:n("console:manage.features.userstores.notifications.addUserstore.genericError.message")}))}))}},te=[{preventGoToNextStep:!V,stepAction:I,stepContent:s.createElement(h.GeneralUserStoreDetails,{triggerSubmit:T,featureConfig:U,handleBasicDetailsSubmit:function(e){N({description:e.get("description").toString(),name:e.get("name").toString()})},handleUserStoreTypeChange:function(e){G(e)},handleUserStoreAccessTypeChange:function(e){Z(e)},setUserStoreNameValid:B}),stepTitle:n("extensions:manage.features.userStores.create.pageLayout.steps.generalSettings.title")},{stepAction:w,stepContent:s.createElement(s.Fragment,null,s.createElement(i.xv,{className:"section-description"},n("extensions:manage.features.userStores.create.pageLayout.steps.attributeMappings.subTitle")),s.createElement(c.Z,{hidden:!0}),s.createElement(h.AttributeMappingsComponent,{isAttributesListRequestLoading:F,triggerSubmit:C,mandatoryAttributes:W,handleAttributeMappingsSubmit:ee})),stepTitle:n("extensions:manage.features.userStores.create.pageLayout.steps.attributeMappings.title")}];return s.createElement(i.Xg,{title:n("extensions:manage.features.userStores.create.pageLayout.title"),contentTopMargin:!0,description:n("extensions:manage.features.userStores.create.pageLayout.description"),backButton:{"data-testid":"".concat(t,"-page-back-button"),onClick:function(){p.m8.push(p.$x.getPaths().get("USERSTORES"))},text:n("console:manage.features.userstores.pageLayout.edit.back")},titleTextAlign:"left",bottomMargin:!1,showBottomDivider:!0,"data-testid":"".concat(t,"-page-layout")},s.createElement("div",{className:"remote-user-store-create-section"},s.createElement(i.pJ,{padded:"very"},s.createElement(f.Z,null,s.createElement(f.Z.Row,null,s.createElement(f.Z.Column,{width:10},s.createElement(v.VerticalStepper,{alwaysOpen:!1,isSidePanelOpen:!1,stepContent:te,isNextEnabled:!0,"data-testid":"".concat(t,"-vertical-stepper"),handleFinishAction:function(){return w()}})))))))}},94486:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var r=n(14603),a=n(90268),o=n(81816),i=n(87692),s=n(56024),l=n(67127),u=n(52983),c=n(9202),f=n(54221),d=n(74691),m=n(87089),p=n(30640),g=n(40764),E=n(14364),S=n(77499),v=n(5196),h=n(95494),R=n(97603),y=n(2540);function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}const _=function(e){var t=e.match,n=e["data-testid"],U=(0,f.I0)(),_=(0,c.$)().t,A=t.params.id,T=b((0,u.useState)(null),2),I=T[0],O=T[1],C=b((0,u.useState)(null),2),w=C[0],M=C[1],L=b((0,u.useState)(null),2),P=L[0],x=L[1],D=b((0,u.useState)(void 0),2),N=D[0],j=D[1],k=b((0,u.useState)(void 0),1)[0],G=b((0,u.useState)(void 0),2),$=G[0],Y=G[1],Z=b((0,u.useState)(""),2),Q=Z[0],V=Z[1],B=b((0,u.useState)(!1),2),z=B[0],F=B[1],X=b((0,u.useState)(!1),2),H=X[0],W=X[1],q=b((0,u.useState)([]),2)[1];(0,u.useEffect)((function(){window.location.hash||ee()}),[]),(0,u.useEffect)((function(){W(!0),(0,h.getAgentConnections)(A).then((function(e){q(e.filter((function(e){return null==e?void 0:e.agent})))})).finally((function(){W(!1)}))}),[A]),(0,u.useEffect)((function(){window.location.hash&&(I||(F(!0),(0,i.Z)((function(){ee(),F(!1)}),12e3)))}),[I]),(0,u.useEffect)((function(){(0,g.E4)(y.RemoteUserStoreConstants.OUTBOUND_USER_STORE_TYPE_ID,null).then((function(e){M(e)}))}),[]),(0,u.useEffect)((function(){w&&x((0,v.Y)(null==w?void 0:w.properties,null==I?void 0:I.properties))}),[w]),(0,u.useEffect)((function(){var e,t;I&&V(null==I||null===(e=I.properties)||void 0===e||null===(t=e.find((function(e){return e.name===S.rr})))||void 0===t?void 0:t.value)}),[I]),(0,u.useEffect)((function(){if(void 0===$||window.location.hash.includes(m.El.VIEW)||(0,l.Z)(window.location.hash)){if((0,l.Z)(window.location.hash))return void J(1);if(void 0===$||(0,l.Z)(window.location.hash))return;var e=window.location.hash.split("#"+m.El.TAB_INDEX);if(2===e.length&&(0,l.Z)(e[0])&&/^\d+$/.test(e[1])){var t=parseInt(e[1],10);if((0,s.Z)(t,0,$)){if(t===N)return;J(t)}else K(k)}else K(k)}}),[window.location.hash,$]);var J=function(e){p.m8.push({hash:"#".concat(m.El.TAB_INDEX).concat(e),pathname:window.location.pathname}),j(e)},K=function(e){J(e)},ee=function(){(0,g.YZ)(A).then((function(e){O(e)})).catch((function(e){U((0,a.V_)({description:(null==e?void 0:e.description)||_("console:manage.features.userstores.notifications.fetchUserstores.genericError.description"),level:r.QU.ERROR,message:(null==e?void 0:e.message)||_("console:manage.features.userstores.notifications.fetchUserstores.genericError.message")}))}))},te=[{menuItem:"Setup Guide",render:function(){return u.createElement(o.M$.Pane,{controlledSegmentation:!0,attached:!1},u.createElement(R.SetupGuideTab,{isUserStoreLoading:z,userStoreId:A}))}},{menuItem:"General",render:function(){return u.createElement(o.M$.Pane,{controlledSegmentation:!0,attached:!1},u.createElement(R.UserStoreGeneralSettings,{userStoreProperties:P,isDisabled:Q,userStore:I,userStoreId:A,handleUserStoreDisabled:function(e){return V(e)}}))}},{menuItem:"Attribute Mappings",render:function(){return u.createElement(o.M$.Pane,{controlledSegmentation:!0,attached:!1},u.createElement(R.AttributeMappings,{userStore:I,userStoreId:A}))}}];return u.createElement(o.O9,{image:u.createElement(o.dn,{bordered:!0,defaultIcon:!0,size:"x60",relaxed:"very",shape:"rounded",hoverable:!1,icon:(0,E.jw)()}),title:u.createElement(u.Fragment,null,"false"===Q?u.createElement(o.GI,{trigger:u.createElement(d.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"green"}),content:_("common:enabled"),inverted:!0}):u.createElement(o.GI,{trigger:u.createElement(d.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"orange"}),content:_("common:disabled"),inverted:!0}),null==I?void 0:I.name),backButton:{onClick:function(){p.m8.push(p.$x.getPaths().get("USERSTORES"))},text:_("console:manage.features.userstores.pageLayout.edit.back")},titleTextAlign:"left",bottomMargin:!1,isLoading:z||H,"data-testid":"".concat(n,"-page-layout")},u.createElement(o.M$,{className:"remote-user-store-edit-section",panes:te,onTabChange:function(e,t){J(t.activeIndex),ee()},"data-testid":"".concat(n,"-tabs"),onInitialize:function(e){var t=e.panesLength;Y(t)},activeIndex:N,defaultActiveIndex:k}))}},49748:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var r=n(14603),a=n(90268),o=n(81816),i=n(52983),s=n(9202),l=n(54221),u=n(30640),c=n(58900),f=n(62868),d=n(99778),m=n(2540);function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t=e["data-testid"],n=(0,s.$)().t,g=(0,o.fQ)().getLink,E=[{key:0,text:n("common:name"),value:"name"},{key:1,text:n("common:description"),value:"description"}],S=(0,l.v9)((function(e){return e.config.ui.features})),v=p((0,i.useState)([]),2),h=v[0],R=v[1],y=p((0,i.useState)(0),2),b=y[0],U=y[1],_=p((0,i.useState)(u.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),1)[0],A=p((0,i.useState)(void 0),2),T=A[0],I=A[1],O=p((0,i.useState)(E[0]),1)[0],C=p((0,i.useState)(!0),1)[0],w=p((0,i.useState)(""),2),M=w[0],L=w[1],P=p((0,i.useState)(!1),2),x=P[0],D=P[1],N=(0,l.I0)(),j=(0,c.zU)({filter:null,limit:null,offset:null,sort:null}),k=j.data,G=j.isLoading,$=j.error,Y=j.mutate;(0,i.useEffect)((function(){if(k){var e=k.filter((function(e){return e.id!==m.RemoteUserStoreConstants.CUSTOMER_USERSTORE_ID}));R(e),I(e)}}),[k]),(0,i.useEffect)((function(){var e,t,o,i,s,l;$&&(null==$||null===(e=$.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)!==d.u4.RESOURCE_NOT_FOUND_ERROR_MESSAGE&&N((0,a.V_)({description:(null==$||null===(o=$.response)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.description)||n("console:manage.features.userstores.notifications.fetchUserstores.genericError.description"),level:r.QU.ERROR,message:(null==$||null===(s=$.response)||void 0===s||null===(l=s.data)||void 0===l?void 0:l.message)||n("console:manage.features.userstores.notifications.fetchUserstores.genericError.message")}))}),[$]),(0,i.useEffect)((function(){I((0,u.fS)(T,O.value,C))}),[O,C]);return i.createElement(o.Xg,{pageTitle:"User Stores",title:n("extensions:manage.features.userStores.list.title"),description:i.createElement(i.Fragment,null,n("extensions:manage.features.userStores.list.subTitle"),i.createElement(o.eb,{link:g("manage.userStores.userStoresList.learnMore")},n("extensions:common.learnMore"))),"data-testid":"".concat(t,"-page-layout")},i.createElement(o.PS,{currentListSize:_,listItemLimit:_,onPageChange:function(e,t){U((t.activePage-1)*_)},leftActionPanel:null,showPagination:!1,showTopActionPanel:!1,totalPages:1,totalListSize:null==T?void 0:T.length,isLoading:G||void 0===T,"data-testid":"".concat(t,"-list-layout")},i.createElement(f.rO,{list:function(e,t,n){return null==e?void 0:e.slice(n,n+t)}(T,_,b),onEmptyListPlaceholderActionClick:function(){return u.m8.push(m.RemoteUserStoreConstants.getPaths().get("REMOTE_USER_STORE_CREATE"))},onSearchQueryClear:function(){D(!x),L(""),I(h)},searchQuery:M,update:function(){return Y()},featureConfig:S,"data-testid":"".concat(t,"-list")})))};E.defaultProps={"data-testid":"userstores"};const S=E}}]);