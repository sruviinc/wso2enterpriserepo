"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[56211],{56211:(e,t,n)=>{n.r(t),n.d(t,{ApplicationRoles:()=>S});var o=n(7955),i=n(57477),a=n(14603),l=n(90268),s=n(13318),c=n(81816),r=n(52983),d=n(9202),p=n(54221),u=n(97860),m=n(74691),f=n(94635),v=n(75917),g=n(20732),h=n(85921),E=n(30640),R=n(65119);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,i,a,l,s=[],c=!0,r=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(s.push(o.value),s.length!==t);c=!0);}catch(e){r=!0,i=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(r)throw i}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var S=function(e){var t,n=e.application,b=e["data-componentid"],S=(0,d.$)().t,A=(0,p.I0)(),x=(0,c.fQ)().getLink,C=y((0,c.ZK)(),3),w=C[0],k=C[1],I=C[2],L=(0,p.v9)((function(e){return e.organization.organization})),P=y((0,r.useState)(!0),2),M=P[0],T=P[1],Z=y((0,r.useState)(!1),2),H=Z[0],O=Z[1],_=y((0,r.useState)(!1),2),z=_[0],U=_[1],V=y((0,r.useState)(!1),2),N=V[0],Q=V[1],j=y((0,r.useState)(!1),2),D=j[0],J=j[1],$=y((0,r.useState)([]),2),F=$[0],K=$[1],W=y((0,r.useState)(),2),X=W[0],B=W[1],q=y((0,r.useState)(null),2),G=q[0],Y=q[1],ee=y((0,r.useState)(void 0),2),te=ee[0],ne=ee[1],oe=y((0,r.useState)(""),2),ie=oe[0],ae=oe[1],le=y((0,r.useState)(E.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),se=le[0],ce=le[1],re=y((0,r.useState)(""),2),de=re[0],pe=re[1],ue=y((0,r.useState)(""),2),me=ue[0],fe=ue[1],ve=y((0,r.useState)(void 0),2),ge=ve[0],he=ve[1],Ee=y((0,r.useState)(void 0),2),Re=Ee[0],ye=Ee[1],be=y((0,r.useState)(1),2),Se=be[0],Ae=be[1],xe=y((0,r.useState)([]),2),Ce=xe[0],we=xe[1],ke=y((0,s.cC)(),2),Ie=ke[0],Le=ke[1],Pe=E.m8.location.pathname.split("/"),Me=Pe[Pe.length-1].split("#")[0],Te=null==n||null===(t=n.advancedConfigurations)||void 0===t?void 0:t.fragment,Ze=(0,R.useSharedApplicationData)(Me,null==L?void 0:L.id),He=Ze.data,Oe=Ze.isLoading,_e=Ze.error;(0,r.useEffect)((function(){He instanceof i.u||_e?Je():He&&null!=He&&He.sharedApplications&&we(null==He?void 0:He.sharedApplications)}),[He]),(0,r.useEffect)((function(){var e,t=!1,n=!1;null==G||null===(e=G.links)||void 0===e||e.forEach((function(e){if("after"===e.rel){var o=e.href.split("after=")[1];pe(o),he(!0),t=!0}if("before"===e.rel){var i=e.href.split("before=")[1];fe(i),ye(!0),n=!0}})),t||(pe(""),he(!1)),n||(fe(""),ye(!1))}),[G]),(0,r.useEffect)((function(){ze(Me,null,null,ie||null,se)}),[se,ie]);var ze=(0,r.useCallback)((function(e,t,n,o,i){(0,R.getApplicationRolesList)(e,t,n,o,i).then((function(e){Y(e),K(e.roles)})).catch((function(e){var t,n,o,i,s,c,r,d,p,u,m;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.description?A((0,l.V_)({description:null!==(o=null!==(i=null==e||null===(s=e.response)||void 0===s||null===(c=s.data)||void 0===c?void 0:c.description)&&void 0!==i?i:null==e||null===(r=e.response)||void 0===r||null===(d=r.data)||void 0===d?void 0:d.detail)&&void 0!==o?o:S("extensions:develop.applications.edit.sections.roles.notifications.fetchApplicationRoles.error.description"),level:a.QU.ERROR,message:null!==(p=null==e||null===(u=e.response)||void 0===u||null===(m=u.data)||void 0===m?void 0:m.message)&&void 0!==p?p:S("extensions:develop.applications.edit.sections.roles.notifications.fetchApplicationRoles.error.message")})):(A((0,l.V_)({description:S("extensions:develop.applications.edit.sections.roles.notifications.fetchApplicationRoles.genericError.description"),level:a.QU.ERROR,message:S("extensions:develop.applications.edit.sections.roles.notifications.fetchApplicationRoles.genericError.message")})),Y({links:[],roles:[]}),K([]))})).finally((function(){T(!1)}))}),[R.getApplicationRolesList,T]),Ue=(0,r.useCallback)((function(){Ae(1),Le()}),[Ae,Le]),Ve=(0,r.useCallback)((function(){ae(""),Ue()}),[ae,Ue]),Ne=(0,r.useCallback)((function(e,t){var n=parseInt(null==t?void 0:t.activePage);n>Se?ze(Me,null,de,ie,se):n<Se&&ze(Me,me,null,ie,se),Ae(n)}),[Se,ie,se,de,me]),Qe=(0,r.useCallback)((function(e,t){ce(t.value),Ue()}),[ce,Ue]),je=function(e){B(e),U(!0)},De=function(){ze(Me,null,null,null,null)},Je=function(){A((0,l.V_)({description:S("extensions:console.applicationRoles.roleMapping.notifications.sharedApplication.error.description"),level:a.QU.ERROR,message:S("extensions:console.applicationRoles.roleMapping.notifications.sharedApplication.error.message")}))},$e=function(){return ie&&0===F.length?r.createElement(c.$J,{action:r.createElement(c.Qj,{onClick:function(){return ae("")}},S("extensions:develop.applications.edit.sections.roles.placeHolders.emptySearchResults.action")),image:(0,E.jF)().emptySearch,imageSize:"tiny",title:S("extensions:develop.applications.edit.sections.roles.placeHolders.emptySearchResults.title"),subtitle:[S("extensions:develop.applications.edit.sections.roles.placeHolders.emptySearchResults.subtitles.0",{query:ie})],"data-componentid":"".concat(b,"-empty-search-placeholder-icon")}):0===F.length?r.createElement(c.$J,{className:"list-placeholder",action:!Te&&r.createElement(o.di,{when:o.TA.APPLICATION_WRITE},r.createElement(c.KM,{onClick:function(){O(!0)}},r.createElement(m.Z,{name:"add"}),S("extensions:develop.applications.edit.sections.roles.placeHolders.emptyList.action"))),image:(0,E.jF)().newList,imageSize:"tiny",title:S("extensions:develop.applications.edit.sections.roles.placeHolders.emptyList.title"),subtitle:[S("extensions:develop.applications.edit.sections.roles.placeHolders.emptyList.subtitles.0")],"data-componentid":"".concat(b,"-empty-placeholder")}):null};return r.createElement(c.pJ,{loading:M||Oe,padded:"very","data-componentid":b},r.createElement(f.Z,null,r.createElement(f.Z.Row,null,r.createElement(f.Z.Column,{className:"heading-wrapper",computer:10},r.createElement(c.X6,{as:"h4"},S("extensions:develop.applications.edit.sections.roles.heading")),r.createElement(c.X6,{subHeading:!0,ellipsis:!0,as:"h6"},S(Te?"extensions:develop.applications.edit.sections.roles.subHeadingAlt":"extensions:develop.applications.edit.sections.roles.subHeading"),r.createElement(c.eb,{link:x("develop.applications.roles.learnMore")},S("extensions:common.learnMore")))),r.createElement(f.Z.Column,{className:"action-wrapper",computer:6},r.createElement("div",{className:"floated right action"},F.length>0&&!Te&&r.createElement(c.KM,{"data-componentid":"".concat(b,"-add-new-role-button"),onClick:function(){return O(!0)}},r.createElement(m.Z,{name:"add"}),S("extensions:develop.applications.edit.sections.roles.buttons.newRole")))))),r.createElement(v.Z,{hidden:!0}),r.createElement(f.Z,null,r.createElement(f.Z.Row,null,r.createElement(f.Z.Column,null,r.createElement(c.PS,{currentListSize:F.length,listItemLimit:se,onItemsPerPageDropdownChange:Qe,onPageChange:Ne,showPagination:!0,showTopActionPanel:!1,showPaginationPageLimit:!1,totalPages:10,totalListSize:F.length,paginationOptions:{disableNextButton:!ge,disablePreviousButton:!Re},resetPagination:Ie,activePage:Se,"data-componentid":"".concat(b,"-list-layout")},r.createElement(c.wQ,{className:"application-roles-table",isLoading:!1,onSearchQueryClear:Ve,actions:[{"data-componentid":"".concat(b,"-item-edit-button"),hidden:function(){return Te},icon:function(){return"pencil alternate"},onClick:function(e,t){return je(t)},popupText:function(){return S("common:edit")},renderer:"semantic-icon"},{"data-componentid":"".concat(b,"-item-delete-button"),hidden:function(){return Te},icon:function(){return"trash alternate"},onClick:function(e,t){return function(e){ne(e),Q(!0)}(t)},popupText:function(){return S("common:delete")},renderer:"semantic-icon"},{"data-componentid":"".concat(b,"-item-view-button"),hidden:function(){return!Te},icon:function(){return"eye"},onClick:function(e,t){return je(t)},popupText:function(){return S("common:view")},renderer:"semantic-icon"}],columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){return r.createElement(u.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentid":"".concat(b,"-item-heading")},r.createElement(c.JT,{image:r.createElement(c.Xo,{name:e.name,size:"mini","data-componentid":"".concat(b,"-item-image-inner")}),size:"mini",spaced:"right","data-componentid":"".concat(b,"-item-image")}),r.createElement(u.Z.Content,null,e.name))},title:S("extensions:develop.applications.edit.sections.roles.list.columns.name")},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:S("extensions:develop.applications.edit.sections.roles.list.columns.actions")}],data:F,onRowClick:function(e,t){return je(t)},placeholders:$e(),showHeader:!1,transparent:!M&&null!==$e(),"data-componentid":"".concat(b,"-data-table")}))))),r.createElement(v.Z,{hidden:!0}),H&&r.createElement(g.CreateApplicationRoleWizard,{"data-componentid":"create-app-role-wizard",onRoleUpdate:De,closeWizard:function(){return O(!1)},appId:Me,sharedApplications:Ce}),r.createElement(h.EditApplicationRole,{"data-componentid":"edit-app-role-wizard",onShowEditRoleModal:U,onRoleUpdate:De,selectedRole:X,appId:Me,showEditRoleModal:z,isReadOnly:Te}),te&&r.createElement(c.cV,{primaryActionLoading:D,onClose:function(){return Q(!1)},type:"negative",open:N,assertionHint:S("extensions:develop.applications.edit.sections.roles.deleteRole.confirmationModal.assertionHint"),assertionType:"checkbox",primaryAction:S("common:confirm"),secondaryAction:S("common:cancel"),onSecondaryActionClick:function(){Q(!1),k(null)},onPrimaryActionClick:function(){return J(!0),void(0,R.deleteRole)(Me,te.name).then((function(){A((0,l.V_)({description:S("extensions:develop.applications.edit.sections.roles.notifications.deleteApplicationRole.success.description"),level:a.QU.SUCCESS,message:S("extensions:develop.applications.edit.sections.roles.notifications.deleteApplicationRole.success.message")})),De()})).catch((function(){k({description:S("extensions:develop.applications.edit.sections.roles.notifications.deleteApplicationRole.genericError.description"),level:a.QU.ERROR,message:S("extensions:develop.applications.edit.sections.roles.notifications.deleteApplicationRole.genericError.message")})})).finally((function(){J(!1),Q(!1)}))},"data-componentid":"".concat(b,"-delete-confirmation-modal"),closeOnDimmerClick:!1},r.createElement(c.cV.Header,{"data-componentid":"".concat(b,"-delete-confirmation-modal-header")},S("extensions:develop.applications.edit.sections.roles.deleteRole.confirmationModal.header")),r.createElement(c.cV.Message,{attached:!0,negative:!0,"data-componentid":"".concat(b,"-delete-confirmation-modal-message")},S("extensions:develop.applications.edit.sections.roles.deleteRole.confirmationModal.message")),r.createElement(c.cV.Content,{"data-componentid":"".concat(b,"-delete-confirmation-modal-content")},r.createElement("div",{className:"modal-alert-wrapper"}," ",w&&I),S("extensions:develop.applications.edit.sections.roles.deleteRole.confirmationModal.content"))))};S.defaultProps={"data-componentid":"application-roles-tab"}}}]);