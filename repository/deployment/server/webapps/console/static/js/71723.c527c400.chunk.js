"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[71723],{90316:(e,t,n)=>{n.d(t,{u:()=>m});var o=n(40904),a=n(57648),l=n(82777),r=n(54278),i=n(62970),s=n(36510),c=n(81816),u=n(52983),d=n(9202),m=function(e){var t,n=e.isOpen,m=e.onClose,p=e.selectedRole,f=e["data-componentid"],g=(0,d.$)().t;return u.createElement(c.cV,{onClose:function(){return m()},type:"negative",open:n,secondaryAction:g("common:close"),onSecondaryActionClick:function(){return m()},"data-testid":f,closeOnDimmerClick:!1},u.createElement(c.cV.Header,{"data-testid":"".concat(f,"-header")},g("console:manage.features.roles.list.confirmations.deleteItemError.header")),u.createElement(c.cV.Message,{attached:!0,negative:!0,"data-testid":"".concat(f,"-message")},g("console:manage.features.roles.list.confirmations.deleteItemError.message")),u.createElement(c.cV.Content,{"data-testid":"".concat(f,"-content")},u.createElement("span",null,g("console:manage.features.roles.list.confirmations.deleteItemError.content")),u.createElement(a.Z,{hidden:!0}),u.createElement(l.Z,null,u.createElement(r.Z,null,u.createElement(i.Z,null,u.createElement(o.sB,null)),u.createElement(s.Z,{primary:null==p||null===(t=p.audience)||void 0===t?void 0:t.display})))))};m.defaultProps={"data-componentid":"role-delete-error-confirmation-modal"}},71723:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var o=n(7955),a=n(20996),l=n(14603),r=n(90268),i=n(81816),s=n(52983),c=n(9202),u=n(54221),d=n(74691),m=n(5873),p=n(61133),f=n(30640),g=n(82915),y=n(96627),h=n(49238),v=n(96433),E=n(83374),R=n(97860),A=n(73949),I=n(90316),b=n(92305),C=n(33834),O=n(65211),L=n(50593);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,l,r,i=[],s=!0,c=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=l.call(n)).done)&&(i.push(o.value),i.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var T=function(e){var t=e.handleRoleDelete,n=e.isSubOrg,a=e.onEmptyListPlaceholderActionClick,l=e.onSearchQueryClear,r=e.roleList,m=e.searchQuery,p=e["data-componentid"],f=(0,c.$)().t,g=(0,u.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),y=(0,u.v9)((function(e){var t,n,o;return null==e||null===(t=e.config)||void 0===t||null===(n=t.ui)||void 0===n||null===(o=n.features)||void 0===o?void 0:o.userRoles})),h=(0,u.v9)((function(e){var t,n;return null==e||null===(t=e.config)||void 0===t||null===(n=t.ui)||void 0===n?void 0:n.administratorRoleDisplayName})),P=(0,s.useMemo)((function(){var e;return!(0,E.cr)(y,L.nL.FEATURE_DICTIONARY.get("ROLE_UPDATE"))||!(0,E.hasRequiredScopes)(y,null==y||null===(e=y.scopes)||void 0===e?void 0:e.update,g)}),[y,g]),T=S((0,s.useState)(!1),2),_=T[0],w=T[1],N=S((0,s.useState)(),2),k=N[0],U=N[1],D=S((0,s.useState)(!1),2),x=D[0],V=D[1],Z=function(e){O.m.push(C.$.getPaths().get("ROLE_EDIT").replace(":id",e))};return s.createElement(s.Fragment,null,s.createElement(i.wQ,{loadingStateOptions:{imageType:"square"},actions:[{icon:function(){return P?"eye":"pencil alternate"},onClick:function(e,t){return!P&&Z(null==t?void 0:t.id)},popupText:function(){return f(P?"common:view":"common:edit")},renderer:"semantic-icon"},{hidden:function(e){var t;return n||(null==e?void 0:e.displayName)===v.nL.ADMIN_ROLE||(null==e?void 0:e.displayName)===v.nL.ADMIN_GROUP||(null==e?void 0:e.displayName)===h||!(0,E.cr)(y,L.nL.FEATURE_DICTIONARY.get("ROLE_DELETE"))||!(0,E.hasRequiredScopes)(y,null==y||null===(t=y.scopes)||void 0===t?void 0:t.delete,g)},icon:function(){return"trash alternate"},onClick:function(e,t){!function(e){var t,n;U(e),(null==e||null===(t=e.audience)||void 0===t||null===(n=t.type)||void 0===n?void 0:n.toUpperCase())===L.cv.APPLICATION?V(!0):w(!0)}(t)},popupText:function(){return f("console:manage.features.roles.list.popups.delete",{type:"Role"})},renderer:"semantic-icon"}],columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){return s.createElement(R.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentid":"".concat(p,"-item-heading")},s.createElement(i.JT,{image:s.createElement(i.Xo,{name:null==e?void 0:e.displayName[0],size:"mini","data-componentid":"".concat(p,"-item-image-inner")}),size:"mini",spaced:"right","data-componentid":"".concat(p,"-item-image")}),s.createElement(R.Z.Content,null,null==e?void 0:e.displayName))},title:f("console:manage.features.roles.list.columns.name")},{allowToggleVisibility:!1,dataIndex:"audience",id:"audience",key:"audience",render:function(e){return(null==e?void 0:e.audience)&&s.createElement(A.Z,{size:"mini"},e.audience.type,e.audience.type.toUpperCase()===L.cv.APPLICATION?" | ".concat(e.audience.display," "):"")},title:s.createElement("div",{className:"pl-3"},f("console:manage.features.roles.list.columns.audience"))},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:null}],data:null==r?void 0:r.Resources,onRowClick:function(e,t){Z(null==t?void 0:t.id)},placeholders:m&&0===(null==r?void 0:r.totalResults)?s.createElement(i.$J,{"data-componentid":"".concat(p,"-search-empty-placeholder"),action:s.createElement(i.Qj,{"data-componentid":"".concat(p,"-search-empty-placeholder-clear-button"),onClick:l},f("console:manage.features.roles.list.emptyPlaceholders.search.action")),image:(0,b.jF)().emptySearch,imageSize:"tiny",title:f("console:manage.features.roles.list.emptyPlaceholders.search.title"),subtitle:[f("console:manage.features.roles.list.emptyPlaceholders.search.subtitles.0",{searchQuery:m}),f("console:manage.features.roles.list.emptyPlaceholders.search.subtitles.1")]}):0===(null==r?void 0:r.totalResults)?s.createElement(i.$J,{"data-componentid":"".concat(p,"-empty-list-empty-placeholder"),action:!n&&s.createElement(o.di,{when:o.TA.ROLE_WRITE},s.createElement(i.KM,{"data-componentid":"".concat(p,"-empty-list-empty-placeholder-add-button"),onClick:a},s.createElement(d.Z,{name:"add"}),f("console:manage.features.roles.list.emptyPlaceholders.emptyRoleList.action",{type:"Role"}))),image:(0,b.jF)().newList,imageSize:"tiny",title:!n&&f("console:manage.features.roles.list.emptyPlaceholders.emptyRoleList.title",{type:"role"}),subtitle:n?[f("console:manage.features.roles.list.emptyPlaceholders.emptyRoleList.subtitles.0",{type:"roles"})]:[f("console:manage.features.roles.list.emptyPlaceholders.emptyRoleList.subtitles.0",{type:"roles"}),f("console:manage.features.roles.list.emptyPlaceholders.emptyRoleList.subtitles.1",{type:"role"}),f("console:manage.features.roles.list.emptyPlaceholders.emptyRoleList.subtitles.2",{type:"role"})]}):null,"data-componentid":p}),_&&s.createElement(i.cV,{"data-componentid":"".concat(p,"-delete-item-confirmation-modal"),onClose:function(){return w(!1)},type:"negative",open:_,assertionHint:f("console:manage.features.roles.list.confirmations.deleteItem.assertionHint"),assertionType:"checkbox",primaryAction:f("common:confirm"),secondaryAction:f("common:cancel"),onSecondaryActionClick:function(){return w(!1)},onPrimaryActionClick:function(){t(k),w(!1)},closeOnDimmerClick:!1},s.createElement(i.cV.Header,null,f("console:manage.features.roles.list.confirmations.deleteItem.header")),s.createElement(i.cV.Message,{attached:!0,negative:!0},f("console:manage.features.roles.list.confirmations.deleteItem.message",{type:"role"})),s.createElement(i.cV.Content,null,f("console:manage.features.roles.list.confirmations.deleteItem.content",{type:"role"}))),x&&s.createElement(I.u,{isOpen:x,onClose:function(){V(!1),U(void 0)},selectedRole:k,"data-componentid":"".concat(p,"-role-delete-error-confirmation-modal")}))};T.defaultProps={"data-componentid":"role-mgt-roles-list"};var _=n(85814);function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,l,r,i=[],s=!0,c=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(o=l.call(n)).done)&&(i.push(o.value),i.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var k=function(e){var t=e["data-componentid"],n=(0,u.I0)(),v=(0,c.$)().t,E=(0,y.z)().organizationType,R=w((0,s.useState)(f.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),A=R[0],I=R[1],b=w((0,s.useState)(0),2),C=b[0],O=b[1],L=w((0,s.useState)(void 0),2),S=L[0],P=L[1],N=w((0,s.useState)(!1),2),k=N[0],U=N[1],D=E===a.$B.SUBORGANIZATION,x=(0,p.Ok)(null,null,null,"name eq Console").data,V=(0,s.useMemo)((function(){var e;return null==x||null===(e=x.applications[0])||void 0===e?void 0:e.id}),[x]),Z=(0,h.bF)(A,C,function(e){return"audience.value ne ".concat(V).concat(e?" and ".concat(e):"")}(S),"users,groups,permissions,associatedApplications"),j=Z.data,M=Z.isLoading,F=Z.error,Q=Z.mutate,z=[{key:void 0,text:v("console:manage.features.roles.list.filterOptions.all"),value:void 0},{key:_.nL.ROLE_AUDIENCE_APPLICATION_FILTER,text:v("console:manage.features.roles.list.filterOptions.applicationRoles"),value:_.nL.ROLE_AUDIENCE_APPLICATION_FILTER},{key:_.nL.ROLE_AUDIENCE_ORGANIZATION_FILTER,text:v("console:manage.features.roles.list.filterOptions.organizationRoles"),value:_.nL.ROLE_AUDIENCE_ORGANIZATION_FILTER}];(0,s.useEffect)((function(){F&&$({description:v("console:manage.features.roles.notifications.fetchRoles.genericError.description"),level:l.QU.ERROR,message:v("console:manage.features.roles.notifications.fetchRoles.genericError.message")})}),[F]);var $=function(e){n((0,r.V_)(e))},q=function(){g.m.push(f.$x.getPaths().get("ROLE_CREATE"))};return s.createElement(i.Xg,{action:!D&&!M&&(null==j?void 0:j.totalResults)>0?s.createElement(o.di,{when:o.TA.ROLE_WRITE},s.createElement(i.KM,{"data-componentid":"".concat(t,"-add-button"),onClick:function(){return q()}},s.createElement(d.Z,{"data-componentid":"".concat(t,"-add-button-icon"),name:"add"}),v("console:manage.features.roles.list.buttons.addButton",{type:"Role"}))):null,title:v("console:manage.pages.roles.title"),pageTitle:v("console:manage.pages.roles.title"),description:v(D?"console:manage.pages.roles.alternateSubTitle":"console:manage.pages.roles.subTitle")},s.createElement(i.PS,{advancedSearch:s.createElement(f.nC,{"data-componentid":"".concat(t,"-list-advanced-search"),onFilter:function(e){"displayName sw "!==e?P(e):Q()},filterAttributeOptions:[{key:0,text:v("console:manage.features.roles.list.filterAttirbutes.name"),value:"displayName"},{key:1,text:v("console:manage.features.roles.list.filterAttirbutes.audience"),value:"audience.type"}],filterAttributePlaceholder:v("console:manage.features.roles.advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:v("console:manage.features.roles.advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:v("console:manage.features.roles.advancedSearch.form.inputs.filterValue.placeholder"),placeholder:v("console:manage.features.roles.advancedSearch.placeholder"),defaultSearchAttribute:"displayName",defaultSearchOperator:"co",triggerClearQuery:k}),currentListSize:null==j?void 0:j.itemsPerPage,listItemLimit:A,onItemsPerPageDropdownChange:function(e,t){I(t.value)},onPageChange:function(e,t){var n=(t.activePage-1)*A;O(n)},showTopActionPanel:(null==j?void 0:j.totalResults)>0||0!==(null==S?void 0:S.length),rightActionPanel:s.createElement(m.Z,{"data-componentid":"".concat(t,"-list-filters-dropdown"),selection:!0,options:z,placeholder:v("console:manage.features.roles.list.buttons.filterDropdown"),onChange:function(e,t){P(t.value)}}),showPagination:(null==j?void 0:j.totalResults)>0,totalPages:Math.ceil((null==j?void 0:j.totalResults)/A),totalListSize:null==j?void 0:j.totalResults,isLoading:M},s.createElement(T,{handleRoleDelete:function(e){(0,h.iy)(e.id).then((function(){$({description:v("console:manage.features.roles.notifications.deleteRole.success.description"),level:l.QU.SUCCESS,message:v("console:manage.features.roles.notifications.deleteRole.success.message")}),Q()})).catch((function(e){e.response&&e.response.data&&e.response.data.detail?$({description:e.response.data.detail,level:l.QU.ERROR,message:v("console:manage.features.roles.notifications.deleteRole.error.message")}):$({description:v("console:manage.features.roles.notifications.deleteRole.genericError.description"),level:l.QU.ERROR,message:v("console:manage.features.roles.notifications.deleteRole.genericError.message")})}))},onEmptyListPlaceholderActionClick:function(){return q()},onSearchQueryClear:function(){U(!k),P(null)},roleList:j,searchQuery:S,isSubOrg:D})))};k.defaultProps={"data-componentid":"roles-mgt"};const U=k}}]);