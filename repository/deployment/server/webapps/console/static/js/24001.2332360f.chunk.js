"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[24001,43351],{24001:(e,t,r)=>{r.r(t),r.d(t,{CreateRoleWizard:()=>U});var n,a=r(14603),l=r(90268),o=r(13318),i=r(81816),s=r(99285),c=r(52983),u=r(9202),m=r(54221),d=r(74691),f=r(21921),p=r(94635),b=r(79960),v=r(43351),y=r(53214),g=r(60611),S=r(82915),E=r(49238),h=r(23362),A=r(99839);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==R(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===R(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,l,o,i=[],s=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}!function(e){e.BASIC_DETAILS="BasicDetails",e.PERM_LIST="PermissionList",e.USER_LIST="UserList",e.GROUP_LIST="GroupList",e.SUMMARY="summary"}(n||(n={}));var U=function(e){var t=e.closeWizard,r=e.initStep,R=e.isAddGroup,w=e.requiredSteps,C=e.showStepper,U=e.submitStep,Z=e["data-testid"],T=(0,u.$)().t,j=(0,m.I0)(),N=O((0,c.useState)(r),2),_=N[0],D=N[1],P=O((0,c.useState)(void 0),2),k=P[0],x=P[1],B=O((0,c.useState)(void 0),2),M=B[0],z=B[1],G=O((0,c.useState)(void 0),2),W=G[0],V=G[1],Y=O((0,c.useState)(A.CONSUMER_USERSTORE),2),Q=Y[0],H=Y[1],$=O((0,c.useState)(!1),2),K=$[0],q=$[1],F=O((0,o.cC)(),2),J=F[0],X=F[1],ee=O((0,o.cC)(),2),te=ee[0],re=ee[1],ne=O((0,c.useState)([]),2),ae=ne[0],le=ne[1],oe=O((0,c.useState)(!1),1)[0];(0,c.useEffect)((function(){V(me([n.BASIC_DETAILS,n.USER_LIST]))}),[]),(0,c.useEffect)((function(){void 0!==k&&(D(_-1),x(void 0))}),[k]),(0,c.useEffect)((function(){oe&&M&&M[n.BASIC_DETAILS]&&ie(M[n.BASIC_DETAILS])}),[M&&M[n.BASIC_DETAILS]]);var ie=function(e){var r,n,o,i,s,c,u,m,d=[],f=[],p=[];(null==e||null===(r=e.UserList)||void 0===r?void 0:r.length)>0&&(null==e||null===(u=e.UserList)||void 0===u||u.forEach((function(e){null==d||d.push({display:null==e?void 0:e.userName,value:null==e?void 0:e.id})})));(null==e||null===(n=e.GroupList)||void 0===n?void 0:n.length)>0&&(null==e||null===(m=e.GroupList)||void 0===m||m.forEach((function(e){null==f||f.push({display:e.displayName,value:e.id})})));(null==e||null===(o=e.BasicDetails)||void 0===o||null===(i=o.permissions)||void 0===i?void 0:i.length)>0&&e.BasicDetails.permissions.forEach((function(e){null==p||p.push(null==e?void 0:e.key.toString())}));var b={displayName:null!=e&&null!==(s=e.BasicDetails)&&void 0!==s&&null!==(c=s.basic)&&void 0!==c&&c.roleName?e.BasicDetails.basic.roleName:null==e?void 0:e.roleName,groups:f,permissions:p,schemas:["urn:ietf:params:scim:schemas:extension:2.0:Role"],users:d};q(!0),(0,E.fA)(b).then((function(e){201===e.status&&(j((0,l.V_)({description:T("console:manage.features.roles.notifications.createRole.success.description"),level:a.QU.SUCCESS,message:T("console:manage.features.roles.notifications.createRole.success.message")})),S.m.push(g.$x.getPaths().get("ROLE_EDIT").replace(":id",e.data.id)))})).catch((function(e){e.response&&401!==e.response.status?e.response&&e.response.data.detail?j((0,l.V_)({description:T("console:manage.features.roles.notifications.createRole.error.description",{description:e.response.data.detail}),level:a.QU.ERROR,message:T("console:manage.features.roles.notifications.createRole.error.message")})):j((0,l.V_)({description:T("console:manage.features.roles.notifications.createRole.genericError.description"),level:a.QU.ERROR,message:T("console:manage.features.roles.notifications.createRole.genericError.message")})):j((0,l.V_)({description:T("console:manage.features.roles.notifications.createRole.error.description"),level:a.QU.ERROR,message:T("console:manage.features.roles.notifications.createRole.error.message")}))})).finally((function(){q(!1),t()}))},se=function(e){ie(e)},ce=function(){if(M)return M},ue=function(){switch(_){case 0:X();break;case 1:e=I({},n.USER_LIST,ae),U===n.USER_LIST||oe||D(_+1),U===n.SUMMARY||U!==n.USER_LIST?z(L(L({},M),e)):se(L(L({},M),e));break;case 3:re()}var e},me=function(e){var t=function(e){var t=[];return e.forEach((function(e){e===n.BASIC_DETAILS?t.push(de()):e===n.USER_LIST?t.push(fe()):e===n.SUMMARY&&t.push(pe())})),t};return t(w?(0,s.Z)(e,w):e)},de=function(){return{content:c.createElement(b.RoleBasics,{"data-testid":"add-role-form",isAddGroup:R,triggerSubmit:J,initialValues:M&&M[n.BASIC_DETAILS],onSubmit:function(e){return function(e,t){n.BASIC_DETAILS===t&&H(e.domain),U===t||oe||D(_+1),z(L(L({},M),{},I({},t,e))),U===n.SUMMARY||U!==t||se(L(L({},M),{},I({},t,e)))}(e,n.BASIC_DETAILS)}}),icon:c.createElement(d.Z,{name:"key",inverted:!0,size:"large"}),name:n.BASIC_DETAILS,title:"Permissions"}},fe=function(){return{content:c.createElement(y.AddRoleUsers,{"data-testid":"new-role",isEdit:!1,isGroup:!1,userStore:Q,initialValues:ae,handleTempUsersListChange:function(e){le(e)}}),icon:(0,h.T)().assignUser,name:n.USER_LIST,title:"Users"}},pe=function(){return{content:c.createElement(v.CreateRoleSummary,{"data-testid":"add-role-summary",isAddGroup:R,triggerSubmit:te,onSubmit:se,summary:ce()}),icon:(0,h.T)().summary,name:n.SUMMARY,title:T("console:manage.features.roles.addRoleWizard.wizardSteps.3")}};return c.createElement(f.Z,{open:!0,className:"wizard create-role-wizard",dimmer:"blurring",size:"small",onClose:t,closeOnDimmerClick:!1,closeOnEscape:!1,"data-testid":Z},c.createElement(f.Z.Header,{className:"wizard-header"},T("console:manage.features.roles.addRoleWizard.heading",{type:"Role"}),c.createElement(i.X6,{as:"h6"},"Assign permissions to a new role and add collaborator users to the role.")),C&&c.createElement(f.Z.Content,{className:"steps-container"},c.createElement(i.Rg.Group,{current:_},null==W?void 0:W.map((function(e,t){return c.createElement(i.Rg.Step,{key:t,icon:e.icon,title:e.title})})))),c.createElement(f.Z.Content,{className:"content-container",scrolling:!0},function(){var e,t,r,a;if(!W)return null;switch(null===(e=W[_])||void 0===e?void 0:e.name){case n.BASIC_DETAILS:return null===(t=de())||void 0===t?void 0:t.content;case n.USER_LIST:return null===(r=fe())||void 0===r?void 0:r.content;case n.SUMMARY:return null===(a=pe())||void 0===a?void 0:a.content}}()),c.createElement(f.Z.Actions,null,c.createElement(p.Z,null,c.createElement(p.Z.Row,{column:1},c.createElement(p.Z.Column,{mobile:8,tablet:8,computer:8},c.createElement(i.Qj,{floated:"left",onClick:function(){return t()},"data-testid":"".concat(Z,"-cancel-button")},T("common:cancel"))),c.createElement(p.Z.Column,{mobile:8,tablet:8,computer:8},_<(null==W?void 0:W.length)-1&&c.createElement(i.KM,{floated:"right",onClick:ue,"data-testid":"".concat(Z,"-next-button")},T("console:manage.features.roles.addRoleWizard.buttons.next"),c.createElement(d.Z,{name:"arrow right","data-testid":"".concat(Z,"-next-button-icon")})),_===(null==W?void 0:W.length)-1&&c.createElement(i.KM,{floated:"right",onClick:ue,loading:K,disabled:K,"data-testid":"".concat(Z,"-finish-button")},T("console:manage.features.roles.addRoleWizard.buttons.finish")),_>0&&c.createElement(i.Qj,{floated:"right",onClick:function(){x(_)},"data-testid":"".concat(Z,"-previous-button")},c.createElement(d.Z,{name:"arrow left","data-testid":"".concat(Z,"-previous-button-icon")}),T("console:manage.features.roles.addRoleWizard.buttons.previous")))))))};U.defaultProps={initStep:0,requiredSteps:[n.BASIC_DETAILS,n.USER_LIST],showStepper:!0,submitStep:n.SUMMARY}},43351:(e,t,r)=>{r.r(t),r.d(t,{CreateRoleSummary:()=>p});var n=r(81816),a=r(42363),l=r(52983),o=r(9202),i=r(94635),s=r(73949),c=r(86407);function u(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,l,o,i=[],s=!0,c=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=l.call(r)).done)&&(i.push(n.value),i.length!==t);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return i}}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var p=function(e){var t,r,d=e.summary,f=e.triggerSubmit,p=e.onSubmit,b=e.isAddGroup,v=e["data-testid"],y=(0,o.$)().t,g=m((0,l.useState)([]),2),S=g[0],E=g[1],h=m((0,l.useState)([]),2),A=h[0],R=h[1],w=m((0,l.useState)([]),2),L=w[0],I=w[1];(0,l.useEffect)((function(){c.J.getAllPermissions().then((function(e){if(E(e),R([e[0].key.toString()]),d&&d.PermissionList){var t=d.PermissionList;I([].concat(u(L),u(t.map((function(e){return e.key})))))}}))}),[S.length>0]),(0,l.useEffect)((function(){f&&p(d)}),[f]);return l.createElement(i.Z,{className:"wizard-summary"},(null==d?void 0:d.BasicDetails)&&l.createElement(l.Fragment,null,l.createElement(i.Z.Row,{className:"summary-field",columns:2},l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},l.createElement("div",{"data-testid":"".concat(v,"-role-name-label"),className:"label"},y("console:manage.features.roles.addRoleWizard.summary.labels.roleName",b?{type:"Group"}:{type:"Role"}))),l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},l.createElement("div",{"data-testid":"".concat(v,"-role-name-value"),className:"value url"},d.BasicDetails.roleName)))),(null==d?void 0:d.PermissionList)&&d.PermissionList instanceof Array&&d.PermissionList.length>0&&l.createElement(i.Z.Row,{className:"summary-field",columns:2},l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},l.createElement("div",{"data-testid":"".concat(v,"-permissions-label"),className:"label"},y("console:manage.features.roles.addRoleWizard.summary.labels.permissions"))),l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},l.createElement(s.Z.Group,null,l.createElement(a.Z,{className:"customIcon","data-testid":"".concat(v,"-tree"),disabled:!0,checkedKeys:L,defaultExpandedKeys:A,showLine:!0,showIcon:!1,checkable:!0,selectable:!1,treeData:S,switcherIcon:function(e){return e.isLeaf?null:l.createElement("div",{className:"tree-arrow-wrap"},l.createElement("span",{className:"tree-arrow ".concat(e.expanded?"":"active")},l.createElement("span",null),l.createElement("span",null)))}})))),null!=d&&d.UserList&&(null==d?void 0:d.UserList)instanceof Array&&(null==d||null===(t=d.UserList)||void 0===t?void 0:t.length)>0?l.createElement(i.Z.Row,{className:"summary-field",columns:2},l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},l.createElement("div",{"data-testid":"".concat(v,"-users-label"),className:"label"},y("console:manage.features.roles.addRoleWizard.summary.labels.users"))),l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},l.createElement(s.Z.Group,null,null==d?void 0:d.UserList.map((function(e,t){return l.createElement("div",{key:t,className:"role-summary-user"},l.createElement(n.Yt,{name:e.userName,size:"mini",floated:"left",image:e.profileUrl}),e.userName)}))))):null,null!=d&&d.GroupList&&(null==d?void 0:d.GroupList)instanceof Array&&(null==d||null===(r=d.GroupList)||void 0===r?void 0:r.length)>0?l.createElement(i.Z.Row,{className:"summary-field",columns:2},l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:7,textAlign:"right"},l.createElement("div",{"data-testid":"".concat(v,"-users-label"),className:"label"},y("console:manage.features.roles.addRoleWizard.summary.labels.groups"))),l.createElement(i.Z.Column,{mobile:16,tablet:8,computer:8,textAlign:"left"},l.createElement(s.Z.Group,null,null==d?void 0:d.GroupList.map((function(e,t){return l.createElement(s.Z,{"data-testid":"".concat(v,"-permissions-").concat(t,"-label"),key:t,basic:!0,circular:!0},null==e?void 0:e.displayName)}))))):null)}},23362:(e,t,r)=>{r.d(t,{T:()=>n.T});var n=r(70056)},70056:(e,t,r)=>{r.d(t,{T:()=>i});var n=r(62211),a=r(24941),l=r(88234),o=r(33377),i=function(){return{assignUser:o.r,general:n.r,permissions:a.r,summary:l.r}}},24941:(e,t,r)=>{r.d(t,{r:()=>c});var n,a=r(52983),l=["title","titleId"];function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o.apply(this,arguments)}function i(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},l=Object.keys(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)r=l[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=function(e,t){var r=e.title,s=e.titleId,c=i(e,l);return a.createElement("svg",o({id:"key-icon",className:"icon",xmlns:"http://www.w3.org/2000/svg",width:14,height:14,viewBox:"0 0 14 14",style:{enableBackground:"new 0 0 14 14"},xmlSpace:"preserve",ref:t,"aria-labelledby":s},c),r?a.createElement("title",{id:s},r):null,n||(n=a.createElement("path",{className:"path fill primary",d:"M.292,14A.292.292,0,0,1,0,13.708V11.375a.291.291,0,0,1,.086-.206l1.081-1.082V9.625a.292.292,0,0,1,.292-.292h.463l.413-.412V8.458a.292.292,0,0,1,.292-.292h.463L3.5,7.754V7.292A.292.292,0,0,1,3.792,7h.463l.292-.292-.377-.377a.291.291,0,0,1,.076-.467L4.766,5.6a4.606,4.606,0,0,1-.1-.937A4.667,4.667,0,1,1,8.4,9.234l-.26.521a.292.292,0,0,1-.467.076l-.377-.377-4.46,4.46A.3.3,0,0,1,2.625,14ZM1.75,10.209a.294.294,0,0,1-.085.206L.583,11.5v1.921H2.5L7.086,8.835a.292.292,0,0,1,.412,0l.3.3.183-.365a.292.292,0,0,1,.334-.152A4.081,4.081,0,1,0,5.25,4.667a4.116,4.116,0,0,0,.135,1.022.293.293,0,0,1-.152.334L4.867,6.2l.3.3a.291.291,0,0,1,0,.412L4.581,7.5a.291.291,0,0,1-.206.086H4.083v.292A.291.291,0,0,1,4,8.081l-.583.583a.291.291,0,0,1-.206.086H2.917v.292a.289.289,0,0,1-.086.206l-.583.584a.294.294,0,0,1-.206.085H1.75Zm.086,1.956a.292.292,0,0,1,0-.412L5.918,7.669a.291.291,0,0,1,.412.412L2.247,12.164a.291.291,0,0,1-.412,0Zm7.5-8.956a1.458,1.458,0,1,1,1.458,1.458A1.46,1.46,0,0,1,9.333,3.209Zm.583,0a.875.875,0,1,0,.875-.875A.876.876,0,0,0,9.916,3.209Z"})))},c=(0,a.forwardRef)(s)}}]);