"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[60612,49282,50358],{49282:(e,n,t)=>{t.r(n),t.d(n,{getAllApplicationRolesList:()=>s,getAssignedApplicationRolesList:()=>r,updateGroupRoleMapping:()=>c});var o=t(93967),a=t(14603),i=t(30640),l=o.AsgardeoSPAClient.getInstance().httpRequest.bind(o.AsgardeoSPAClient.getInstance()).bind(o.AsgardeoSPAClient.getInstance()),r=function(e){var n={method:a.f2.GET,url:"".concat(i.h.getState().config.endpoints.authzEndpoint,"/groups/").concat(e,"/role-mapping")};return l(n).then((function(e){return Promise.resolve(e.data.app_roles)})).catch((function(e){return Promise.reject(e)}))},s=function(){var e={method:a.f2.GET,url:"".concat(i.h.getState().config.endpoints.authzEndpoint,"/roles")};return l(e).then((function(e){return Promise.resolve(e.data.app_roles)})).catch((function(e){return Promise.reject(e)}))},c=function(e,n){var t={data:n,method:a.f2.PATCH,url:"".concat(i.h.getState().config.endpoints.authzEndpoint,"/groups/").concat(e,"/role-mapping")};return l(t).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.reject(e)}))}},99944:(e,n,t)=>{t.r(n),t.d(n,{GroupsConstants:()=>s});var o=t(30640);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,r(o.key),o)}}function l(e,n,t){return(n=r(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e){var n=function(e,n){if("object"!==a(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!==a(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===a(n)?n:String(n)}var s=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}var n,t,a;return n=e,a=[{key:"getPaths",value:function(){return(new Map).set("APPLICATIONS","".concat(o.$x.getDeveloperViewBasePath(),"/")+"".concat(this.APPLICATION_RESOURCE_DIR))}}],(t=null)&&i(n.prototype,t),a&&i(n,a),Object.defineProperty(n,"prototype",{writable:!1}),e}();l(s,"APPLICATION_RESOURCE_DIR","applications"),l(s,"DEBOUNCE_TIMEOUT",1e3)},60612:(e,n,t)=>{t.r(n),t.d(n,{GroupRolesList:()=>x});var o=t(14603),a=t(90268),i=t(81816),l=t(52983),r=t(9202),s=t(54221),c=t(74691),u=t(97860),p=t(73949),d=t(10594),m=t(21228),f=t(21921),g=t(94635),v=t(14969),h=t(75917),E=t(61133),y=t(30640),b=t(49282),R=t(99944);function A(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,a,i,l,r=[],s=!0,c=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=i.call(t)).done)&&(r.push(o.value),r.length!==n);s=!0);}catch(e){c=!0,a=e}finally{try{if(!s&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw a}}return r}}(e,n)||S(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,n){if(e){if("string"==typeof e)return w(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?w(e,n):void 0}}function w(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}var x=function(e){var n=e.isReadOnly,t=e.group,S=e.onGroupUpdate,w=e.isGroupDetailsRequestLoading,x=e["data-componentid"],Z=(0,r.$)().t,L=(0,s.I0)(),I=(0,i.fQ)().getLink,P=C((0,i.IK)(),3),O=P[0],k=P[1],N=P[2],_=C((0,l.useState)(null),2),z=_[0],T=_[1],U=C((0,l.useState)([]),2),j=U[0],H=U[1],M=C((0,l.useState)([]),2),G=M[0],Q=M[1],F=C((0,l.useState)([]),2),V=F[0],J=F[1],D=C((0,l.useState)([]),2),$=D[0],B=D[1],X=C((0,l.useState)(!0),2),K=X[0],q=X[1],Y=C((0,l.useState)(!0),2),W=Y[0],ee=Y[1],ne=C((0,l.useState)(!0),2),te=ne[0],oe=ne[1],ae=C((0,l.useState)(!1),2),ie=ae[0],le=ae[1],re=C((0,l.useState)([]),2),se=re[0],ce=re[1],ue=C((0,l.useState)([]),2),pe=ue[0],de=ue[1],me=C((0,l.useState)([]),2),fe=me[0],ge=me[1],ve=C((0,l.useState)([]),2),he=ve[0],Ee=ve[1],ye=C((0,l.useState)([]),2),be=ye[0],Re=ye[1],Ae=C((0,l.useState)(!1),2),Ce=Ae[0],Se=Ae[1];(0,l.useEffect)((function(){(0,E.AY)(null,null,null).then((function(e){T(e.applications)})).catch((function(e){e.response&&e.response.data&&e.response.data.description?L((0,a.V_)({description:e.response.data.description,level:o.QU.ERROR,message:Z("console:develop.features.applications.notifications.fetchApplications.error.message")})):L((0,a.V_)({description:Z("console:develop.features.applications.notifications.fetchApplications.genericError.description"),level:o.QU.ERROR,message:Z("console:develop.features.applications.notifications.fetchApplications.genericError.message")}))})).finally((function(){oe(!1)}))}),[]),(0,l.useEffect)((function(){z&&(Le(),Ie())}),[t,z]);var we,xe=function(){return y.m8.push(R.GroupsConstants.getPaths().get("APPLICATIONS"))},Ze=function(e){return z&&0!==(null==z?void 0:z.length)?null==e?void 0:e.filter((function(e){return Pe(e.app)})):[]},Le=function(){q(!0),(0,b.getAssignedApplicationRolesList)(encodeURIComponent(null==t?void 0:t.displayName)).then((function(e){var n=Ze(e);Q(n),B(n),Ne(n),Re(ke(n))})).catch((function(e){var n,t,i,l,r,s,c,u,p,d,m;null!=e&&null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.description?L((0,a.V_)({description:null!==(i=null!==(l=null==e||null===(r=e.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.description)&&void 0!==l?l:null==e||null===(c=e.response)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.detail)&&void 0!==i?i:Z("extensions:manage.groups.edit.roles.notifications.fetchAssignedApplicationRoles.error.description"),level:o.QU.ERROR,message:null!==(p=null==e||null===(d=e.response)||void 0===d||null===(m=d.data)||void 0===m?void 0:m.message)&&void 0!==p?p:Z("extensions:manage.groups.edit.roles.notifications.fetchAssignedApplicationRoles.error.message")})):(L((0,a.V_)({description:Z("extensions:manage.groups.edit.roles.notifications.fetchAssignedApplicationRoles.genericError.description"),level:o.QU.ERROR,message:Z("extensions:manage.groups.edit.roles.notifications.fetchAssignedApplicationRoles.genericError.message")})),Q([]),B([]))})).finally((function(){q(!1)}))},Ie=function(){ee(!0),(0,b.getAllApplicationRolesList)().then((function(e){var n=Ze(e);H(n),J(n)})).catch((function(e){var n,t,i,l,r,s,c,u,p,d,m;null!=e&&null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.description?L((0,a.V_)({description:null!==(i=null!==(l=null==e||null===(r=e.response)||void 0===r||null===(s=r.data)||void 0===s?void 0:s.description)&&void 0!==l?l:null==e||null===(c=e.response)||void 0===c||null===(u=c.data)||void 0===u?void 0:u.detail)&&void 0!==i?i:Z("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.error.description"),level:o.QU.ERROR,message:null!==(p=null==e||null===(d=e.response)||void 0===d||null===(m=d.data)||void 0===m?void 0:m.message)&&void 0!==p?p:Z("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.error.message")})):(L((0,a.V_)({description:Z("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.genericError.description"),level:o.QU.ERROR,message:Z("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.genericError.message")})),H([]),J([]))})).finally((function(){ee(!1)}))},Pe=function(e){var n=null==z?void 0:z.find((function(n){return n.id===e}));return null==n?void 0:n.name},Oe=function(e){return l.createElement(u.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentId":"".concat(x,"-item-heading")},l.createElement(i.JT,{image:l.createElement(i.Xo,{name:Pe(e),size:"mini"}),size:"mini",spaced:"right","data-testid":"".concat(x,"-item-application-name")}),l.createElement(u.Z.Content,{className:"align-self-center"},Pe(e),l.createElement(u.Z.Subheader,null,l.createElement(p.Z,{size:"mini",className:"ml-0"},Z("extensions:manage.groups.edit.roles.rolesList.applicationLabel")))))},ke=function(e){var n=[];return e.map((function(e){n.push(e.app)})),n},Ne=function(e){var n=[];e.map((function(e){var t=e.app;e.roles.map((function(e){n.push(t+":"+e.name)}))})),ge(n)},_e=function(e,n,t,o,a){n.length>0?ze(n,t,o,a):(o(t),a(ke(t)))},ze=function(e,n,t,o){if(""!==e){var a=n.filter((function(n){var t;return-1!==(null===(t=Pe(n.app))||void 0===t?void 0:t.toLowerCase().indexOf(e.toLowerCase()))})),i=A(n),l=[],r=[];i.forEach((function(n){var t=n.roles.filter((function(n){var t;return-1!==(null===(t=n.name)||void 0===t?void 0:t.toLowerCase().indexOf(e.toLowerCase()))}));if(void 0!==t&&0!==t.length){l.includes(n.app)||l.push(n.app);var o={app:n.app,roles:t};r.push(o)}a.map((function(e){e.app===n.app&&0===t.length&&r.push(n)}))})),t(r),o(l)}},Te=function(){le(!0)},Ue=function(){ce([]),de([]),Ne(G),le(!1)},je=function(e){var n=[];return e.map((function(e){var t=e.split(":")[0],o=e.split(":")[1];if(n.some((function(e){return e.app===t}))){var a=n.findIndex((function(e){return e.app===t})),i=n[a];i.roles.push({name:o}),n[a]=i}else n.push({app:t,roles:[{name:o}]})})),n},He=function(){var e={added_roles:je(se),removed_roles:je(pe)};Se(!0),(0,b.updateGroupRoleMapping)(encodeURIComponent(null==t?void 0:t.displayName),e).then((function(){L((0,a.V_)({description:Z("extensions:manage.groups.edit.roles.notifications.updateApplicationRoles.success.description"),level:o.QU.SUCCESS,message:Z("extensions:manage.groups.edit.roles.notifications.updateApplicationRoles.success.message")})),S(t.id)})).catch((function(){k({description:Z("extensions:manage.groups.edit.roles.notifications.updateApplicationRoles.genericError.description"),level:o.QU.ERROR,message:Z("extensions:manage.groups.edit.roles.notifications.updateApplicationRoles.genericError.message")})})).finally((function(){Se(!1),le(!1)}))},Me=function(e,n,t){var o=A(n);null!=n&&n.includes(e.app)?o=o.filter((function(n){return n!==e.app})):o.push(e.app),t(o)},Ge=function(e,n){return l.createElement(l.Fragment,null,l.createElement(i.xv,{size:13,className:"mb-1"},Z("extensions:manage.groups.edit.roles.rolesList.applicationRolesLabel")),l.createElement(d.Z,{singleLine:!0,padded:!0,"data-componentId":"".concat(x,"-list"),fixed:!0},l.createElement(d.Z.Body,null,l.createElement(l.Fragment,null,e.map((function(e,t){return l.createElement(d.Z.Row,{key:e.name,verticalAlign:"middle"},l.createElement(d.Z.Cell,{singleLine:!0,width:10},l.createElement("div",null,e.name)),l.createElement(d.Z.Cell,{key:e.name,singleLine:!0,width:5,textAlign:"right"},l.createElement(m.Z,{"data-componentid":"".concat(x,"-role-item-").concat(t),checked:fe&&fe.some((function(t){return t===n+":"+e.name})),onClick:function(){return function(e,n){var t=e+":"+n;if(fe.includes(t)){var o=fe.filter((function(e){return e!==t}));if(ge(o),se.includes(t)){var a=se.filter((function(e){return e!==t}));ce(a)}else{var i=A(pe).concat(t);de(i)}}else{var l=A(fe).concat(t);if(ge(l),pe.includes(t)){var r=pe.filter((function(e){return e!==t}));de(r)}else{var s=A(se).concat(t);ce(s)}}}(n,e.name)}})),l.createElement(d.Z.Cell,{singleLine:!0,width:1}))}))))))};return l.createElement(i.pJ,{padded:"very"},l.createElement(i.X6,{as:"h4"},Z("extensions:manage.groups.edit.roles.heading")),l.createElement(i.X6,{subHeading:!0,ellipsis:!0,as:"h6"},Z("extensions:manage.groups.edit.roles.description"),l.createElement(i.eb,{link:I("manage.groups.roles.learnMore")},Z("extensions:common.learnMore"))),l.createElement(h.Z,{hidden:!0}),l.createElement(g.Z,null,l.createElement(g.Z.Row,null,l.createElement(g.Z.Column,{computer:16},w||K||te||W?l.createElement(i.pO,null):(null==j?void 0:j.length)>0&&(null==G?void 0:G.length)>0?l.createElement(i.pJ,{"data-componentid":"group-mgt-application-roles-list",className:"user-group-role-header-segment"},l.createElement(g.Z.Row,null,l.createElement(g.Z.Column,{mobile:16,tablet:16,computer:12},l.createElement(v.Z,{"data-componentid":"".concat(x,"-roles-list-search-input"),icon:l.createElement(c.Z,{name:"search"}),onChange:function(e,n){var t=n.value;_e(0,t,G,B,Re)},placeholder:Z("extensions:manage.groups.edit.roles.searchPlaceholder"),floated:"left",size:"small"}),!n&&l.createElement(i.GI,{content:Z("extensions:manage.groups.edit.roles.editHoverText"),inverted:!0,trigger:l.createElement(i.zx,{"data-componentid":"".concat(x,"-roles-list-edit-button"),size:"medium",icon:"pencil",floated:"right",onClick:Te})}))),l.createElement(g.Z.Row,null,l.createElement(g.Z.Column,{mobile:16,tablet:16,computer:12},l.createElement(i.el,{fluid:!0,"data-componentid":"".concat(x,"-application-roles"),viewType:"table-view"},(we=$,l.createElement(l.Fragment,null,null==we?void 0:we.map((function(e,n){return l.createElement(l.Fragment,{key:e.app},l.createElement(i.el.Title,{id:e.app,"data-componentid":"".concat(x,"-list-app-title-").concat(n),active:null==be?void 0:be.includes(e.app),accordionIndex:e.app,className:"nested-list-accordion-title",onClick:function(){return Me(e,be,Re)},hideChevron:!1,content:Oe(e.app)}),l.createElement(i.el.Content,{active:null==be?void 0:be.includes(e.app),className:"nested-list-accordion-content-text","data-componentid":"".concat(x,"-").concat(e.app,"-content"),children:(t=e.roles,l.createElement(l.Fragment,null,l.createElement(i.xv,{size:13,className:"mb-1"},Z("extensions:manage.groups.edit.roles.rolesList.applicationRolesLabel")),l.createElement(d.Z,{singleLine:!0,padded:!0,"data-componentId":"".concat(x,"-list"),fixed:!0},l.createElement(d.Z.Body,null,l.createElement(l.Fragment,null,t.map((function(e){return l.createElement(d.Z.Row,{key:e.name,verticalAlign:"middle"},l.createElement(d.Z.Cell,{key:e.name,singleLine:!0,width:15},l.createElement("div",null,e.name)))})))))))}));var t})))))))):l.createElement(g.Z.Row,null,l.createElement(g.Z.Column,{mobile:16,tablet:16,computer:12},l.createElement(i.pJ,null,0===(null==j?void 0:j.length)?l.createElement(i.$J,{image:(0,y.jF)().emptySearch,action:l.createElement(i.rU,{"data-componentid":"".concat(x,"-link-api-resource-page"),onClick:xe,external:!1},Z("extensions:manage.groups.edit.roles.placeHolders.emptyRoles.action")),imageSize:"tiny",title:Z("extensions:manage.groups.edit.roles.placeHolders.emptyRoles.title"),subtitle:[Z("extensions:manage.groups.edit.roles.placeHolders.emptyRoles.subtitles.0"),Z("extensions:manage.groups.edit.roles.placeHolders.emptyRoles.subtitles.1")],"data-componentid":"".concat(x,"-sub-empty-placeholder-icon")}):0===(null==G?void 0:G.length)?l.createElement(i.$J,{title:Z("extensions:manage.groups.edit.roles.placeHolders.emptyList.title"),subtitle:[Z("extensions:manage.groups.edit.roles.placeHolders.emptyList.subtitles.0")],action:!n&&l.createElement(i.KM,{"data-componentid":"".concat(x,"-empty-assign-roles-button"),onClick:Te},l.createElement(c.Z,{name:"plus"}),Z("extensions:manage.groups.edit.roles.placeHolders.emptyList.action")),image:(0,y.jF)().emptyList,imageSize:"tiny"}):void 0))),!te&&!W&&l.createElement(f.Z,{"data-componentid":"".concat(x,"-assign-role-wizard-modal"),className:"wizard",dimmer:"blurring",open:ie,size:"small"},l.createElement(f.Z.Header,null,Z("extensions:manage.groups.edit.roles.addNewModal.heading"),l.createElement(i.X6,{subHeading:!0,ellipsis:!0,as:"h6"},Z("extensions:manage.groups.edit.roles.addNewModal.subHeading"))),l.createElement(f.Z.Content,{className:"content-container",scrolling:!0},O&&N,l.createElement(g.Z,{className:"transfer-list"},l.createElement(g.Z.Row,null,l.createElement(g.Z.Column,null,l.createElement(v.Z,{"data-componentid":"".concat(x,"-roles-list-search-input"),icon:l.createElement(c.Z,{name:"search"}),onChange:function(e,n){var t=n.value;_e(0,t,j,J,Ee)},placeholder:Z("extensions:manage.groups.edit.roles.searchPlaceholder"),floated:"left",size:"small",fluid:!0}))),l.createElement(g.Z.Row,null,l.createElement(g.Z.Column,null,l.createElement(i.el,{"data-componentid":"".concat(x,"-application-roles"),viewType:"table-view"},V.map((function(e,n){return l.createElement(l.Fragment,{key:e.app},l.createElement(i.el.Title,{id:e.app,"data-componentid":"".concat(x,"-edit-app-title-").concat(n),attached:!0,active:null==he?void 0:he.includes(e.app),accordionIndex:e.app,className:"nested-list-accordion-title",onClick:function(){return Me(e,he,Ee)},hideChevron:!1,content:Oe(e.app)}),l.createElement(i.el.Content,{active:null==he?void 0:he.includes(e.app),className:"nested-list-accordion-content-checkbox","data-componentid":"".concat(x,"-").concat(e.app,"-content"),children:Ge(e.roles,e.app)}))}))))))),l.createElement(f.Z.Actions,null,l.createElement(g.Z,null,l.createElement(g.Z.Row,{columns:2},l.createElement(g.Z.Column,{mobile:8,tablet:8,computer:8},l.createElement(i.Qj,{"data-componentid":"".concat(x,"-assign-role-wizard-modal-cancel-button"),onClick:Ue,floated:"left"},Z("common:cancel"))),l.createElement(g.Z.Column,{mobile:8,tablet:8,computer:8},l.createElement(i.KM,{"data-componentid":"".concat(x,"-assign-role-wizard-modal-save-button"),onClick:He,floated:"right",loading:Ce,disabled:Ce},Z("common:save")))))))))))}}}]);