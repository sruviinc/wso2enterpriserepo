"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[39871,1109,20091,27910,13815],{20091:(e,n,t)=>{t.r(n),t.d(n,{updateEventConfigurations:()=>E,useEventConfig:()=>c});var r=t(93967),o=t(57477),i=t(14603),a=t(43991),u=t(26187),l=t(27910),s=r.AsgardeoSPAClient.getInstance().httpRequest.bind(r.AsgardeoSPAClient.getInstance()),c=function(){var e={headers:{Accept:"application/json","Content-Type":"application/json"},method:i.f2.GET,url:u.h.getState().config.endpoints.eventsEndpoint},n=(0,a.Z)(e),t=n.data,r=n.error;return{data:t,error:r,isLoading:!r&&!t,isValidating:n.isValidating,mutate:n.mutate}},E=function(e){var n={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:i.f2.PUT,url:u.h.getState().config.endpoints.eventsEndpoint};return s(n).then((function(e){if(200!==e.status&&201!==e.status)throw new o.u(l.EventManagementConstants.ErrorMessages.EVENT_CONFIGURATION_UPDATE_INVALID_STATUS_CODE_ERROR.getErrorMessage(),null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var n,t,r,i,a=l.EventManagementConstants.ErrorMessages.EVENTS_CONFIGURATION_UPDATE_ERROR.getErrorMessage();throw(null===(n=e.response)||void 0===n||null===(t=n.data)||void 0===t?void 0:t.code)===l.EventManagementConstants.EVENT_UPDATE_ACTIVE_SUBS_ERROR_CODE_BE&&(a=l.EventManagementConstants.ErrorMessages.EVENT_CONFIGURATION_UPDATE_ACTIVE_SUBS_ERROR.getErrorMessage()),new o.u(a,e.stack,null===(r=e.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.code,e.request,e.response,e.config)}))}},1109:(e,n,t)=>{t.r(n),t.d(n,{updateEventConfigurations:()=>r.updateEventConfigurations,useEventConfig:()=>r.useEventConfig});var r=t(20091)},13815:(e,n,t)=>{t.r(n),t.d(n,{EventManagementConstants:()=>c});var r,o=t(65790);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function a(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,s(r.key),r)}}function u(e,n,t){return n&&a(e.prototype,n),t&&a(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function l(e,n,t){return(n=s(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e){var n=function(e,n){if("object"!==i(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"===i(n)?n:String(n)}var c=u((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}));r=c,l(c,"EVENTS_FETCH_ERROR_CODE","ASG-EP-60001"),l(c,"EVENT_CONFIGURATION_FETCH_INVALID_STATUS_CODE_ERROR_CODE","ASG-EP-60002"),l(c,"EVENTS_CONFIGURATION_UPDATE_ERROR_CODE","ASG-EP-60003"),l(c,"EVENT_UPDATE_INVALID_STATUS_CODE_ERROR_CODE","ASG-EP-60004"),l(c,"EVENT_UPDATE_ACTIVE_SUBS_ERROR_CODE_BE","65016"),l(c,"EVENT_UPDATE_ACTIVE_SUBS_ERROR_CODE","ASG-EP-".concat(r.EVENT_UPDATE_ACTIVE_SUBS_ERROR_CODE_BE)),l(c,"ErrorMessages",{EVENTS_CONFIGURATION_FETCH_ERROR:new o.O(r.EVENTS_FETCH_ERROR_CODE,"An error occurred while fetching the events.","Error while fetching the events",null),EVENTS_CONFIGURATION_FETCH_INVALID_STATUS_CODE_ERROR:new o.O(r.EVENTS_FETCH_ERROR_CODE,"Received an invalid status code while fetching the events configuration.","Invalid Status Code while fetching the events",null),EVENTS_CONFIGURATION_UPDATE_ERROR:new o.O(r.EVENTS_CONFIGURATION_UPDATE_ERROR_CODE,"An error occurred while updating the events configuration.","Error while updating the events configuration",null),EVENT_CONFIGURATION_UPDATE_ACTIVE_SUBS_ERROR:new o.O(r.EVENT_UPDATE_ACTIVE_SUBS_ERROR_CODE,"An error occurred while updating the events configuration.","Cannot disable the event type as there are active subscriptions.",null),EVENT_CONFIGURATION_UPDATE_INVALID_STATUS_CODE_ERROR:new o.O(r.EVENT_UPDATE_INVALID_STATUS_CODE_ERROR_CODE,"Received an invalid status code while updating the events configuration.","Invalid Status Code while updating the events configuration",null)})},27910:(e,n,t)=>{t.r(n),t.d(n,{EventManagementConstants:()=>r.EventManagementConstants});var r=t(13815)},39871:(e,n,t)=>{t.r(n),t.d(n,{default:()=>O});var r=t(57477),o=t(83374),i=t(14603),a=t(90268),u=t(13318),l=t(81816),s=t(52983),c=t(9202),E=t(54221),f=t(28141),d=t(16184),v=t(94635),m=t(75917),p=t(88171),g=t(50106),_=t(1109),h=t(27910);function R(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=C(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){u=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(u)throw i}}}}function b(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,o,i,a,u=[],l=!0,s=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=i.call(t)).done)&&(u.push(r.value),u.length!==n);l=!0);}catch(e){s=!0,o=e}finally{try{if(!l&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(e,n)||C(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,n){if(e){if("string"==typeof e)return T(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?T(e,n):void 0}}function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var S=function(e){var n=e["data-componentid"],t=(0,E.I0)(),C=(0,c.$)().t,T=(0,l.fQ)().getLink,S=b((0,s.useState)(void 0),2),O=S[0],A=S[1],N=b((0,s.useState)(void 0),2),I=N[0],U=N[1],w=b((0,s.useState)(void 0),2),P=w[0],D=w[1],V=b((0,s.useState)(void 0),2),M=V[0],F=V[1],G=(0,E.v9)((function(e){return e.config.ui.features})),j=(0,E.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),x=(0,s.useRef)(null),B=(0,s.useRef)(),L=(0,s.useMemo)((function(){var e,n;return!(0,o.hasRequiredScopes)(null==G?void 0:G.eventPublishing,null==G||null===(e=G.eventPublishing)||void 0===e||null===(n=e.scopes)||void 0===n?void 0:n.update,j)}),[G,j]),Z=(0,_.useEventConfig)(),k=Z.data,H=Z.isLoading,q=Z.error;(0,s.useEffect)((function(){}),[k]);var Q=function(){t((0,a.V_)({description:C("extensions:develop.eventPublishing.notifications.getConfiguration.error.description"),level:i.QU.ERROR,message:C("extensions:develop.eventPublishing.notifications.getConfiguration.error.message")}))};(0,s.useEffect)((function(){if(k)if(k instanceof r.u)Q();else if(!q){U(k),U(k);var e,n=[],t=[],o=y(k);try{for(o.s();!(e=o.n()).done;){var i=e.value;n.includes(i.category)||n.push(i.category),i.publish&&t.push(i.displayName)}}catch(a){o.e(a)}finally{o.f()}D(t),A(n)}}),[k]),(0,s.useEffect)((function(){q&&Q()}),[q]);var J=function(e,n){var t,r=[],o=y(n);try{for(o.s();!(t=o.n()).done;){var i=t.value;if(i.category==e){var a={label:i.displayName,value:i.displayName};r.push(a)}}}catch(u){o.e(u)}finally{o.f()}return r};return s.createElement(l.Xg,{title:C("extensions:develop.eventPublishing.eventsConfiguration.heading"),description:s.createElement("div",null,s.createElement("div",{style:{whiteSpace:"pre-line"}},C("extensions:develop.eventPublishing.eventsConfiguration.subHeading"),s.createElement(l.eb,{link:T("develop.eventPublishing.learnMore")},C("extensions:common.learnMore"))),s.createElement("br",null),s.createElement("div",{style:{whiteSpace:"pre-line"}},C("extensions:develop.eventPublishing.eventsConfiguration.formHeading"))),bottomMargin:!1,contentTopMargin:!1,pageHeaderMaxWidth:!0,"data-componentid":"".concat(n,"-form-layout")},s.createElement(d.R,{innerRef:x},s.createElement(v.Z,{className:"mt-2"},s.createElement(v.Z.Row,{columns:1},s.createElement(v.Z.Column,{width:16},s.createElement(l.pJ,{className:"form-wrapper",padded:"very"},H?s.createElement("div",{"data-componentid":"".concat(n,"-form-loading")},R(Array(3)).map((function(e){return s.createElement(f.Z,{key:e},s.createElement(f.Z.Line,{length:"very short"}),s.createElement("div",null,s.createElement(f.Z.Line,{length:"long"}),s.createElement(f.Z.Line,{length:"medium"})))}))):s.createElement(u.Es,{id:"event-configuration-edit-form",uncontrolledForm:!1,onSubmit:function(e){var n,r=e.get("events-configuration"),o=[],u=y(I);try{for(u.s();!(n=u.n()).done;){var l=n.value,s=void 0;try{s=JSON.parse(JSON.stringify(l))}catch(c){return}r.includes(l.displayName)?s.publish=!0:s.publish=!1,o.push(s)}}catch(E){u.e(E)}finally{u.f()}F(!0),(0,_.updateEventConfigurations)(o).then((function(){t((0,a.V_)({description:C("extensions:develop.eventPublishing.notifications.updateConfiguration.success.description"),level:i.QU.SUCCESS,message:C("extensions:develop.eventPublishing.notifications.updateConfiguration.success.message")}))})).catch((function(e){!function(e){var n=e.code===h.EventManagementConstants.EVENT_UPDATE_ACTIVE_SUBS_ERROR_CODE_BE?"activeSubs":"generic";t((0,a.V_)({description:C("extensions:develop.eventPublishing."+"notifications.updateConfiguration.error.".concat(n,".description")),level:i.QU.ERROR,message:C("extensions:develop.eventPublishing."+"notifications.updateConfiguration.error.".concat(n,".message"))}))}(e)})).finally((function(){F(!1)}))}},null==O?void 0:O.map((function(e,n){return s.createElement("div",{key:n},s.createElement(l.xv,{className:"mb-1"}," ",e," "),s.createElement(u.gN,{ref:B,className:"mb-3 ml-3",name:"events-configuration",type:"checkbox",required:!1,children:J(e,I),value:P,readOnly:L,enableReinitialize:!0,listen:function(e){return function(e){var n=e.get("events-configuration");D(n)}(e)},"data-componentid":"".concat(e,"-edit-section")}))})),s.createElement(m.Z,{hidden:!0}),s.createElement(v.Z.Row,{columns:1},s.createElement(v.Z.Column,{mobile:16,tablet:16,computer:16},s.createElement(p.Z,{primary:!0,type:"submit",size:"small",className:"form-button","data-componentid":"".concat(n,"-update-button"),disabled:L,loading:M},C("extensions:develop.eventPublishing.eventsConfiguration.form.updateButton")))))),!H&&s.createElement(g.ChoreoButton,null))))))};S.defaultProps={"data-componentid":"events-config-page"};const O=S}}]);