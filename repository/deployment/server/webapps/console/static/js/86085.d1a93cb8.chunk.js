"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[86085],{86085:(e,t,n)=>{n.r(t),n.d(t,{GroupUsersList:()=>I});var a=n(14603),r=n(90268),l=n(81816),s=n(39345),o=n(67127),i=n(52983),u=n(9202),c=n(54221),d=n(10594),m=n(74691),f=n(21921),p=n(94635),g=n(97860),v=n(75917),h=n(30640),E=n(28758),y=n(18319),S=n(67680),b=n(28438);function R(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=L(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){o=!0,l=e},f:function(){try{s||null==n.return||n.return()}finally{if(o)throw l}}}}function U(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||L(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,l,s,o=[],i=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(a=l.call(n)).done)&&(o.push(a.value),o.length!==t);i=!0);}catch(e){u=!0,r=e}finally{try{if(!i&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw r}}return o}}(e,t)||L(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var I=function(e){var t,n=e.isReadOnly,L=e.group,P=e.onGroupUpdate,I=e.isGroupDetailsRequestLoading,C=e["data-testid"],Z=(0,u.$)().t,O=(0,c.I0)(),_=w((0,l.IK)(),3),A=_[0],N=_[1],T=_[2],x=w((0,i.useState)([]),2),M=x[0],k=x[1],z=w((0,i.useState)([]),2),j=z[0],G=z[1],F=w((0,i.useState)([]),2),D=F[0],H=F[1],Q=w((0,i.useState)(!1),2)[1],V=w((0,i.useState)(!1),2),J=V[0],q=V[1],B=w((0,i.useState)(!0),2),K=B[0],X=B[1],$=w((0,i.useState)(!0),2),W=$[0],Y=$[1],ee=w((0,i.useState)(!1),2),te=ee[0],ne=ee[1],ae=w((0,i.useState)(0),2),re=ae[0],le=ae[1],se=w((0,i.useState)(0),2),oe=se[0],ie=se[1],ue=w((0,i.useState)(!0),2),ce=ue[0],de=ue[1],me=w((0,i.useState)(!0),2),fe=me[0],pe=me[1],ge=w((0,i.useState)(""),2),ve=ge[0],he=ge[1],Ee=w((0,i.useState)(""),2),ye=Ee[0],Se=Ee[1],be=w((0,i.useState)([]),2),Re=be[0],Ue=be[1],we=w((0,i.useState)([]),2),Le=we[0],Pe=we[1],Ie=h.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT+1;!function(e){e[e.GROUP_USERS=0]="GROUP_USERS",e[e.ALL_USERS=1]="ALL_USERS"}(t||(t={})),(0,i.useEffect)((function(){Ze()}),[L,re,ve]),(0,i.useEffect)((function(){Ce()}),[oe,J,ye]);var Ce=function(){var e,n,l=-1===(null==L||null===(e=L.displayName)||void 0===e?void 0:e.indexOf("/"))?"primary":null==L||null===(n=L.displayName)||void 0===n?void 0:n.split("/")[0],s=(null==ye?void 0:ye.length)>0?ye:null;return Y(!0),(0,y.Fp)(Ie,oe,s,null,l).then((function(e){var n,a=Oe(null==e?void 0:e.Resources,Ie,t.ALL_USERS);a=null==e||null===(n=e.Resources)||void 0===n?void 0:n.filter((function(e){var t;return!(null!==(t=e[S.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.userSourceId)})),k(a),H(a)})).catch((function(e){var t,n,l,s,o,i,u,c,d,m,f;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.description?O((0,r.V_)({description:null!==(l=null!==(s=null==e||null===(o=e.response)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.description)&&void 0!==s?s:null==e||null===(u=e.response)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.detail)&&void 0!==l?l:Z("console:manage.features.users.notifications.fetchUsers.error.description"),level:a.QU.ERROR,message:null!==(d=null==e||null===(m=e.response)||void 0===m||null===(f=m.data)||void 0===f?void 0:f.message)&&void 0!==d?d:Z("console:manage.features.users.notifications.fetchUsers.error.message")})):(O((0,r.V_)({description:Z("console:manage.features.users.notifications.fetchUsers.genericError.description"),level:a.QU.ERROR,message:Z("console:manage.features.users.notifications.fetchUsers.genericError.message")})),k([]),H([]))})).finally((function(){Y(!1)}))},Ze=function(){var e,n,l,s=-1===(null==L||null===(e=L.displayName)||void 0===e?void 0:e.indexOf("/"))?"primary":null==L||null===(n=L.displayName)||void 0===n?void 0:n.split("/")[0],o="groups eq "+(null==L||null===(l=L.displayName)||void 0===l?void 0:l.split("/")[1]);(null==ve?void 0:ve.length)>0&&(o=o+" and "+ve),X(!0),(0,y.Fp)(Ie,re,o,null,s).then((function(e){var n,a=Oe(null==e?void 0:e.Resources,Ie,t.GROUP_USERS);a=null===(n=a)||void 0===n?void 0:n.filter((function(e){var t;return!(null!==(t=e[S.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.userSourceId)})),G(a)})).catch((function(e){var t,n,l,s,o,i,u,c,d,m,f;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.description?O((0,r.V_)({description:null!==(l=null!==(s=null==e||null===(o=e.response)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.description)&&void 0!==s?s:null==e||null===(u=e.response)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.detail)&&void 0!==l?l:Z("console:manage.features.users.notifications.fetchUsers.error.description"),level:a.QU.ERROR,message:null!==(d=null==e||null===(m=e.response)||void 0===m||null===(f=m.data)||void 0===f?void 0:f.message)&&void 0!==d?d:Z("console:manage.features.users.notifications.fetchUsers.error.message")})):(O((0,r.V_)({description:Z("console:manage.features.users.notifications.fetchUsers.genericError.description"),level:a.QU.ERROR,message:Z("console:manage.features.users.notifications.fetchUsers.genericError.message")})),G([]))})).finally((function(){X(!1)}))},Oe=function(e,n,a){return(null==e?void 0:e.length)<n?a===t.GROUP_USERS?de(!1):pe(!1):(null==e||e.splice(-1,1),a===t.GROUP_USERS?de(!0):pe(!0)),e},_e=function(e,t){ie((t.activePage-1)*h.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT+1)},Ae=function(e){var t,n,a,r="",l=!1;-1!=(null==L||null===(t=L.displayName)||void 0===t?void 0:t.indexOf("/"))&&(r=null==L||null===(n=L.displayName)||void 0===n?void 0:n.split("/")[1],null===(a=e.groups)||void 0===a||a.map((function(e){var t,n;-1!=(null===(t=e.display)||void 0===t?void 0:t.indexOf("/"))&&(null===(n=e.display)||void 0===n?void 0:n.split("/")[1])===r&&(l=!0)})));return l},Ne=function(e){return Ae(e)?!Le.some((function(t){return t.id===e.id})):!!Re.some((function(t){return t.id===e.id}))},Te=function(){Ce().then((function(){Q((null==j?void 0:j.length)===(null==M?void 0:M.length)),q(!0)})).catch((function(){O((0,r.V_)({description:Z("console:manage.features.users.notifications.fetchUsers.genericError.description"),level:a.QU.ERROR,message:Z("console:manage.features.users.notifications.fetchUsers.genericError.message")}))}))},xe=function(){H(M),ie(0),Q(!1),q(!1)},Me=function(){var e,t=[],n=R(Re);try{for(n.s();!(e=n.n()).done;){var l=e.value;t.push({display:l.userName,value:l.id})}}catch(c){n.e(c)}finally{n.f()}var s,o={Operations:[{op:"add",value:{members:t}}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]},i=R(Le);try{for(i.s();!(s=i.n()).done;){var u=s.value;o.Operations.push({op:"remove",path:"members[display eq "+u.userName+"]"})}}catch(c){i.e(c)}finally{i.f()}ne(!0),(0,E.fF)(L.id,o).then((function(){O((0,r.V_)({description:Z("console:manage.features.groups.notifications.updateGroup.success.description"),level:a.QU.SUCCESS,message:Z("console:manage.features.groups.notifications.updateGroup.success.message")})),P(L.id)})).catch((function(){N({description:Z("console:manage.features.groups.notifications.updateGroup.error.description"),level:a.QU.ERROR,message:Z("console:manage.features.groups.notifications.updateGroup.error.message")})})).finally((function(){ne(!1)}))},ke=function(e){J?(ie(0),Se(e)):he(e)},ze=function(){J?(ie(0),Se("")):he("")},je=function(){return i.createElement(h.nC,{"data-testid":"".concat(C,"-user-list-advanced-search"),style:{maxHeight:20},onFilter:ke,filterAttributeOptions:[{key:0,text:Z("console:manage.features.users.advancedSearch.form.dropdown.filterAttributeOptions.username"),value:"userName"},{key:1,text:Z("console:manage.features.users.advancedSearch.form.dropdown.filterAttributeOptions.email"),value:"emails"},{key:2,text:"First Name",value:"name.givenName"},{key:3,text:"Last Name",value:"name.familyName"}],filterAttributePlaceholder:Z("console:manage.features.users.advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:Z("console:manage.features.users.advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:Z("console:manage.features.users.advancedSearch.form.inputs.filterValue.placeholder"),placeholder:Z("console:manage.features.users.advancedSearch.placeholder"),defaultSearchAttribute:"emails",defaultSearchOperator:"co"})},Ge=function(e){var t,n,a=b.UserManagementUtils.resolveUserListHeader(e),r=b.UserManagementUtils.resolveUserListSubheader(e),s=void 0===(null===(t=e.name)||void 0===t?void 0:t.familyName)&&void 0===(null===(n=e.name)||void 0===n?void 0:n.givenName);return i.createElement(d.Z.Row,{key:e.id},i.createElement(d.Z.Cell,null,i.createElement(g.Z,{image:!0,as:"h6",className:"header-with-icon","data-testid":"".concat(C,"-item-heading")},i.createElement(l.Yt,{"data-testid":"".concat(C,"-users-list-").concat(e.userName,"-avatar"),name:a,spaced:"right",size:"mini",floated:"left",image:e.profileUrl,"data-hj-suppress":""}),i.createElement(g.Z.Content,null,i.createElement("div",{className:s?"mt-2":"","data-hj-suppress":""},a),!s&&i.createElement(g.Z.Subheader,{"data-testid":"".concat(C,"-item-sub-heading")},r)))))};return i.createElement(l.pJ,{padded:"very"},i.createElement(l.X6,{as:"h4"},Z("extensions:manage.groups.edit.users.heading")),i.createElement(l.X6,{subHeading:!0,ellipsis:!0,as:"h6"},Z("extensions:manage.groups.edit.users.description")),i.createElement(v.Z,{hidden:!0}),i.createElement(p.Z,null,(null==j?void 0:j.length)>0||(null==ve?void 0:ve.length)>0?i.createElement(p.Z.Row,{columns:2},i.createElement(p.Z.Column,{width:13},i.createElement(l.pJ,{"data-testid":"group-mgt-users-list-se",className:"user-role-edit-header-segment-se"},je())),i.createElement(p.Z.Column,{width:3},!n&&i.createElement(l.zx,{"data-testid":"".concat(C,"-users-list-edit-button"),size:"large",icon:"pencil",floated:"right",onClick:Te}))):null,i.createElement(p.Z.Row,null,i.createElement(p.Z.Column,{computer:16},i.createElement(p.Z.Row,null,i.createElement(p.Z.Column,{mobile:16,tablet:16,computer:12},i.createElement(l.PS,{showTopActionPanel:!1,currentListSize:null==j?void 0:j.length,listItemLimit:Ie,onItemsPerPageDropdownChange:null,"data-componentid":"group-mgt-user-list-layout","data-testid":"group-mgt-user-list-layout",onPageChange:function(e,t){le((t.activePage-1)*h.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT+1)},showPagination:(null==j?void 0:j.length)>0,totalPages:100,totalListSize:null==j?void 0:j.length,isLoading:K||I,paginationOptions:{disableNextButton:!ce,showItemsPerPageDropdown:!1},showPaginationPageLimit:!1},(null==j?void 0:j.length)>0?i.createElement(d.Z,{singleLine:!0,compact:!0},i.createElement(d.Z.Header,null,i.createElement(d.Z.Row,null,i.createElement(d.Z.HeaderCell,null,i.createElement("strong",null,Z("console:manage.features.user.updateUser.groups.editGroups.groupList.headers.1"))))),i.createElement(d.Z.Body,null,null==j?void 0:j.map((function(e){return Ge(e)})))):ve.length>0?i.createElement(l.$J,{action:i.createElement(l.Qj,{onClick:ze},Z("console:manage.features.users.usersList.search.emptyResultPlaceholder.clearButton")),image:(0,h.jF)().emptySearch,imageSize:"tiny",title:Z("console:manage.features.users.usersList.search.emptyResultPlaceholder.title"),subtitle:[Z("console:manage.features.users.usersList.search.emptyResultPlaceholder.subTitle.0",{query:ve}),Z("console:manage.features.users.usersList.search.emptyResultPlaceholder.subTitle.1")]}):i.createElement(l.$J,{title:Z("console:manage.features.roles.edit.users.list.emptyPlaceholder.title"),subtitle:[Z("console:manage.features.roles.edit.users.list.emptyPlaceholder.subtitles",{type:"group"})],action:!n&&i.createElement(l.KM,{"data-testid":"".concat(C,"-users-list-empty-assign-users-button"),onClick:Te},i.createElement(m.Z,{name:"plus"}),Z("console:manage.features.roles.edit.users.list.emptyPlaceholder.action")),image:(0,h.jF)().emptyList,imageSize:"tiny"})))),i.createElement(p.Z.Row,null,i.createElement(p.Z.Column,{mobile:16,tablet:16,computer:12},i.createElement(v.Z,{hidden:!0})),i.createElement(p.Z.Column,{mobile:16,tablet:16,computer:12},i.createElement(v.Z,{hidden:!0}))),i.createElement(f.Z,{"data-testid":"".concat(C,"-assign-user-wizard-modal"),dimmer:"blurring",open:J,size:"small",className:"user-roles"},i.createElement(f.Z.Header,null,Z("console:manage.features.roles.addRoleWizard.users.assignUserModal.heading",{type:"Group"}),i.createElement(l.X6,{subHeading:!0,ellipsis:!0,as:"h6"},Z("console:manage.features.roles.addRoleWizard.users.assignUserModal.subHeading",{type:"group"}))),i.createElement(f.Z.Content,null,A&&T,i.createElement(p.Z,null,i.createElement(p.Z.Row,null,i.createElement(p.Z.Column,{width:16},i.createElement(l.pJ,null,je()))),i.createElement(p.Z.Row,null,i.createElement(p.Z.Column,{width:16},i.createElement(l.PS,{showTopActionPanel:!1,currentListSize:null==D?void 0:D.length,listItemLimit:Ie,onItemsPerPageDropdownChange:null,"data-componentid":"group-mgt-user-list-layout","data-testid":"group-mgt-user-list-layout",onPageChange:_e,showPagination:!0,totalPages:100,totalListSize:null==M?void 0:M.length,isLoading:W,paginationOptions:{disableNextButton:!fe,showItemsPerPageDropdown:!1},showPaginationPageLimit:!1},i.createElement(l.IX,{compact:!0,basic:!0,bordered:!0,className:"group-add-user-model-transfer-list",selectionComponent:!0,searchPlaceholder:Z("console:manage.features.roles.addRoleWizard.users.assignUserModal.list.searchPlaceholder"),isLoading:W,showListSearch:!1,handleUnelectedListSearch:function(e,t){!function(e,t,n,a){var r=[];if(!(0,o.Z)(t)){var l=new RegExp((0,s.Z)(t),"i");return n&&n.map((function(e){(l.test(e.userName)||e.name&&l.test(e.name.givenName)||e.name&&l.test(e.name.familyName))&&r.push(e)})),void a(r)}a(n)}(0,t.value,M,H)},"data-testid":"".concat(C,"-user-list-transfer")},i.createElement(l.Jv,{selectionComponent:!0,isListEmpty:!((null==M?void 0:M.length)>0),isLoading:W,listType:"unselected","data-testid":"".concat(C,"-unselected-transfer-list"),emptyPlaceholderContent:Z("console:manage.features.transferList.list.emptyPlaceholders.groups.common",{type:"users"}),emptyPlaceholderDefaultContent:Z("console:manage.features.transferList.list.emptyPlaceholders.default")},null==M?void 0:M.map((function(e,t){var n,a=b.UserManagementUtils.resolveUserListHeader(e),r=b.UserManagementUtils.resolveUserListSubheader(e);return i.createElement(l.qT,{handleItemChange:function(){return function(e){var t=(0,o.Z)(Re)?[]:U(Re),n=(0,o.Z)(Le)?[]:U(Le);Ae(e)?n.some((function(t){return t.id===e.id}))?(n.splice(n.findIndex((function(t){return t.id===e.id})),1),Pe(n)):(n.push(e),Pe(n)):t.some((function(t){return t.id===e.id}))?(t.splice(t.findIndex((function(t){return t.id===e.id})),1),Ue(t)):(t.push(e),Ue(t))}(e)},key:t,listItem:{listItemElement:(n=a,i.createElement("div",{"data-hj-suppress":""},n)),listItemValue:a},listItemId:e.id,listItemIndex:t,isItemChecked:Ne(e),showSecondaryActions:!1,showListSubItem:!0,listSubItem:a!==r&&i.createElement(l.EK,{compact:!0,withBackground:!1},r),"data-testid":"".concat(C,"-unselected-transfer-list-item-").concat(t)})}))))))))),i.createElement(f.Z.Actions,null,i.createElement(p.Z,null,i.createElement(p.Z.Row,{columns:2},i.createElement(p.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(l.Qj,{"data-testid":"".concat(C,"-assign-user-wizard-modal-cancel-button"),onClick:xe,floated:"left"},Z("common:cancel"))),i.createElement(p.Z.Column,{mobile:8,tablet:8,computer:8},i.createElement(l.KM,{"data-testid":"".concat(C,"-assign-user-wizard-modal-save-button"),onClick:function(){Me(),q(!1)},floated:"right",loading:te,disabled:te},Z("common:save")))))))))))}}}]);