"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[82914],{82914:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var r=n(81816),a=n(46440),o=n(52983),i=n(9202),l=n(30640),c=n(67847),u=n(14603),d=n(90268),s=n(59206),m=n(54221),f=n(94635),p=n(74691),v=n(53868),y=n(51998),h=n(22964),g=n(78501),b=n(67127),E=n(75917),S=n(30342),w=n(87377),C=n(32962),A=n(23083);function I(e){return function(e){if(Array.isArray(e))return L(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||P(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||P(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D,j=function(e){var t=e.initialClaims,n=e.mappedAttributesList,a=e.setMappedAttributeList,l=e.hideIdentityClaimAttributes,c=T((0,o.useState)([]),2),u=c[0],d=c[1],s=T((0,o.useState)(!0),2),m=s[0],p=s[1],v=T((0,o.useState)(),2),y=v[0],h=v[1],g=T((0,o.useState)(!0),2),L=g[0],D=g[1],j=T((0,o.useState)(!1),2),V=j[0],k=j[1],N=(0,i.$)().t;(0,o.useEffect)((function(){(0,A.ep)(l,d,p)}),[]),(0,o.useEffect)((function(){var e,t=new Set,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=P(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}(n);try{for(r.s();!(e=r.n()).done;){var a=e.value;t.add(a.localClaim.id)}}catch(o){r.e(o)}finally{r.f()}h(t)}),[u,n]),(0,o.useEffect)((function(){k(0===n.length)}),[n]),(0,o.useEffect)((function(){(0,b.Z)(n)&&!(0,b.Z)(u)&&L&&(O(),D(!1))}),[u,t]);var O=function(){t&&(t.forEach((function(e){e.localClaim=u.find((function(t){return t.uri===e.localClaim.uri}))})),a(t))},M=function(){return I(u.filter((function(e){return!y.has(e.id)})))};return m?o.createElement(r.pO,null):o.createElement(f.Z,null,o.createElement(f.Z.Row,{columns:1},o.createElement(f.Z.Column,{computer:16,tablet:16,largeScreen:16,widescreen:16},o.createElement(r.X6,{as:"h4"},N("console:develop.features.idvp.forms.attributeSettings.attributeMapping.heading")),o.createElement(r.kW,{compact:!0},N("console:develop.features.idvp.forms.attributeSettings.attributeMapping.hint"))),o.createElement(f.Z.Column,{width:16},o.createElement(S.f,{availableAttributeList:M(),alreadyMappedAttributesList:n,onSubmit:function(e){a([].concat(I(n),[e])),h(new Set([].concat(I(y),[e.localClaim.id])))}})),o.createElement(f.Z.Column,{width:16},V?(0,C.l)():o.createElement(o.Fragment,null,o.createElement(E.Z,{hidden:!0}),o.createElement(w.Y,{key:"attribute-mapping-working-list",alreadyMappedAttributesList:n,onMappingDeleted:function(e){var t=n.filter((function(t){return t.localClaim.id!==e.localClaim.id})),r=new Set(y);a(I(t)),r.delete(e.localClaim.id),h(r)},onMappingEdited:function(e,t){var r=[].concat(I(n.filter((function(t){return t.localClaim.id!==e.localClaim.id}))),[t]);if(a(r),e.localClaim.id!==t.localClaim.id){var o=new Set(y);o.delete(e.localClaim.id),o.add(t.localClaim.id),h(o)}},attributeMappingsListToShow:n,availableAttributesList:M()})))))};function V(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=N(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw o}}}}function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||N(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}j.defaultProps={"data-componentid":"attributes-selection-wizard-page"},function(e){e.CONFIGURATION="Configuration",e.IDVP_SETTINGS="Identity Verification Provider Settings",e.ATTRIBUTES="Attributes"}(D||(D={}));var M=[{icon:(0,v.n)().idvpSettings,name:D.CONFIGURATION,title:"Configuration"},{icon:(0,v.n)().general,name:D.ATTRIBUTES,title:"Attributes"}],R=function(e){var t=e.showWizard,n=e.onWizardClose,a=e.selectedTemplateType,v=e.onIDVPCreate,b=(0,o.useRef)(null),E="idvp-create-wizard-factory",S=(0,i.$)().t,w=k((0,o.useState)(0),2),C=w[0],A=w[1],I=k((0,o.useState)(!1),2),T=I[0],P=I[1],L=(0,m.I0)(),D=k((0,o.useState)([]),2),N=D[0],O=D[1],R=k((0,r.IK)(),3),x=R[0],z=R[1],_=R[2],Z=(0,c.Yy)(),G=Z.data,U=Z.isLoading,$=Z.error,F=(0,c.yy)(null==a?void 0:a.id),Q=F.data,H=F.isLoading,B=F.error,W=(0,c.Xx)(null==a?void 0:a.id),X=W.data,J=W.error,K=W.isLoading,q=k((0,o.useState)(!1),2),Y=q[0],ee=q[1];(0,o.useEffect)((function(){$&&(0,h.o6)($)}),[$]),(0,o.useEffect)((function(){J&&(0,h.Ji)(J)}),[J]),(0,o.useEffect)((function(){B&&(0,h.II)(B)}),[B]);var te=function(){x&&z(void 0),n()},ne=function(){var e,t;return o.createElement(s.k0,{validate:function(e){var t,n,r=(0,h.w)(null==e?void 0:e.name,G.identityVerificationProviders);if(r)return ee(!0),r;var a,o=V(null==X||null===(t=X.pages)||void 0===t||null===(n=t.edit)||void 0===n?void 0:n.settings);try{for(o.s();!(a=o.n()).done;){var i=a.value,l=(0,g.r)(e[i.name],i);if(l)return ee(!0),l}}catch(c){o.e(c)}finally{o.f()}ee(!1)}},o.createElement(s.gN.Input,{ariaLabel:"name",inputType:"resource_name",name:"name",label:S("console:develop.features.idvp.forms.generalDetails.name.label"),required:!0,message:S("console:develop.features.idvp.forms.generalDetails.name.validations.empty"),placeholder:S("console:develop.features.idvp.forms.generalDetails.name.placeholder"),validate:function(e){return(0,h.w)(e,G.identityVerificationProviders)},maxLength:y.G.IDVP_NAME_MAX_LENGTH,minLength:y.G.IDVP_NAME_MIN_LENGTH,format:function(e){return e.toString().trimStart()},"data-componentid":"".concat(E,"-form-wizard-idvp-name"),hint:S("console:develop.features.idvp.forms.generalDetails.name.hint")}),(0,g.A)(null==X||null===(e=X.pages)||void 0===e||null===(t=e.edit)||void 0===t?void 0:t.settings,Q))},re=function(){return o.createElement(s.k0,null,o.createElement(j,{mappedAttributesList:N,initialClaims:(0,h.jm)(Q.claims),hideIdentityClaimAttributes:!0,"data-componentid":"".concat(E,"-attribute-settings"),setMappedAttributeList:O}))},ae=function(e){var t,n;Q.Name=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:Q.Name,Q.description=null!==(n=null==e?void 0:e.description)&&void 0!==n?n:Q.description;var r,a,o=V(null==Q?void 0:Q.configProperties);try{for(o.s();!(r=o.n()).done;){var i=r.value;e[null==i?void 0:i.key]&&(i.value=e[null==i?void 0:i.key])}}catch(l){o.e(l)}finally{o.f()}Q.claims=N.map((function(e){return{idvpClaim:e.idvpClaim,localClaim:e.localClaim.uri}})),a=Q,P(!0),(0,c.j8)(a).then((function(e){var t;L((0,d.V_)({description:S("console:develop.features.idvp.notifications.addIDVP.success.description"),level:u.QU.SUCCESS,message:S("console:develop.features.idvp.notifications.addIDVP.success.message")})),null!=e&&null!==(t=e.data)&&void 0!==t&&t.id?v(e.data.id):v()})).catch((function(e){var t,n;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.description?z({description:S("console:develop.features.idvp.notifications.addIDVP.error.description",{description:e.response.data.description}),level:u.QU.ERROR,message:S("console:develop.features.idvp.notifications.addIDVP.error.message")}):z({description:S("console:develop.features.idvp.notifications.addIDVP.genericError.description"),level:u.QU.ERROR,message:S("console:develop.features.idvp.notifications.addIDVP.genericError.message")})})).finally((function(){P(!1)}))};return!t||U||H||K?null:o.createElement(l.wv,{open:t,className:"wizard identity-verification-provider-create-wizard",dimmer:"blurring",onClose:n,closeOnDimmerClick:!1,closeOnEscape:!0,"data-componentid":"".concat(E,"-modal")},o.createElement(l.wv.MainPanel,null,o.createElement(l.wv.Header,{className:"wizard-header","data-componentid":"".concat(E,"-modal-header")},o.createElement("div",{className:"display-flex"},o.createElement(r.dn,{icon:(0,h.VT)(a.image),size:"x30",transparent:!0,spaced:"right","data-componentid":"".concat(E,"-image")}),o.createElement("div",null,a.name,a.description&&o.createElement(r.X6,{as:"h6"},a.description)))),o.createElement(o.Fragment,null,o.createElement(l.wv.Content,{className:"steps-container","data-componentid":"".concat(E,"-modal-content-1")},o.createElement(r.Rg.Group,{current:C},M.map((function(e,t){return o.createElement(r.Rg.Step,{active:!0,key:t,icon:e.icon,title:e.title})})))),o.createElement(l.wv.Content,{className:"content-container","data-componentid":"".concat(E,"-modal-content-2")},o.createElement(o.Fragment,null,x&&_,U?o.createElement(r.pO,null):o.createElement(s.w,{id:"idvp-create-wizard-content",ref:b,onSubmit:ae,uncontrolledForm:!0,pageChanged:function(e){return A(e)},"data-componentid":E},[ne(),re()])))),o.createElement(l.wv.Actions,{"data-componentid":"".concat(E,"-modal-actions")},o.createElement(f.Z,null,o.createElement(f.Z.Row,{column:1},o.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},o.createElement(r.Qj,{floated:"left",onClick:te,"data-componentid":"".concat(E,"-modal-cancel-button")},S("common:cancel"))),o.createElement(f.Z.Column,{mobile:8,tablet:8,computer:8},C<M.length-1&&o.createElement(r.KM,{disabled:Y,floated:"right",onClick:function(){b.current.gotoNextPage()},"data-componentid":"".concat(E,"-modal-next-button")},S("console:develop.features.authenticationProvider.wizards.buttons.next"),o.createElement(p.Z,{name:"arrow right"})),C===M.length-1&&o.createElement(r.KM,{disabled:Y||T,type:"submit",floated:"right",onClick:function(){b.current.gotoNextPage()},"data-componentid":"".concat(E,"-modal-finish-button"),loading:T},S("console:develop.features.authenticationProvider.wizards.buttons.finish")),C>0&&o.createElement(r.Qj,{type:"submit",floated:"right",onClick:function(){return b.current.gotoPreviousPage()},"data-componentid":"".concat(E,"-modal-previous-button")},o.createElement(p.Z,{name:"arrow left"}),S("console:develop.features.authenticationProvider.wizards.buttons.previous"))))))))};function x(e){return function(e){if(Array.isArray(e))return Z(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,l=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return l}}(e,t)||_(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){if(e){if("string"==typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}R.defaultProps={"data-componentid":"idvp-create-wizard"};var G=function(e){var t=e["data-componentid"],n=(0,i.$)().t,u=z((0,o.useState)(!1),2),d=u[0],s=u[1],m=z((0,o.useState)(void 0),2),f=m[0],p=m[1],v=z((0,o.useState)(new Set),2),g=v[0],b=v[1],E=z((0,o.useState)([]),2),S=E[0],w=E[1],C=z((0,o.useState)(void 0),2),A=C[0],I=C[1],T=z((0,o.useState)(""),2),P=T[0],L=T[1],D=(0,c.Nl)(),j=D.data,V=D.isLoading,k=D.error;(0,o.useEffect)((function(){if(j&&Array.isArray(j)&&j.length>0){w(j);var e=new Set;j.forEach((function(t){var n;null===(n=t.tags)||void 0===n||n.forEach((function(t){e.add(t)}))})),b(e)}}),[j]),(0,o.useEffect)((function(){k&&(0,h.mp)(k)}),[k]);var N,O=function(e,t){return(0,a.Z)(j).filter((function(n){var r=!0,a=!0;return e&&(r=n.name.toLocaleLowerCase().includes(e)),t.length>0&&(a=t.some((function(e){return n.tags.includes(e)}))),r&&a}))};return o.createElement(r.Xg,{pageTitle:"Create a New Identity Verification Provider",isLoading:V,title:n("console:develop.pages.idvpTemplate.title"),contentTopMargin:!0,description:n("console:develop.pages.idvpTemplate.subTitle"),backButton:{"data-componentid":"".concat(t,"-page-back-button"),onClick:function(){l.m8.push(l.$x.getPaths().get(y.G.IDVP_PATH))},text:n("console:develop.pages.idvpTemplate.backButton")},titleTextAlign:"left",bottomMargin:!1,"data-componentid":"".concat(t,"-page-layout"),showBottomDivider:!0},o.createElement(r.Me,{search:o.createElement(r.m6,{placeholder:n("console:develop.pages.idvpTemplate.search.placeholder"),onSearch:function(e,t){L(e),w(O(e.toLocaleLowerCase(),t))},onFilter:function(e,t){L(e),w(O(e,t))},filterLabels:x(g),disableSearchFilterDropdown:!0}),isLoading:V},!V&&S?o.createElement(r.Q8,{isEmpty:!(S&&S.length>0),emptyPlaceholder:(N=S,P&&0===N.length?o.createElement(r.$J,{image:(0,l.jF)().emptySearch,imageSize:"tiny",title:n("console:develop.placeholders.emptySearchResult.title"),subtitle:[n("console:develop.placeholders.emptySearchResult.subtitles.0",{query:P}),n("console:develop.placeholders.emptySearchResult.subtitles.1")],"data-componentid":"".concat(t,"-empty-search-placeholder")}):0===N.length?o.createElement(r.$J,{image:(0,l.jF)().newList,imageSize:"tiny",title:n("console:develop.features.idvp.placeholders.emptyIDVPTypeList.title"),subtitle:[n("console:develop.features.idvp.placeholders.emptyIDVPTypeList.subtitles.0"),n("console:develop.features.idvp.placeholders.emptyIDVPTypeList.subtitles.1")],"data-componentid":"".concat(t,"-empty-placeholder")}):null)},S.map((function(e,a){return o.createElement(r.Q8.Card,{key:a,resourceName:e.name,comingSoonRibbonLabel:n("common:comingSoon"),resourceDescription:e.description,resourceImage:(0,h.VT)(e.image),tags:e.tags,onClick:function(t){!function(e,t){t&&(I(t),p(t.id),s(!0))}(0,e)},showTooltips:{description:!0,header:!1},"data-componentid":"".concat(t,"-").concat(e.name)})}))):o.createElement(r.pO,{dimmer:!0})),o.createElement(R,{showWizard:d,type:f,selectedTemplateType:A,onIDVPCreate:function(e){e?l.m8.push({pathname:l.$x.getPaths().get(y.G.IDVP_EDIT_PATH).replace(":id",e)}):l.m8.push(l.$x.getPaths().get(y.G.IDVP_PATH))},onWizardClose:function(){p(void 0),s(!1)}}))};G.defaultProps={"data-componentid":"idvp-templates"};const U=G}}]);