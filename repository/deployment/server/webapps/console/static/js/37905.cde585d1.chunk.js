"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[37905],{37905:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var r=n(7955),a=n(14603),s=n(90268),o=n(81816),i=n(46440),l=n(52983),u=n(9202),c=n(54221),d=n(74691),m=n(5873),f=n(30640),p=n(18319),g=n(18580),v=n(89423),E=n(99839),S=n(64322),h=n(68521),U=n(79951);function R(){return R=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},R.apply(this,arguments)}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,s,o,i=[],l=!0,u=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(i.push(r.value),i.length!==t);l=!0);}catch(e){u=!0,a=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function(e){var t,n=e.location,b=e["data-componentid"],y=e["data-testid"],A=new URLSearchParams(n.search),C=(0,u.$)().t,T=(0,c.I0)(),O=(0,o.fQ)().getLink,w=(0,c.v9)((function(e){return e.config.ui.features})),P=_((0,l.useState)(E.UserAccountTypes.USER),1)[0],I=_((0,l.useState)(void 0),2),L=I[0],k=I[1],M=_((0,l.useState)(0),2),N=M[0],D=M[1],x=_((0,l.useState)(f.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),B=x[0],W=x[1],Z=_((0,l.useState)(!1),2),j=Z[0],z=Z[1],Q=_((0,l.useState)(!1),2),V=Q[0],F=Q[1],K=_((0,l.useState)(!1),2),G=K[0],Y=K[1],H=_((0,l.useState)([]),1)[0],$=_((0,l.useState)(void 0),1)[0],J=_((0,l.useState)(!1),2),X=J[0],q=J[1],ee=_((0,l.useState)(""),2),te=ee[0],ne=ee[1],re=_((0,l.useState)([]),2),ae=re[0],se=re[1],oe=_((0,l.useState)([]),2),ie=oe[0],le=oe[1],ue=_((0,l.useState)(!1),2),ce=ue[0],de=ue[1],me=_((0,l.useState)(E.CONSUMER_USERSTORE),2),fe=me[0],pe=me[1],ge=_((0,l.useState)(!1),2),ve=ge[0],Ee=ge[1],Se=_((0,l.useState)(!1),2),he=Se[0],Ue=Se[1],Re=f.lD.getInstance(),_e=B+1,be=E.UsersConstants.GROUPS_AND_ROLES_ATTRIBUTE,ye=(0,p.WW)(_e,N,""===te?null:te,null,fe,be),Ae=ye.data,Ce=ye.isLoading,Te=ye.error,Oe=ye.mutate;(0,l.useEffect)((function(){var e,t,n,r,o,i,l,u,c,d,m;Te&&(null!=Te&&null!==(e=Te.response)&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.description?T((0,s.V_)({description:null!==(n=null!==(r=null==Te||null===(o=Te.response)||void 0===o||null===(i=o.data)||void 0===i?void 0:i.description)&&void 0!==r?r:null==Te||null===(l=Te.response)||void 0===l||null===(u=l.data)||void 0===u?void 0:u.detail)&&void 0!==n?n:C("console:manage.features.users.notifications.fetchUsers.error.description"),level:a.QU.ERROR,message:null!==(c=null==Te||null===(d=Te.response)||void 0===d||null===(m=d.data)||void 0===m?void 0:m.message)&&void 0!==c?c:C("console:manage.features.users.notifications.fetchUsers.error.message")})):(T((0,s.V_)({description:C("console:manage.features.users.notifications.fetchUsers.genericError.description"),level:a.QU.ERROR,message:C("console:manage.features.users.notifications.fetchUsers.genericError.message")})),z(!0)))}),[Te]),(0,l.useEffect)((function(){A.get(E.UsersConstants.USER_CREATE_WIZARD_TRIGGER_URL_SEARCH_PARAM_KEY)&&(Re.publish("manage-users-click-create-new",{type:"user"}),F(!0))}),[A.get(E.UsersConstants.USER_CREATE_WIZARD_TRIGGER_URL_SEARCH_PARAM_KEY)]),(0,l.useEffect)((function(){Le()}),[]);var we=(0,l.useMemo)((function(){return function(e){var t;if(e){var n=(0,i.Z)(e);return n.Resources=null==n||null===(t=n.Resources)||void 0===t?void 0:t.map((function(e){var t=null;if((null==e?void 0:e.emails)instanceof Array){var n=null==e?void 0:e.emails[0];t="string"==typeof n?n:null==n?void 0:n.value}return e.emails=[t],e})),z(!1),function(e,t){var n,r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=e;return(null===(n=s.Resources)||void 0===n?void 0:n.length)<t?k(!1):(null===(r=s.Resources)||void 0===r||r.splice(-1,a),k(!0)),s}(n,_e,1)}}(Ae)}),[Ae]),Pe=function(e){"userName sw "!==e?ne(e):Oe()},Ie=function(e){T((0,s.V_)(e))},Le=function(){de(!0),(0,S.getUserStores)().then((function(e){var t=[],n=null==e?void 0:e.filter((function(e){return e.enabled})).map((function(e,n){var r;return(r=e).typeName!==E.UsersConstants.DEFAULT_USERSTORE_TYPE_NAME&&"true"===r.properties.filter((function(e){return e.name===E.UsersConstants.USER_STORE_PROPERTY_READ_ONLY}))[0].value&&t.push(e.name.toUpperCase()),{key:n,text:e.name.toUpperCase(),value:e.name.toUpperCase()}}));z(!1),le(n),se(t),Ue(n.length<=1)})).catch((function(e){var t,n,r,o,i,l,u,c,d,m,f;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.description?T((0,s.V_)({description:null!==(r=null!==(o=null==e||null===(i=e.response)||void 0===i||null===(l=i.data)||void 0===l?void 0:l.description)&&void 0!==o?o:null==e||null===(u=e.response)||void 0===u||null===(c=u.data)||void 0===c?void 0:c.detail)&&void 0!==r?r:C("console:manage.features.users.notifications.fetchUserStores.error.description"),level:a.QU.ERROR,message:null!==(d=null==e||null===(m=e.response)||void 0===m||null===(f=m.data)||void 0===f?void 0:f.message)&&void 0!==d?d:C("console:manage.features.users.notifications.fetchUserStores.error.message")})):(T((0,s.V_)({description:C("console:manage.features.users.notifications.fetchUserStores.genericError.description"),level:a.QU.ERROR,message:C("console:manage.features.users.notifications.fetchUserStores.genericError.message")})),z(!0))})).finally((function(){de(!1)}))},ke=function(){return l.createElement(f.nC,{onFilter:Pe,filterAttributeOptions:[{key:0,text:C("console:manage.features.users.advancedSearch.form.dropdown.filterAttributeOptions.username"),value:"userName"},{key:1,text:C("console:manage.features.users.advancedSearch.form.dropdown.filterAttributeOptions.email"),value:"emails"},{key:2,text:"First Name",value:"name.givenName"},{key:3,text:"Last Name",value:"name.familyName"}],filterAttributePlaceholder:C("console:manage.features.users.advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:C("console:manage.features.users.advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:C("console:manage.features.users.advancedSearch.form.inputs.filterValue.placeholder"),placeholder:C("console:manage.features.users.advancedSearch.placeholder"),defaultSearchAttribute:"emails",defaultSearchOperator:"co",triggerClearQuery:X})},Me=l.createElement(o.KM,{"data-componentid":"".concat(b,"-add-user-button"),"data-testid":"".concat(y,"-add-user-button")},l.createElement(d.Z,{name:"add"}),C("extensions:manage.users.buttons.addUserBtn"),l.createElement(d.Z,{name:"dropdown",className:"ml-3 mr-0"})),Ne=l.createElement(m.Z,{"data-testid":"".concat(y,"-add-user-dropdown"),"data-componentid":"".concat(y,"-add-user-dropdown"),direction:"left",floating:!0,icon:null,trigger:Me},l.createElement(m.Z.Menu,null,[{"data-componentid":"".concat(b,"-add-user-dropdown-item"),"data-testid":"".concat(y,"-add-user-dropdown-item"),key:1,text:C("console:manage.features.users.addUserDropDown.addNewUser"),value:v.Bv.MANUAL_INPUT},{"data-componentid":"".concat(b,"-bulk-import-users-dropdown-item"),"data-testid":"".concat(y,"-bulk-import-users-dropdown-item"),key:2,text:C("console:manage.features.users.addUserDropDown.bulkImport"),value:v.Bv.BULK_IMPORT}].map((function(e){return l.createElement(m.Z.Item,R({key:e.value,onClick:function(){return De(e.value)}},e))})))),De=function(e){e===v.Bv.MANUAL_INPUT?(Re.publish("manage-users-click-create-new",{type:"user"}),F(!0)):e===v.Bv.BULK_IMPORT&&(Re.publish("manage-users-click-bulk-import",{type:"user"}),Y(!0))};return l.createElement(o.Xg,{pageTitle:"Users",action:!Ce&&l.createElement(r.di,{when:r.TA.USER_WRITE},null!=w&&null!==(t=w.bulkUserImport)&&void 0!==t&&t.enabled?Ne:l.createElement(o.KM,{"data-componentid":"".concat(b,"-add-user-button"),"data-testid":"".concat(y,"-add-user-button"),onClick:function(){Re.publish("manage-users-click-create-new",{type:"user"}),F(!0)}},l.createElement(d.Z,{name:"add"}),C("extensions:manage.users.buttons.addUserBtn"))),title:C("extensions:manage.users.usersTitle"),description:l.createElement(l.Fragment,null,C("extensions:manage.users.usersSubTitle"),l.createElement(o.eb,{link:O("manage.users.customerAccounts.learnMore")},C("extensions:common.learnMore"))),"data-componentid":"".concat(b,"-page-layout"),"data-testid":"".concat(y,"-page-layout"),headingColumnWidth:"11",actionColumnWidth:"5"},l.createElement(o.PS,{advancedSearch:ke(),currentListSize:null==we?void 0:we.itemsPerPage,listItemLimit:B,onItemsPerPageDropdownChange:function(e,t){W(t.value)},"data-componentid":"user-mgt-user-list-layout","data-testid":"user-mgt-user-list-layout",onPageChange:function(e,t){D((t.activePage-1)*B+1)},showPagination:!0,totalPages:fe===E.CONSUMER_USERSTORE?Math.ceil((null==we?void 0:we.totalResults)/B):100,totalListSize:null==we?void 0:we.totalResults,isLoading:Ce,paginationOptions:{disableNextButton:!L,showItemsPerPageDropdown:fe===E.CONSUMER_USERSTORE},showPaginationPageLimit:!ve,leftActionPanel:l.createElement(m.Z,{"data-componentid":"user-mgt-user-list-userstore-dropdown","data-testid":"user-mgt-user-list-userstore-dropdown",selection:!0,options:ie,onChange:function(e,t){pe(t.value),Ee(null==ae?void 0:ae.includes(t.value.toString().toUpperCase())),D(0),W(f.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT)},text:fe,loading:ce,disabled:he})},j?l.createElement(o.$J,{subtitle:[C("console:manage.features.users.placeholders.userstoreError.subtitles.0"),C("console:manage.features.users.placeholders.userstoreError.subtitles.1")],title:C("console:manage.features.users.placeholders.userstoreError.title"),image:(0,f.jF)().genericError,imageSize:"tiny"}):l.createElement(h.UsersList,{advancedSearch:ke(),usersList:we,handleUserDelete:function(e){return(0,p.h8)(e).then((function(){Ie({description:C("console:manage.features.users.notifications.deleteUser.success.description"),level:a.QU.SUCCESS,message:C("console:manage.features.users.notifications.deleteUser.success.message")}),Oe()}))},userMetaListContent:$,onSearchQueryClear:function(){q(!X),ne("")},searchQuery:te,"data-componentid":"user-mgt-user-list","data-testid":"user-mgt-user-list",readOnlyUserStores:ae,featureConfig:w,userEditPath:E.UsersConstants.getPaths().get("CUSTOMER_USER_EDIT_PATH")})),V&&l.createElement(U.AddUserWizard,{"data-componentid":"user-mgt-add-user-wizard-modal","data-testid":"user-mgt-add-user-wizard-modal",closeWizard:function(){F(!1)},rolesList:H,emailVerificationEnabled:!0,onSuccessfulUserAddition:function(e){Re.publish("manage-users-finish-creating-user"),f.m8.push(E.UsersConstants.getPaths().get("CUSTOMER_USER_EDIT_PATH").replace(":id",e))},defaultUserTypeSelection:P}),G&&l.createElement(g.O,{"data-componentid":"user-mgt-bulk-import-user-wizard-modal",closeWizard:function(){Y(!1),Oe()},userstore:E.CONSUMER_USERSTORE}))};y.defaultProps={"data-componentid":"asgardeo-users","data-testid":"asgardeo-users"};const A=y}}]);