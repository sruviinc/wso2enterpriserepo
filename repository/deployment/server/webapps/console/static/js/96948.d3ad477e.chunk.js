"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[96948,16837,49282],{49282:(e,t,n)=>{n.r(t),n.d(t,{getAllApplicationRolesList:()=>c,getAssignedApplicationRolesList:()=>l,updateGroupRoleMapping:()=>s});var o=n(93967),a=n(14603),r=n(30640),i=o.AsgardeoSPAClient.getInstance().httpRequest.bind(o.AsgardeoSPAClient.getInstance()).bind(o.AsgardeoSPAClient.getInstance()),l=function(e){var t={method:a.f2.GET,url:"".concat(r.h.getState().config.endpoints.authzEndpoint,"/groups/").concat(e,"/role-mapping")};return i(t).then((function(e){return Promise.resolve(e.data.app_roles)})).catch((function(e){return Promise.reject(e)}))},c=function(){var e={method:a.f2.GET,url:"".concat(r.h.getState().config.endpoints.authzEndpoint,"/roles")};return i(e).then((function(e){return Promise.resolve(e.data.app_roles)})).catch((function(e){return Promise.reject(e)}))},s=function(e,t){var n={data:t,method:a.f2.PATCH,url:"".concat(r.h.getState().config.endpoints.authzEndpoint,"/groups/").concat(e,"/role-mapping")};return i(n).then((function(e){return Promise.resolve(e)})).catch((function(e){return Promise.reject(e)}))}},16837:(e,t,n)=>{n.r(t),n.d(t,{getAllApplicationRolesList:()=>o.getAllApplicationRolesList,getAssignedApplicationRolesList:()=>o.getAssignedApplicationRolesList,updateGroupRoleMapping:()=>o.updateGroupRoleMapping});var o=n(49282)},96948:(e,t,n)=>{n.r(t),n.d(t,{default:()=>j});var o=n(14603),a=n(90268),r=n(81816),i=n(38314),l=n(67127),c=n(52983),s=n(9202),u=n(54221),p=n(14969),d=n(74691),m=n(16837),f=n(61133),h=n(30640),g=n(94635),y=n(6299),v=n(97860),E=n(60611);function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],c=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}const S=function(e){var t=e.appId,n=e.rolesList,o=e["data-componentid"],a=(0,s.$)().t,i=window.AppUtils.getConfig().organizationName,l=A((0,c.useState)(""),2),u=l[0],m=l[1],f=A((0,c.useState)(n),2),y=f[0],b=f[1],S=function(e){i?h.m8.push({pathname:E.$x.getPaths().get("APPLICATION_ROLES_EDIT_SUB").replace(":applicationId",t).replace(":roleId",e.name)}):h.m8.push({pathname:E.$x.getPaths().get("APPLICATION_ROLES_EDIT").replace(":applicationId",t).replace(":roleId",e.name)})},R=function(){m(""),b(n)};return c.createElement(c.Fragment,null,c.createElement(g.Z,null,c.createElement(g.Z.Row,{columns:1,className:"pb-0"},c.createElement(g.Z.Column,{width:10},c.createElement(p.Z,{"data-componentid":"".concat(o,"-application-list-search-input"),icon:c.createElement(d.Z,{name:"search"}),iconPosition:"left",onChange:function(e){return function(e){if(m(e),""!==e){var t=n.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())}));b(t)}else b(n)}(e.target.value)},value:u,placeholder:"Search role",floated:"left",fluid:!0,transparent:!0}))),c.createElement(g.Z.Row,{columns:1},c.createElement(g.Z.Column,{width:10},c.createElement(r.wQ,{showHeader:!1,loadingStateOptions:{count:E.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT,imageType:"square"},actions:[{icon:function(){return"add"},onClick:function(e,t){return S(t)},popupText:function(){return a("extensions:console.applicationRoles.assignGroupWizard.heading")},renderer:"semantic-icon"}],columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){return c.createElement(v.Z,{image:!0,as:"h6",className:"header-with-icon","data-testid":"".concat(o,"-item-heading")},c.createElement(v.Z.Content,null,c.createElement("div",{className:"mt-1"},e.name," ")))},title:null},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:null}],data:y,onRowClick:function(e,t){return S(t)},"data-testid":o,placeholders:u&&0===(null==y?void 0:y.length)?c.createElement(r.$J,{"data-testid":"".concat(o,"-search-empty-placeholder"),action:c.createElement(r.Qj,{"data-testid":"".concat(o,"-search-empty-placeholder-clear-button"),onClick:R},a("console:manage.features.roles.list.emptyPlaceholders.search.action")),title:a("console:manage.features.roles.list.emptyPlaceholders.search.title"),subtitle:[a("console:manage.features.roles.list.emptyPlaceholders.search.subtitles.0",{searchQuery:u}),a("console:manage.features.roles.list.emptyPlaceholders.search.subtitles.1")]}):null,transparent:!0})))))};function R(e){return function(e){if(Array.isArray(e))return C(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],c=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var P=function(e){var t,n=e.onSearchQueryClear,o=e.roleList,a=e.searchQuery,i=e["data-componentid"],l=(0,s.$)().t,u=w((0,c.useState)([]),2),p=u[0],d=u[1],m=function(){return h.m8.push(h.$x.getPaths().get("APPLICATIONS"))};return c.createElement(c.Fragment,null,c.createElement(g.Z.Row,null,c.createElement(g.Z.Column,{mobile:16,tablet:16,computer:12},c.createElement(y.Z,{"data-componentid":"".concat(i,"-application-roles")},(t=o,c.createElement(c.Fragment,null,a&&0===(null==o?void 0:o.length)?c.createElement(r.$J,{"data-testid":"".concat(i,"-search-empty-placeholder"),action:c.createElement(r.Qj,{"data-testid":"".concat(i,"-search-empty-placeholder-clear-button"),onClick:n},l("console:manage.features.roles.list.emptyPlaceholders.search.action")),image:(0,h.jF)().emptySearch,imageSize:"tiny",title:l("console:manage.features.roles.list.emptyPlaceholders.search.title"),subtitle:[l("console:manage.features.roles.list.emptyPlaceholders.search.subtitles.0",{searchQuery:a}),l("console:manage.features.roles.list.emptyPlaceholders.search.subtitles.1")]}):0===(null==o?void 0:o.length)?c.createElement(r.$J,{"data-testid":"".concat(i,"-empty-list-empty-placeholder"),action:c.createElement(r.Qj,{onClick:m},l("extensions:manage.groups.edit.roles.placeHolders.emptyRoles.action")),image:(0,h.jF)().newList,imageSize:"tiny",title:l("extensions:console.applicationRoles.roleList.placeholder.title"),subtitle:[l("extensions:console.applicationRoles.roleList.placeholder.subTitle.0"),l("extensions:console.applicationRoles.roleList.placeholder.subTitle.1")]}):null,c.createElement(r.el,null,t.map((function(e){return c.createElement(c.Fragment,{key:e.app},c.createElement(r.el.Title,{id:e.app,"data-componentid":"".concat(i,"-").concat(e.app,"-title"),attached:!0,active:null==p?void 0:p.includes(e.app),accordionIndex:e.app,className:"nested-list-accordion-title mb-2 mt-1",onClick:function(){return t=e,o=d,a=R(n=p),null!=n&&n.includes(t.app)?a=a.filter((function(e){return e!==t.app})):a.push(t.app),void o(a);var t,n,o,a},hideChevron:!1},c.createElement(r.JT,{image:c.createElement(r.Xo,{name:null==e?void 0:e.appName,size:"mini","data-componentid":"".concat(i,"-item-image-inner")}),size:"mini",spaced:"right","data-componentid":"".concat(i,"-item-image")}),e.appName),c.createElement(r.el.Content,{secondary:!1,active:null==p?void 0:p.includes(e.app),"data-componentid":"".concat(i,"-color-palette-accordion-content")},c.createElement(S,{appId:e.app,rolesList:e.roles})))})))))))))};function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],c=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}P.defaultProps={selection:!0,showHeader:!1,showListItemActions:!0,showMetaContent:!0,showRoleType:!1};var x=function(e){var t=e["data-componentid"],n=(0,u.I0)(),g=(0,s.$)().t,y=window.AppUtils.getConfig().organizationName,v=L((0,c.useState)(!1),2),E=v[0],A=v[1],b=L((0,c.useState)(!1),2),S=b[0],R=b[1],w=L((0,c.useState)(""),2),I=w[0],C=w[1],T=L((0,c.useState)(!0),2),x=T[0],j=T[1],O=L((0,c.useState)([]),2),_=O[0],k=O[1],Z=L((0,c.useState)([]),2),N=Z[0],Q=Z[1],U=h.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT;(0,c.useEffect)((function(){A(!1)}),[E]),(0,c.useEffect)((function(){$()}),[]);var $=function(){j(!0),(0,m.getAllApplicationRolesList)().then((function(e){z(e),R(!1)})).catch((function(e){var t,r,i,l,c,s,u,p,d,m,f;(R(!0),null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(r=t.data)&&void 0!==r&&r.description)?n((0,a.V_)({description:null!==(i=null!==(l=null==e||null===(c=e.response)||void 0===c||null===(s=c.data)||void 0===s?void 0:s.description)&&void 0!==l?l:null==e||null===(u=e.response)||void 0===u||null===(p=u.data)||void 0===p?void 0:p.detail)&&void 0!==i?i:g("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.error.description"),level:o.QU.ERROR,message:null!==(d=null==e||null===(m=e.response)||void 0===m||null===(f=m.data)||void 0===f?void 0:f.message)&&void 0!==d?d:g("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.error.message")})):(n((0,a.V_)({description:g("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.genericError.description"),level:o.QU.ERROR,message:g("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.genericError.message")})),j(!1))}))},z=function(e){(0,l.Z)(e)?j(!1):(0,f.AY)(100,null,null).then((function(t){M(t.applications,e),R(!1)})).catch((function(e){R(!0),e.response&&e.response.data&&e.response.data.description?n((0,a.V_)({description:e.response.data.description,level:o.QU.ERROR,message:g("console:develop.features.applications.notifications.fetchApplications.error.message")})):(n((0,a.V_)({description:g("console:develop.features.applications.notifications.fetchApplications.genericError.description"),level:o.QU.ERROR,message:g("console:develop.features.applications.notifications.fetchApplications.genericError.message")})),j(!1))}))},M=function(e,t){var n=t.filter((function(t){var n=(0,i.Z)(e,(function(e){return e.id===(null==t?void 0:t.app)}));if(n)return t.appName=null==n?void 0:n.name,t}));k(n),Q(n),j(!1)};return c.createElement(r.Xg,{title:g("extensions:console.applicationRoles.heading"),description:g("extensions:console.applicationRoles.subHeading"),pageTitle:g("extensions:console.applicationRoles.heading"),backButton:y?{onClick:function(){h.m8.push(h.$x.getPaths().get("ROLES"))},text:g("extensions:console.applicationRoles.roles.goBackToRoles")}:null},S?c.createElement(r.$J,{subtitle:[g("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.genericError.description")],title:g("extensions:manage.groups.edit.roles.notifications.fetchApplicationRoles.genericError.message"),image:(0,h.jF)().genericError,imageSize:"tiny"}):c.createElement(r.PS,{advancedSearch:c.createElement(p.Z,{className:"m-3","data-componentid":"".concat(t,"-search-input"),icon:c.createElement(d.Z,{name:"search"}),iconPosition:"left",onChange:function(e){return function(e){C(e);var t=_.filter((function(t){return t.appName.toLowerCase().includes(e.toLowerCase())}));Q(t)}(e.target.value)},value:I,placeholder:g("extensions:console.applicationRoles.searchApplication"),floated:"left",style:{width:300},transparent:!0}),onPageChange:null,showPagination:!1,showTopActionPanel:!(x||!I&&(null==N?void 0:N.length)<=0),totalPages:Math.ceil((null==_?void 0:_.length)/U),totalListSize:null==_?void 0:_.length,isLoading:x},c.createElement(P,{"data-componentid":"".concat(t,"-application-list"),isLoading:x,onSearchQueryClear:function(){C(""),Q(_)},roleList:N,searchQuery:I})))};x.defaultProps={"data-componentid":"application-roles-page"};const j=x}}]);