"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[68032,53475,14021,42904],{53475:(e,t,n)=>{n.r(t),n.d(t,{APIResourceUtils:()=>p});var i=n(56254);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,r(i.key),i)}}function a(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==o(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===o(t)?t:String(t)}var c,l,u,p=a((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));c=p,u=function(e){return e===i.APIResourcesConstants.CHOREO_GW_NAME},(l=r(l="checkIfAPIResourceManagedByChoreo"))in c?Object.defineProperty(c,l,{value:u,enumerable:!0,configurable:!0,writable:!0}):c[l]=u},22916:(e,t,n)=>{n.r(t),n.d(t,{APIAuthorization:()=>P});var i=n(83374),o=n(14603),s=n(90268),a=n(81816),r=n(52983),c=n(9202),l=n(39990),u=n(54221),p=n(94635),d=n(74691),m=n(75917),f=n(68032),h=n(42904),b=n(30640),v=n(15522),A=n(55379),S=n(53475),E=n(55498);function g(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||R(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,s,a,r=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return r}}(e,t)||R(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var P=function(e){var t=e.isChoreoApp,n=e["data-componentid"],R=(0,c.$)().t,I=(0,u.I0)(),P=(0,a.fQ)().getLink,z=y((0,r.useState)(!1),2),x=z[0],C=z[1],w=y((0,r.useState)(!1),2),O=w[0],Z=w[1],U=y((0,r.useState)(null),2),_=U[0],k=U[1],N=y((0,r.useState)(!1),2),T=N[0],j=N[1],F=y((0,r.useState)(!1),2),V=F[0],D=F[1],H=y((0,r.useState)(!1),2),L=H[0],Q=H[1],M=y((0,r.useState)([]),2),$=M[0],J=M[1],K=y((0,r.useState)(!1),2),W=K[0],B=K[1],q=y((0,r.useState)(!0),2),G=q[0],X=q[1],Y=y((0,r.useState)(!1),2),ee=Y[0],te=Y[1],ne=y((0,r.useState)([]),2),ie=ne[0],oe=ne[1],se=(0,u.v9)((function(e){return e.config.ui.features})),ae=(0,u.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),re=b.m8.location.pathname.split("/"),ce=re[re.length-1].split("#")[0],le=["gwName","permissions"],ue=(0,v.useAPIResources)(),pe=ue.data,de=ue.isLoading,me=ue.error,fe=ue.mutate,he=(0,E.useSubscribedAPIResources)(ce),be=he.data,ve=he.isLoading,Ae=he.isValidating,Se=he.error,Ee=he.mutate,ge=!!Se||!!me||0===(null==pe?void 0:pe.apiResources.length)||0===(null==ie?void 0:ie.length);(0,r.useEffect)((function(){!Ae&&(null==be?void 0:be.length)>0?function(){te(!0);var e=be.map((function(e){return e.apiId}));(0,E.searchAPIResources)(e,le).then((function(e){var t=be.map((function(t){var n=e.find((function(e){return e.id===t.apiId}));return t.isChoreoAPI=S.APIResourceUtils.checkIfAPIResourceManagedByChoreo(null==n?void 0:n.gwName),t.allPermissions=null==n?void 0:n.permissions,t}));oe(t)})).catch((function(){I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.message")}))})).finally((function(){te(!1)}))}():oe(be||[])}),[be]),(0,r.useEffect)((function(){var e,t;if((me||Se)&&(X(!0),!O))if(Z(!0),(null===(e=(me||Se).response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.code)===A.APIResourcesConstants.UNAUTHORIZED_ACCESS)I((0,s.V_)({description:R("extensions:develop.apiResource.notifications.getAPIResources.unauthorizedError.description"),level:o.QU.ERROR,message:R("extensions:develop.apiResource.notifications.getAPIResources.unauthorizedError.message")}));else I((0,s.V_)({description:R("extensions:develop.apiResource.notifications.getAPIResources.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.apiResource.notifications.getAPIResources.genericError.message")}))}),[me,Se]),(0,r.useEffect)((function(){C(L||de||ve||ee)}),[L,de,ve,ee]),(0,r.useEffect)((function(){if((null==ie?void 0:ie.length)>0){var e=[];ie.forEach((function(t){e=e.concat(t.permissions)})),J(e)}}),[ie]),(0,r.useEffect)((function(){L&&(fe(),Ee(),Q(!1))}),[L]),(0,r.useEffect)((function(){var e;pe&&ie&&B((null===(e=pe.apiResources)||void 0===e?void 0:e.length)===ie.length)}),[pe,ie]);var ye=function(){var e,t;return(0,i.hasRequiredScopes)(null==se?void 0:se.applications,null==se||null===(e=se.applications)||void 0===e||null===(t=e.scopes)||void 0===t?void 0:t.update,ae)};(0,r.useEffect)((function(){var e,t=!ye()||0===(null==pe||null===(e=pe.apiResources)||void 0===e?void 0:e.length)||0===(null==ie?void 0:ie.length);X(t)}),[se,pe,ie]);return r.createElement(r.Fragment,null,r.createElement(a.pJ,{padded:"very",loading:x,"data-componentid":"".concat(n,"-sub-api-resources-section")},r.createElement(p.Z,null,r.createElement(p.Z.Row,null,r.createElement(p.Z.Column,{className:"heading-wrapper",computer:8,mobile:10},r.createElement(a.X6,{as:"h4"},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.heading")),r.createElement(a.X6,{subHeading:!0,ellipsis:!0,as:"h6"},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.subHeading"),r.createElement(a.eb,{link:P("develop.applications.apiAuthorization.learnMore")},R("extensions:common.learnMore")))),r.createElement(p.Z.Column,{computer:4,mobile:6},!G&&r.createElement(a.GI,{content:W?R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.allAPIAuthorizedPopOver"):null,position:"top center",disabled:!W,trigger:r.createElement("span",null,r.createElement(a.KM,{"data-componentid":"subscribed-api-resources-subcribe-api-resource-button",size:"medium",floated:"right",onClick:function(){return D(!0)},disabled:W},r.createElement(d.Z,{name:"add"}),R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.subAPIResource")))})))),r.createElement(m.Z,{hidden:!0}),r.createElement(f.SubscribedAPIResources,{appId:ce,allAPIResourcesListData:null==pe?void 0:pe.apiResources,allAPIResourcesFetchRequestError:me,allAuthorizedScopes:$,subscribedAPIResourcesListData:ie,subscribedAPIResourcesFetchRequestError:Se,isChoreoApp:t,isScopesAvailableForUpdate:ye(),isShownPlaceholder:ge,setRemoveSubscribedAPIResource:k,bulkChangeAllAuthorizedScopes:function(e,t){if(t)J($.filter((function(t){return!e.some((function(e){return e.name===t.name}))})));else{var n=e.filter((function(e){return!$.some((function(t){return e.name===t.name}))}));J([].concat(g($),g(n)))}},setIsAuthorizeAPIResourceWizardOpen:D})),_&&r.createElement(a.cV,{primaryActionLoading:T,open:null!==_,onClose:function(){return k(null)},type:"negative",assertionHint:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.assertionHint"),assertionType:"checkbox",primaryAction:R("common:confirm"),secondaryAction:R("common:cancel"),onSecondaryActionClick:function(){return k(null)},onPrimaryActionClick:function(){return j(!0),void(0,E.unsubscribeAPIResources)(ce,null==_?void 0:_.apiId).then((function(){I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.success.description"),level:o.QU.SUCCESS,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.success.message")})),j(!1),Q(!0)})).catch((function(e){switch(null==e?void 0:e.code){case A.APIResourcesConstants.UNAUTHORIZED_ACCESS:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.unauthorizedError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.unauthorizedError.message")}));break;case A.APIResourcesConstants.NO_VALID_API_RESOURCE_ID_FOUND:case A.APIResourcesConstants.API_RESOURCE_NOT_FOUND:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.notFoundError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.notFoundError.message")}));break;default:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.unSubscribe.genericError.message")}))}})).finally((function(){j(!1),k(null)}))},"data-componentid":"".concat(n,"-delete-confirmation-modal"),closeOnDimmerClick:!1},r.createElement(a.cV.Header,{"data-componentid":"".concat(n,"-delete-confirmation-modal-header")},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.header")),r.createElement(a.cV.Message,{attached:!0,negative:!0,"data-componentid":"".concat(n,"-delete-confirmation-modal-message")},R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.message")),r.createElement(a.cV.Content,{"data-componentid":"".concat(n,"-delete-confirmation-modal-content")},t&&_.isChoreoAPI?r.createElement(l.c,{i18nKey:"extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeChoreoAPIResource.content"},"Unsubscribing this API resource will not be reflected on the Choreo end, but will impact/affect the user authorization as the authorized scopes will no longer be accessible. ",r.createElement("b",null,"Proceed with caution.")):R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.confirmations.unsubscribeAPIResource.content"))),V&&r.createElement(h.AuthorizeAPIResource,{subscribedAPIResourcesListData:ie,closeWizard:function(){return D(!1)},handleCreateAPIResource:function(e,t,n,i){(0,E.createAuthorizedAPIResource)(ce,e,t,n).then((function(){I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.success.description"),level:o.QU.SUCCESS,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.success.message")})),Q(!0),D(!1)})).catch((function(e){switch(null==e?void 0:e.code){case A.APIResourcesConstants.UNAUTHORIZED_ACCESS:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.unauthorizedError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.unauthorizedError.message")}));break;case A.APIResourcesConstants.NO_VALID_API_RESOURCE_ID_FOUND:case A.APIResourcesConstants.API_RESOURCE_NOT_FOUND:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.notFoundError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.notFoundError.message")}));break;default:I((0,s.V_)({description:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.description"),level:o.QU.ERROR,message:R("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.createAuthorizedAPIResource.genericError.message")}))}})).finally((function(){j(!1),i&&i()}))}}))};P.defaultProps={"data-componentid":"api-authorization-tab"}},68032:(e,t,n)=>{n.r(t),n.d(t,{APIAuthorization:()=>i.APIAuthorization,ScopeForm:()=>s.ScopeForm,SubscribedAPIResources:()=>o.SubscribedAPIResources});var i=n(22916),o=n(97783),s=n(14021)},14021:(e,t,n)=>{n.r(t),n.d(t,{ScopeForm:()=>E});var i=n(42125),o=n(14603),s=n(90268),a=n(81816),r=n(52983),c=n(9202),l=n(54221),u=n(97860),p=n(94635),d=n(16029),m=n(5873),f=n(55379),h=n(55498);function b(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,s,a,r=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return r}}(e,t)||A(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){if(e){if("string"==typeof e)return S(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var E=function(e){var t=e.appId,n=e.subscribedAPIResource,A=e.isScopesAvailableForUpdate,S=e.bulkChangeAllAuthorizedScopes,E=e["data-componentid"],g=(0,c.$)().t,y=(0,l.I0)(),R=v((0,r.useState)(!1),2),I=R[0],P=R[1],z=v((0,r.useState)(!0),2),x=z[0],C=z[1],w=v((0,r.useState)(null),2),O=w[0],Z=w[1],U=v((0,r.useState)(null),2),_=U[0],k=U[1],N=v((0,r.useState)(n.permissions),2),T=N[0],j=N[1],F=v((0,r.useState)(null),2),V=F[0],D=F[1],H=v((0,r.useState)([]),2),L=H[0],Q=H[1],M=v((0,r.useState)([]),2),$=M[0],J=M[1],K=v((0,r.useState)(!1),2),W=K[0],B=K[1],q=v((0,r.useState)(!1),2),G=q[0],X=q[1],Y=I||null===O||null===_||null===V;(0,r.useEffect)((function(){var e,t=[];null===(e=n.allPermissions)||void 0===e||e.forEach((function(e){t.push({content:r.createElement(u.Z,{as:"h6",className:"header-with-icon","data-componentId":"".concat(E,"-heading")},r.createElement(u.Z.Content,null,e.displayName,r.createElement(u.Z.Subheader,null,r.createElement(a.EK,{withBackground:!0},e.name)))),key:e.name,text:e.displayName,value:e.name})})),Z(t)}),[n]),(0,r.useEffect)((function(){var e=[];n.permissions.forEach((function(t){e.push(t.name)})),k(e),D(e)}),[n]),(0,r.useEffect)((function(){var e;B((null===(e=n.allPermissions)||void 0===e?void 0:e.length)===(null==V?void 0:V.length))}),[V,n]),(0,r.useEffect)((function(){X(0===(null==V?void 0:V.length))}),[V]);var ee=function(e,t){var n=e.map((function(e){return e.name}));t?(0!==(null==_?void 0:_.toString().length)?C(!1):C(!0),j([]),D([]),J(_),Q([])):(_.toString()!==n.toString()?C(!1):C(!0),j(e),D(n),Q(n.filter((function(e){return!_.includes(e)}))),J([]))};return r.createElement(a.pJ,{padded:"very"},Y?null===V||null===O||null===_||I?r.createElement(a.pO,{inline:"centered",active:!0}):null:r.createElement(p.Z,null,r.createElement(p.Z.Row,{columns:1},r.createElement(p.Z.Column,null,r.createElement(d.Z,null,r.createElement(d.Z.Field,null,r.createElement(p.Z,null,r.createElement(p.Z.Row,{columns:2},r.createElement(p.Z.Column,{className:"pb-1",floated:"left",stretched:!0,verticalAlign:"bottom"},r.createElement("label",null,g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.label"))),r.createElement(p.Z.Column,{floated:"right",textAlign:"right"},A&&r.createElement(a.xv,{className:"mb-0",muted:!0,subHeading:!0,size:12},r.createElement(i.Z,{variant:"text",size:"small",tabIndex:6,disabled:W,onClick:function(){return ee(n.allPermissions?n.allPermissions:[],!1)}},g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.selectAll")),"|",r.createElement(i.Z,{variant:"text",size:"small",tabIndex:7,disabled:G,onClick:function(){return ee(n.allPermissions?n.allPermissions:[],!0)}},g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.selectNone")))))),r.createElement(m.Z,{placeholder:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.placeholder"),fluid:!0,multiple:!0,search:!0,selection:!0,options:O||[],defaultValue:_,value:V,onChange:function(e,t){var i=t.value;if(D(i),i.toString()!==_.toString()?C(!1):C(!0),i.length>=T.length){var o,s=null===(o=n.allPermissions)||void 0===o?void 0:o.find((function(e){return e.name===i[i.length-1]}));s&&j([].concat(b(T),[s])),_.includes(s.name)||Q([].concat(b(L),[s.name])),$.includes(s.name)&&J($.filter((function(e){return e!==s.name})))}else{var a=null==T?void 0:T.filter((function(e){return!i.includes(e.name)}))[0];a&&j(T.filter((function(e){return e.name!==a.name}))),_.includes(a.name)&&J([].concat(b($),[a.name])),L.includes(a.name)&&Q(L.filter((function(e){return e!==a.name})))}},disabled:!A}),r.createElement(a.kW,null,g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.hint")))))),A&&r.createElement(p.Z.Row,null,r.createElement(p.Z.Column,{floated:"left"},r.createElement(a.Qj,{size:"small",floated:"left",tabIndex:8,onClick:function(){D(_),j(n.permissions),Q([]),J([]),C(!0)},"data-componentid":"".concat(E,"-cancel-btn"),disabled:x},g("common:cancel")),r.createElement(a.KM,{size:"small",floated:"right",tabIndex:9,onClick:function(){P(!0),(0,h.patchScopesOfAPIResource)(t,null==n?void 0:n.apiId,L,$).then((function(){var e,t;y((0,s.V_)({description:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.success.description"),level:o.QU.SUCCESS,message:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.success.message")}));var i=null===(e=n.allPermissions)||void 0===e?void 0:e.map((function(e){if(L.includes(e.name))return e})).filter((function(e){return void 0!==e})),a=null===(t=n.allPermissions)||void 0===t?void 0:t.map((function(e){if($.includes(e.name))return e})).filter((function(e){return void 0!==e}));0!==(null==i?void 0:i.length)&&S(i,!1),0!==(null==a?void 0:a.length)&&S(a,!0),Q([]),J([]),k(V),C(!0)})).catch((function(e){if((null==e?void 0:e.code)===f.APIResourcesConstants.UNAUTHORIZED_ACCESS)y((0,s.V_)({description:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.unauthorizedError.description"),level:o.QU.ERROR,message:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.unauthorizedError.message")}));else y((0,s.V_)({description:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.genericError.description"),level:o.QU.ERROR,message:g("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.notifications.patchScopes.genericError.message")}))})).finally((function(){return P(!1)}))},"data-componentid":"".concat(E,"-update-btn"),disabled:x},g("extensions:develop.applications.edit.sections.apiAuthorization.sections.policySection.buttons.update"))))))};E.defaultProps={"data-componentid":"permission-form"}},97783:(e,t,n)=>{n.r(t),n.d(t,{SubscribedAPIResources:()=>g});var i=n(31092),o=n(41482),s=n(81816),a=n(30640),r=n(52983),c=n(9202),l=n(39990),u=n(74691),p=n(97860),d=n(94635),m=n(73949),f=n(14969),h=n(16029),b=n(68032),v=n(55379),A=n(43469);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,s,a,r=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(i=s.call(n)).done)&&(r.push(i.value),r.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return r}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var g=function(e){var t=e.appId,n=e.allAPIResourcesListData,E=e.allAPIResourcesFetchRequestError,g=e.allAuthorizedScopes,y=e.subscribedAPIResourcesListData,R=e.subscribedAPIResourcesFetchRequestError,I=e.isScopesAvailableForUpdate,P=e.isChoreoApp,z=e.setRemoveSubscribedAPIResource,x=e.bulkChangeAllAuthorizedScopes,C=e.setIsAuthorizeAPIResourceWizardOpen,w=e["data-componentid"],O=0===(null==n?void 0:n.length)||0===(null==y?void 0:y.length)||null!=E||null!=R,Z=(0,c.$)().t,U=S((0,r.useState)(null),2),_=U[0],k=U[1],N=S((0,r.useState)(null),2),T=N[0],j=N[1],F=S((0,r.useState)(null),2),V=F[0],D=F[1],H=S((0,r.useState)(null),2),L=H[0],Q=H[1];(0,r.useEffect)((function(){y&&D(y)}),[y]),(0,r.useEffect)((function(){g&&Q(g.map((function(e){return e.name})).join(" "))}),[g]);var M=function(){return a.m8.push(v.APIResourcesConstants.getPaths().get("API_RESOURCES"))},$=function(){return E||R?r.createElement(s.$J,{image:(0,a.jF)().genericError,imageSize:"tiny",title:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.errorText.title"),subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.errorText.subtitles.1"),Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.errorText.subtitles.0")],"data-componentid":"".concat(w,"-all-empty-placeholder-icon")}):n&&0===n.length?r.createElement(s.$J,{image:(0,a.jF)().emptySearch,action:I&&r.createElement(s.rU,{"data-componentid":"".concat(w,"-link-api-resource-page"),onClick:M,external:!1},Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.noAPIResourcesLink")),imageSize:"tiny",subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.noAPIResources")],"data-componentid":"".concat(w,"-sub-empty-placeholder-icon")}):y&&0===y.length?r.createElement(s.$J,{image:(0,a.jF)().emptyList,action:I&&r.createElement(s.KM,{"data-componentid":"".concat(w,"-empty-placeholder-sub-api-resource-button"),onClick:function(){return C(!0)}},r.createElement(u.Z,{name:"add"}),Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.subAPIResource")),imageSize:"tiny",subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptyText")],"data-componentid":"".concat(w,"-sub-empty-placeholder-icon")}):0===(null==V?void 0:V.length)?r.createElement(s.$J,{title:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptySearch.title"),subtitle:[Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptySearch.subTitle.0"),Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.placeHolderTexts.emptySearch.subTitle.1")],image:(0,a.jF)().emptySearch,action:r.createElement(s.Qj,{onClick:B},Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.buttons.emptySearchButton")),imageSize:"tiny"}):null},J=function(e){return r.createElement(p.Z,{as:"h6",className:"header-with-icon","data-componentId":"".concat(w,"-heading")},r.createElement(d.Z,{verticalAlign:"middle"},r.createElement(d.Z.Row,null,r.createElement(d.Z.Column,{width:8},r.createElement(p.Z.Content,null,r.createElement(d.Z,{verticalAlign:"middle"},r.createElement(d.Z.Row,null,r.createElement(d.Z.Column,{width:16},e.apiDisplayName,e.isChoreoAPI&&r.createElement(m.Z,{size:"mini",className:"choreo-label"},Z("extensions:develop.apiResource.managedByChoreoText"))))),r.createElement(p.Z.Subheader,{className:"mt-1"},e.apiIdentifier?r.createElement(s.EK,{withBackground:!0},e.apiIdentifier):null))),r.createElement(d.Z.Column,{width:8},e.apiIdentifier?r.createElement(p.Z.Subheader,null,function(e){switch(e){case A.Policy.ROLE:return o.I18n.instance.t("extensions:develop.applications.edit.sections.apiAuthorization.sections.policySection.form.fields.rbac.name");case A.Policy.NO:default:return o.I18n.instance.t("extensions:develop.applications.edit.sections.apiAuthorization.sections.policySection.form.fields.noPolicy.name")}}(e.policyIdentifier)):null))))},K=function(e){return[{disabled:!I,icon:"trash alternate",onClick:function(){return z(e)},popoverText:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.unsubscribeAPIResourcePopOver"),type:"icon"}]},W=function(e){return r.createElement(r.Fragment,null,P&&e.isChoreoAPI&&r.createElement(i.Z,{severity:"warning"},r.createElement(l.c,{i18nKey:"extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.choreoApiEditWarning"},"Updating the authorized scopes will create unforeseen errors as this is an API resource managed by Choreo. ",r.createElement("b",null,"Proceed with caution."))),r.createElement(b.ScopeForm,{appId:t,subscribedAPIResource:e,isScopesAvailableForUpdate:I,bulkChangeAllAuthorizedScopes:x}))},B=function(){j(""),D(y)};return O?r.createElement(s.pJ,null,$()):r.createElement(d.Z,{className:"mt-3"},r.createElement(d.Z.Row,{columns:1},r.createElement(d.Z.Column,{mobile:16,tablet:16,computer:12},r.createElement(s.PS,{showTopActionPanel:!0,showPagination:!1,onPageChange:function(){return null},totalPages:100,"data-componentid":"".concat(w,"-list-layout"),totalListSize:null==y?void 0:y.length,leftActionPanel:r.createElement("div",{className:"advanced-search-wrapper aligned-left fill-default"},r.createElement(f.Z,{className:"advanced-search with-add-on","data-componentid":"".concat(w,"-list-search-input"),icon:"search",iconPosition:"left",onChange:function(e){var t=e.target.value;j(t),t.length>0?D(null==y?void 0:y.filter((function(e){return e.apiDisplayName.toLowerCase().includes(t.toLowerCase())}))):D(y)},placeholder:Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.search"),floated:"right",size:"small",value:T}))},0!==(null==V?void 0:V.length)?r.createElement(s.el,{"data-componentid":"".concat(w,"-subscribed-api-resources"),viewType:"table-view"},null==V?void 0:V.map((function(e){return r.createElement(r.Fragment,{key:e.apiId},r.createElement(s.el.Title,{id:e.apiId,"data-componentid":"".concat(w,"-title"),active:_===e.apiId,accordionIndex:e.apiId,onClick:function(){return function(e){_===e.apiId?k(null):k(e.apiId)}(e)},content:J(e),hideChevron:!1,actions:K(e)}),r.createElement(s.el.Content,{active:_===e.apiId,"data-componentid":"".concat(w,"-").concat(e.apiId,"\n                                                                                    -content"),children:W(e)}))}))):$()))),L&&r.createElement(d.Z.Row,{className:"mt-2"},r.createElement(d.Z.Column,{mobile:16,tablet:16,computer:12},r.createElement(d.Z.Row,null,r.createElement(h.Z,null,r.createElement(h.Z.Field,null,r.createElement(s.OR,{className:"copy-input spaced",value:L,"data-componentid":"".concat(w,"-selected-scope-area")}),r.createElement(s.kW,null,Z("extensions:develop.applications.edit.sections.apiAuthorization.sections.apiSubscriptions.scopesSection.copyScopesHint"))))))))};g.defaultProps={"data-componentid":"subscribed-api-resources"}},42904:(e,t,n)=>{n.r(t),n.d(t,{AuthorizeAPIResource:()=>i.AuthorizeAPIResource});var i=n(65123)}}]);