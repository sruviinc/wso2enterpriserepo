"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[30143],{30143:(e,n,t)=>{t.r(n),t.d(n,{default:()=>L});var a=t(7955),o=t(83374),i=t(14603),r=t(90268),l=t(13318),c=t(41482),s=t(81816),u=t(38314),d=t(67127),f=t(52983),g=t(9202),m=t(54221),p=t(74691),v=t(97860),h=t(75917),E=t(58047),z=t(16782),S=t(30640),b=t(11542),y=t(73479);function O(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||A(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,o,i,r,l=[],c=!0,s=!1;try{if(i=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;c=!1}else for(;!(c=(a=i.call(t)).done)&&(l.push(a.value),l.length!==n);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=t.return&&(r=t.return(),Object(r)!==r))return}finally{if(s)throw o}}return l}}(e,n)||A(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,n){if(e){if("string"==typeof e)return R(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?R(e,n):void 0}}function R(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=new Array(n);t<n;t++)a[t]=e[t];return a}var k=[{key:0,text:c.I18n.instance.t("common:name"),value:"name"}],I=function(e){var n,t,c,A,R=e["data-componentid"],I=(0,g.$)().t,L=(0,m.I0)(),P=C((0,f.useState)(null),2),_=P[0],w=P[1],Z=C((0,f.useState)(""),2),T=Z[0],U=Z[1],j=C((0,f.useState)(k[0]),2),Q=j[0],V=j[1],M=C((0,f.useState)(S.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),N=M[0],x=M[1],D=C((0,f.useState)(!0),2),F=D[0],X=D[1],B=C((0,f.useState)(!1),2),q=B[0],W=B[1],$=C((0,f.useState)(void 0),2),G=$[0],H=$[1],K=C((0,f.useState)(void 0),2),J=K[0],Y=K[1],ee=C((0,f.useState)(null),2),ne=ee[0],te=ee[1],ae=C((0,f.useState)([]),2),oe=ae[0],ie=ae[1],re=C((0,f.useState)(null),2),le=re[0],ce=re[1],se=C((0,f.useState)(""),2),ue=se[0],de=se[1],fe=C((0,f.useState)(""),2),ge=fe[0],me=fe[1],pe=C((0,f.useState)(""),2),ve=pe[0],he=pe[1],Ee=C((0,f.useState)(""),2),ze=Ee[0],Se=Ee[1],be=C((0,f.useState)(1),2),ye=be[0],Oe=be[1],Ce=(0,m.v9)((function(e){return e.organization.organization})),Ae=(0,m.v9)((function(e){return e.config.ui.features})),Re=(0,m.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),ke=S.lD.getInstance(),Ie=C((0,l.cC)(),2),Le=Ie[0],Pe=Ie[1];(0,f.useEffect)((function(){var e,n=!1,t=!1;null==_||null===(e=_.links)||void 0===e||e.forEach((function(e){if("next"===e.rel){var a=e.href.split("after=")[1];de(a),H(!0),n=!0}if("previous"===e.rel){var o=e.href.split("before=")[1];me(o),Y(!0),t=!0}})),n||(de(""),H(!1)),t||(me(""),Y(!1))}),[_]);var _e=(0,f.useCallback)((function(){Oe(1),Pe()}),[Oe,Pe]);(0,f.useEffect)((function(){ne&&!(0,d.Z)(ne)&&(0,b.Xu)(ne.id).then((function(e){ce(e)})).catch((function(e){null!=e&&e.description?L((0,r.V_)({description:e.description,level:i.QU.ERROR,message:I("console:manage.features.organizations.notifications.fetchOrganization.error.message")})):L((0,r.V_)({description:I("console:manage.features.organizations.notifications.fetchOrganization.genericError.description"),level:i.QU.ERROR,message:I("console:manage.features.organizations.notifications.fetchOrganization.genericError.message")}))}))}),[ne,L,I]);var we=(0,f.useMemo)((function(){return!ne||(0,d.Z)(ne)?T:"".concat(T?T+" and ":"","parentId eq ").concat(ne.id)}),[T,ne]),Ze=(0,f.useCallback)((function(e,n,t,a,l){var c,s;(0,o.hasRequiredScopes)(null==Ae?void 0:Ae.organizations,null==Ae||null===(c=Ae.organizations)||void 0===c||null===(s=c.scopes)||void 0===s?void 0:s.read,Re)&&(X(!0),(0,b.jX)(n,e,t,a,!1).then((function(e){w(e)})).catch((function(e){w(null),null!=e&&e.description?L((0,r.V_)({description:e.description,level:i.QU.ERROR,message:I("console:manage.features.organizations.notifications.getOrganizationList.error.message")})):L((0,r.V_)({description:I("console:manage.features.organizations.notifications.getOrganizationList.genericError.description"),level:i.QU.ERROR,message:I("console:manage.features.organizations.notifications.getOrganizationList.genericError.message")}))})).finally((function(){X(!1)})))}),[b.jX,L,I,w,X]);(0,f.useEffect)((function(){Ze(N,we,null,null)}),[N,Ze,we]);var Te=(0,b.IE)(we,N,ze,ve,z.jo.CONSOLE_APP_NAME,!1),Ue=Te.data,je=Te.isLoading,Qe=Te.error,Ve=Te.mutate;(0,f.useEffect)((function(){Qe&&Me(Qe)}),[Qe]);var Me=function(e){var n,t,a,o;null!=e&&null!==(n=e.response)&&void 0!==n&&null!==(t=n.data)&&void 0!==t&&t.description?L((0,r.V_)({description:null==e||null===(a=e.response)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.description,level:i.QU.ERROR,message:I("console:manage.features.organizations.notifications.getOrganizationList.error.message")})):L((0,r.V_)({description:I("console:manage.features.organizations.notifications.getOrganizationList.genericError.description"),level:i.QU.ERROR,message:I("console:manage.features.organizations.notifications.getOrganizationList.genericError.message")}))},Ne=(0,f.useCallback)((function(e){_e(),U(e)}),[_e,U]),xe=(0,f.useCallback)((function(e,n){var t=parseInt(null==n?void 0:n.activePage);t>ye?(Ze(N,we,ue,null),Se(ue),he(null)):t<ye&&(Ze(N,we,null,ge),Se(null),he(ge)),Oe(t)}),[Ze,ye,we,N,ue,ge]),De=(0,f.useCallback)((function(e,n){x(n.value),_e()}),[x,_e]),Fe=function(){Ze(N,we,ue,ge),Ve()},Xe=(0,f.useCallback)((function(){U(""),_e()}),[U,_e]),Be=function(e,n){var t=O(oe);t.splice(n+1),ie(t),te(e),_e(),e||ce(null)};return f.createElement(f.Fragment,null,f.createElement(s.Xg,{action:!F&&!je&&!(!T&&((0,d.Z)(_)||(null==_||null===(n=_.organizations)||void 0===n?void 0:n.length)<=0))&&f.createElement(a.di,{when:a.TA.ORGANIZATION_WRITE},f.createElement(s.KM,{disabled:F,loading:F,onClick:function(){ke.publish("organization-click-new-organization-button"),W(!0)},"data-componentid":"".concat(R,"-list-layout-add-button")},f.createElement(p.Z,{name:"add"}),I("console:manage.features.organizations.list.actions.add"))),pageTitle:I("console:manage.pages.organizations.title"),title:F?null:le?le.name:I("console:manage.features.organizations.homeList.name"),description:f.createElement("p",null,F?null:le?le.description:null),"data-componentid":"".concat(R,"-page-layout"),titleAs:"h3",componentAbovePageHeader:f.createElement(f.Fragment,null,f.createElement(v.Z,{as:"h1","data-componentid":"".concat(R,"-organization-header")},I("console:manage.pages.organizations.title"),f.createElement(v.Z.Subheader,{"data-componentid":"".concat(R,"-sub-title")},I("console:manage.pages.organizations.subTitle"))),f.createElement(h.Z,{hidden:!0}),ne&&oe.length>0&&f.createElement(E.Z,{className:"margined","data-componentid":"".concat(R,"-breadcrumb")},f.createElement(E.Z.Section,{onClick:function(){Be(null,-1)}},f.createElement("span",{"data-componentid":"".concat(R,"-breadcrumb-home")},Ce.name)),null==oe?void 0:oe.map((function(e,n){return f.createElement(f.Fragment,{key:n},f.createElement(E.Z.Divider,{icon:"right chevron"}),f.createElement(E.Z.Section,{active:n===oe.length-1,link:n!==oe.length-1,onClick:n!==oe.length-1?function(){return Be(e,n)}:null},e.name))})))," ")},f.createElement(s.PS,{advancedSearch:f.createElement(S.nC,{onFilter:Ne,filterAttributeOptions:[{key:0,text:I("common:name"),value:"name"}],filterAttributePlaceholder:I("console:manage.features.organizations.advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:I("console:manage.features.organizations.advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:I("console:manage.features.organizations.advancedSearch.form.inputs.filterValue.placeholder"),placeholder:I("console:manage.features.organizations.advancedSearch.placeholder"),defaultSearchAttribute:"name",defaultSearchOperator:"co","data-componentid":"".concat(R,"-list-advanced-search")}),currentListSize:null==_||null===(t=_.organizations)||void 0===t?void 0:t.length,listItemLimit:N,onItemsPerPageDropdownChange:De,onPageChange:xe,onSortStrategyChange:function(e,n){V((0,u.Z)(k,(function(e){return n.value===e.value})))},showPagination:!0,showTopActionPanel:F||!(!T&&(null==_||null===(c=_.organizations)||void 0===c?void 0:c.length)<=0),sortOptions:k,sortStrategy:Q,totalPages:10,totalListSize:null==_||null===(A=_.organizations)||void 0===A?void 0:A.length,paginationOptions:{disableNextButton:!G,disablePreviousButton:!J},isLoading:F,"data-componentid":"".concat(R,"-list-layout"),resetPagination:Le,activePage:ye},f.createElement(y.Bg,{list:_,authorizedList:Ue,onOrganizationDelete:function(){Ze(N,we,ue,ge)},onEmptyListPlaceholderActionClick:function(){W(!0)},onSearchQueryClear:Xe,searchQuery:T,"data-componentid":"organization-list",onListItemClick:function(e,n){if(!oe.find((function(e){return e.id===n.id}))){Xe(),te(n),_e();var t=O(oe);t.push(n),ie(t)}},parentOrganization:ne,onListMutate:Fe})),q&&f.createElement(y.Xh,{onUpdate:Fe,closeWizard:function(){return W(!1)},parent:ne})))};I.defaultProps={"data-componentid":"organizations"};const L=I}}]);