"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[76898],{76898:(e,t,n)=>{n.r(t),n.d(t,{AllUsersList:()=>h});var s=n(83374),i=n(81816),l=n(52983),a=n(9202),r=n(54221),o=n(97860),u=n(74691),c=n(30640),d=n(89423),m=n(17643),p=n(67680),g=n(99839),f=n(28438);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var s,i,l,a,r=[],o=!0,u=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(s=l.call(n)).done)&&(r.push(s.value),r.length!==t);o=!0);}catch(e){u=!0,i=e}finally{try{if(!o&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw i}}return r}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return E(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}var h=function(e){var t,n=e.defaultListItemLimit,E=e.isLoading,h=e.readOnlyUserStores,S=e.featureConfig,y=e.onColumnSelectionChange,R=e.onListItemClick,U=e.realmConfigs,C=e.selection,T=e.showListItemActions,N=e.allUsersList,A=e.onSearchQueryClear,b=e.searchQuery,I=e.handleConsumerUserDelete,O=e.handleGuestUserDelete,_=e["data-testid"],L=(0,a.$)().t,w=v((0,l.useState)(!1),2),M=w[0],k=w[1],F=v((0,l.useState)(void 0),2),x=F[0],D=F[1],P=v((0,i.ZK)(),3),j=P[0],V=P[1],G=P[2],H=v((0,l.useState)({}),2),Z=H[0],z=H[1],Y=v((0,l.useState)(""),2),q=Y[0],Q=Y[1],$=v((0,l.useState)(!1),2),J=$[0],B=$[1],K=(0,r.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.username}));(0,l.useEffect)((function(){U&&Q(null==U?void 0:U.adminUser)}),[U]),(0,l.useEffect)((function(){N&&z(N)}),[N]);var W=(0,r.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),X=function(e){(0,s.tF)(e.userName)===g.CONSUMER_USERSTORE?c.m8.push(g.UsersConstants.getPaths().get("CUSTOMER_USER_EDIT_PATH").replace(":id",e.id)):c.m8.push(g.UsersConstants.getPaths().get("COLLABORATOR_USER_EDIT_PATH").replace(":id",e.id))},ee=function(){return b&&0===(null==Z?void 0:Z.totalResults)?l.createElement(i.$J,{action:l.createElement(i.Qj,{onClick:A},L("console:manage.features.users.usersList.search.emptyResultPlaceholder.clearButton")),image:(0,c.jF)().emptySearch,imageSize:"tiny",title:L("console:manage.features.users.usersList.search.emptyResultPlaceholder.title"),subtitle:[L("console:manage.features.users.usersList.search.emptyResultPlaceholder.subTitle.0",{query:b}),L("console:manage.features.users.usersList.search.emptyResultPlaceholder.subTitle.1")]}):0===(null==Z?void 0:Z.totalResults)?l.createElement(i.$J,{"data-testid":"".concat(_,"-empty-placeholder"),image:(0,c.jF)().newList,imageSize:"tiny",title:L("console:manage.features.users.usersList.list.emptyResultPlaceholder.title"),subtitle:[L("console:manage.features.users.usersList.list.emptyResultPlaceholder.subTitle.0"),L("console:manage.features.users.usersList.list.emptyResultPlaceholder.subTitle.1"),L("console:manage.features.users.usersList.list.emptyResultPlaceholder.subTitle.2")]}):null};return l.createElement(l.Fragment,null,l.createElement(i.wQ,{className:"users-table",isLoading:E,loadingStateOptions:{count:null!=n?n:c.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT,imageType:"circular"},actions:function(){if(T){var e=[{"data-testid":"all-users-list-item-edit-button",hidden:function(){return!(0,s.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_READ"))},icon:function(e){var t,n,i,l,a=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(n=e.userName)||void 0===n?void 0:n.split("/")[0]:g.UsersConstants.ASGARDEO_USERSTORE;return!(0,s.hasRequiredScopes)(null==S?void 0:S.users,null==S||null===(i=S.users)||void 0===i||null===(l=i.scopes)||void 0===l?void 0:l.update,W)||!(0,s.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_UPDATE"))||null!=h&&h.includes(a.toString())?"eye":"pencil alternate"},onClick:function(e,t){return X(t)},popupText:function(e){var t,n,i,l,a=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(n=e.userName)||void 0===n?void 0:n.split("/")[0]:g.UsersConstants.ASGARDEO_USERSTORE;return!(0,s.hasRequiredScopes)(null==S?void 0:S.users,null==S||null===(i=S.users)||void 0===i||null===(l=i.scopes)||void 0===l?void 0:l.update,W)||!(0,s.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_UPDATE"))||null!=h&&h.includes(a.toString())?L("common:view"):L("common:edit")},renderer:"semantic-icon"}];return e.push({"data-testid":"all-users-list-item-delete-button",hidden:function(e){var t,n,i,l,a=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(n=e.userName)||void 0===n?void 0:n.split("/")[0]:g.UsersConstants.ASGARDEO_USERSTORE;return!(0,s.cr)(null==S?void 0:S.users,d._F.FEATURE_DICTIONARY.get("USER_DELETE"))||!(0,s.hasRequiredScopes)(null==S?void 0:S.users,null==S||null===(i=S.users)||void 0===i||null===(l=i.scopes)||void 0===l?void 0:l.delete,W)||(null==h?void 0:h.includes(a.toString()))||e.userName===(null==U?void 0:U.adminUser)||K.includes(e.userName)},icon:function(){return"trash alternate"},onClick:function(e,t){k(!0),D(t)},popupText:function(){return L("console:manage.features.users.usersList.list.iconPopups.delete")},renderer:"semantic-icon"}),e}}(),columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){var t,n,s,a=f.UserManagementUtils.resolveUserListHeader(e),r=f.UserManagementUtils.resolveUserListSubheader(e),u=void 0===(null===(t=e.name)||void 0===t?void 0:t.familyName)&&void 0===(null===(n=e.name)||void 0===n?void 0:n.givenName);return l.createElement(o.Z,{image:!0,as:"h6",className:"header-with-icon","data-testid":"".concat(_,"-item-heading")},l.createElement(i.Yt,{"data-testid":"all-users-list-item-image",name:(null===(s=e.userName.split("/"))||void 0===s?void 0:s.length)>1?e.userName.split("/")[1]:e.userName.split("/")[0],size:"mini",image:e.profileUrl,spaced:"right","data-hj-suppress":""}),l.createElement(o.Z.Content,null,l.createElement("div",{className:u?"mt-2":"","data-hj-suppress":""},a),!u&&l.createElement(o.Z.Subheader,{"data-testid":"".concat(_,"-item-sub-heading")},r)))},title:"User"},{allowToggleVisibility:!1,dataIndex:"type",id:"type",key:"type",render:function(e){return e.userName===q?"Owner":(0,s.tF)(e.userName)===g.CONSUMER_USERSTORE?g.UserAccountTypes.USER:m.administratorConfig.adminRoleName},title:l.createElement(l.Fragment,null,l.createElement("div",{className:"header-with-popup"},l.createElement("span",null,L("extensions:manage.users.list.columns.accountType")),l.createElement(i.GI,{trigger:l.createElement("div",{className:"inline"},l.createElement(u.Z,{disabled:!0,name:"info circle",className:"link pointing pl-1"})),content:L("extensions:manage.users.list.popups.content.AccountTypeContent"),position:"top center",size:"mini",hideOnScroll:!0,inverted:!0})))},{allowToggleVisibility:!1,dataIndex:"idpType",id:"idpType",key:"idpType",render:function(e){var t,n;return null!==(t=e[p.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.idpType?null===(n=e[p.SCIMConfigs.scim.enterpriseSchema])||void 0===n?void 0:n.idpType:"N/A"},title:l.createElement(l.Fragment,null,l.createElement("div",{className:"header-with-popup"},l.createElement("span",null,L("extensions:manage.users.list.columns.idpType")),l.createElement(i.GI,{trigger:l.createElement("div",{className:"inline"},l.createElement(u.Z,{disabled:!0,name:"info circle",className:"link pointing pl-1"})),content:L("extensions:manage.users.list.popups.content.idpTypeContent"),position:"top center",size:"mini",hideOnScroll:!0,inverted:!0})))},{allowToggleVisibility:!1,dataIndex:"userStore",id:"userStore",key:"userStore",render:function(e){var t,n;return null!==(t=e[p.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.userSource?null===(n=e[p.SCIMConfigs.scim.enterpriseSchema])||void 0===n?void 0:n.userSource:"N/A"},title:l.createElement(l.Fragment,null,l.createElement("div",{className:"header-with-popup"},l.createElement("span",null,L("extensions:manage.users.list.columns.userStore")),l.createElement(i.GI,{trigger:l.createElement("div",{className:"inline"},l.createElement(u.Z,{disabled:!0,name:"info circle",className:"link pointing pl-1"})),content:L("extensions:manage.users.list.popups.content.sourceContent"),position:"top center",size:"mini",hideOnScroll:!0,inverted:!0})))},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:""}],data:Z.Resources,onColumnSelectionChange:y,onRowClick:function(e,t){X(t),R&&R(e,t)},placeholders:ee(),selectable:C,showHeader:!0,transparent:!E&&null!==ee(),"data-testid":_}),x&&l.createElement(i.cV,{primaryActionLoading:J,"data-testid":"".concat(_,"-confirmation-modal"),onClose:function(){return k(!1)},type:"negative",open:M,assertionHint:L("console:manage.features.user.deleteUser.confirmationModal.assertionHint"),assertionType:"checkbox",primaryAction:"Confirm",secondaryAction:"Cancel",onSecondaryActionClick:function(){k(!1),V(null)},onPrimaryActionClick:function(){var e;B(!0),(null===(e=x.userName)||void 0===e?void 0:e.split("/")[0])===g.CONSUMER_USERSTORE?I(x.id).finally((function(){B(!1),D(void 0),k(!1)})):O(x.id).finally((function(){B(!1),D(void 0),k(!1)}))},closeOnDimmerClick:!1},l.createElement(i.cV.Header,{"data-testid":"".concat(_,"-confirmation-modal-header")},L("console:manage.features.user.deleteUser.confirmationModal.header")),l.createElement(i.cV.Message,{"data-testid":"".concat(_,"-confirmation-modal-message"),attached:!0,negative:!0},(0,s.tF)(x.userName)===g.CONSUMER_USERSTORE?L("console:manage.features.user.deleteUser.confirmationModal.message"):L("extensions:manage.guest.deleteUser.confirmationModal.message")),l.createElement(i.cV.Content,{"data-testid":"".concat(_,"-confirmation-modal-content")},l.createElement("div",{className:"modal-alert-wrapper"}," ",j&&G),(0,s.tF)(x.userName)===g.CONSUMER_USERSTORE?null!==(t=x[p.SCIMConfigs.scim.enterpriseSchema])&&void 0!==t&&t.userSourceId?L("console:manage.features.user.deleteJITUser.confirmationModal.content"):L("console:manage.features.user.deleteUser.confirmationModal.content"):L("extensions:manage.guest.deleteUser.confirmationModal.content"))))};h.defaultProps={selection:!0,showListItemActions:!0}}}]);