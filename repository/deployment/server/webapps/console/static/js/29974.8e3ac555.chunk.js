"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[29974],{29974:(e,n,t)=>{t.r(n),t.d(n,{OnboardedGuestUsersList:()=>C});var i=t(7955),s=t(96433),a=t(83374),o=t(14603),r=t(90268),l=t(81816),c=t(52983),u=t(9202),d=t(54221),m=t(97860),p=t(74691),g=t(73949),f=t(30640),v=t(54004),h=t(89423),E=t(67680),y=t(30458),A=t(64322),T=t(99839),R=t(28438);function S(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var i,s,a,o,r=[],l=!0,c=!1;try{if(a=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(i=a.call(t)).done)&&(r.push(i.value),r.length!==n);l=!0);}catch(e){c=!0,s=e}finally{try{if(!l&&null!=t.return&&(o=t.return(),Object(o)!==o))return}finally{if(c)throw s}}return r}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return U(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return U(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=new Array(n);t<n;t++)i[t]=e[t];return i}var C=function(e){var n=e.adminType,t=e.adminRoleId,U=e.advancedSearch,C=e.defaultListItemLimit,I=e.onUserDelete,_=e.isLoading,O=e.readOnlyUserStores,N=e.featureConfig,L=e.onColumnSelectionChange,b=e.onListItemClick,w=e.onSearchQueryClear,M=e.realmConfigs,k=e.searchQuery,P=e.selection,V=e.showListItemActions,D=e.onboardedGuestUsersList,x=e.associationType,F=e["data-componentid"],Q=(0,u.$)().t,j=(0,d.I0)(),Y=S((0,c.useState)(!1),2),Z=Y[0],z=Y[1],B=S((0,c.useState)(void 0),2),H=B[0],X=B[1],q=S((0,l.ZK)(),3),G=q[0],W=q[1],$=q[2],K=S((0,c.useState)({}),2),J=K[0],ee=K[1],ne=S((0,c.useState)(!1),2),te=ne[0],ie=ne[1],se=(0,d.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.username})),ae=(0,d.v9)((function(e){var n;return null==e||null===(n=e.auth)||void 0===n?void 0:n.allowedScopes})),oe=(0,d.v9)((function(e){return e.auth.isPrivilegedUser})),re=(0,i.Ac)(y.FeatureGateConstants.SAAS_FEATURES_IDENTIFIER);(0,c.useEffect)((function(){ee(D||{})}),[D]);var le=function(e){"id"in e&&f.m8.push(T.UsersConstants.getPaths().get("COLLABORATOR_USER_EDIT_PATH").replace(":id",e.id)),"value"in e&&f.m8.push(T.UsersConstants.getPaths().get("COLLABORATOR_USER_EDIT_PATH").replace(":id",e.value))},ce=function(e){var t;return n===T.AdminAccountTypes.EXTERNAL&&(null===(t=e[E.SCIMConfigs.scim.enterpriseSchema])||void 0===t?void 0:t.userAccountType)===T.UserAccountTypes.OWNER?c.createElement(g.Z,{size:"small"},"Owner"):null},ue=function(e){return n===T.AdminAccountTypes.INTERNAL||(null==se?void 0:se.split("@").length)<3?null:(null==se?void 0:se.split("@").slice(0,2).join("@"))===(0,a.WX)(null==e?void 0:e.userName)?c.createElement(g.Z,{size:"small"},"Me"):null},de=function(){return k&&0===(null==J?void 0:J.totalResults)?c.createElement(l.$J,{action:c.createElement(l.Qj,{onClick:w},Q("console:manage.features.users.usersList.search.emptyResultPlaceholder.clearButton")),image:(0,f.jF)().emptySearch,imageSize:"tiny",title:Q("console:manage.features.users.usersList.search.emptyResultPlaceholder.title"),subtitle:[Q("console:manage.features.users.usersList.search.emptyResultPlaceholder.subTitle.0",{query:k}),Q("console:manage.features.users.usersList.search.emptyResultPlaceholder.subTitle.1")]}):0===(null==J?void 0:J.totalResults)?c.createElement(l.$J,{"data-componentid":"".concat(F,"-empty-placeholder"),image:(0,f.jF)().newList,imageSize:"tiny",subtitle:["There are no collaborator users associated with your organization at the moment."]}):null};return c.createElement(c.Fragment,null,c.createElement(l.wQ,{className:"users-table",externalSearch:U,isLoading:_,loadingStateOptions:{count:null!=C?C:f.ru.DEFAULT_RESOURCE_LIST_ITEM_LIMIT,imageType:"circular"},actions:function(){if(V){var e=[{"data-componentid":"administrators-list-item-edit-button",hidden:function(){return!(0,a.cr)(null==N?void 0:N.users,h._F.FEATURE_DICTIONARY.get("USER_READ"))},icon:function(e){var t,i,s,o,r=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(i=e.userName)||void 0===i?void 0:i.split("/")[0]:"PRIMARY";return!(0,a.hasRequiredScopes)(null==N?void 0:N.users,null==N||null===(s=N.users)||void 0===s||null===(o=s.scopes)||void 0===o?void 0:o.update,ae)||!(0,a.cr)(null==N?void 0:N.users,h._F.FEATURE_DICTIONARY.get("USER_UPDATE"))||null!=O&&O.includes(r.toString())||n===T.AdminAccountTypes.EXTERNAL?"eye":"pencil alternate"},onClick:function(e,n){return le(n)},popupText:function(e){var t,i,s,o,r=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(i=e.userName)||void 0===i?void 0:i.split("/")[0]:"PRIMARY";return!(0,a.hasRequiredScopes)(null==N?void 0:N.users,null==N||null===(s=N.users)||void 0===s||null===(o=s.scopes)||void 0===o?void 0:o.update,ae)||!(0,a.cr)(null==N?void 0:N.users,h._F.FEATURE_DICTIONARY.get("USER_UPDATE"))||null!=O&&O.includes(r.toString())||n===T.AdminAccountTypes.EXTERNAL?Q("common:view"):Q("common:edit")},renderer:"semantic-icon"}];return e.push({"data-componentid":"administrators-list-item-delete-button",hidden:function(e){var t,i,o,r,l=(null==e||null===(t=e.userName)||void 0===t?void 0:t.split("/").length)>1?null==e||null===(i=e.userName)||void 0===i?void 0:i.split("/")[0]:s.ss.PRIMARY_USER_STORE;return!(0,a.cr)(null==N?void 0:N.users,h._F.FEATURE_DICTIONARY.get("USER_DELETE"))||oe||!(0,a.hasRequiredScopes)(null==N?void 0:N.users,null==N||null===(o=N.users)||void 0===o||null===(r=o.scopes)||void 0===r?void 0:r.delete,ae)||(null==O?void 0:O.includes(l.toString()))||n===T.AdminAccountTypes.EXTERNAL&&((0,a.WX)(null==e?void 0:e.userName)===(null==M?void 0:M.adminUser)||(null==se?void 0:se.includes((0,a.WX)(null==e?void 0:e.userName))))||x===T.GUEST_ADMIN_ASSOCIATION_TYPE},icon:function(){return"trash alternate"},onClick:function(e,n){z(!0),X(n)},popupText:function(){return Q("console:manage.features.users.usersList.list.iconPopups.delete")},renderer:"semantic-icon"}),e}}(),columns:function(){var e=[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){var n,t,i,s=R.UserManagementUtils.resolveUserListHeader(e),a=R.UserManagementUtils.resolveUserListSubheader(e),o=void 0!==(null===(n=e.name)||void 0===n?void 0:n.familyName)||void 0!==(null===(t=e.name)||void 0===t?void 0:t.givenName);return c.createElement(m.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentid":"".concat(F,"-item-heading")},c.createElement(l.Yt,{"data-componentid":"users-list-item-image",name:(null===(i=e.userName.split("/"))||void 0===i?void 0:i.length)>1?e.userName.split("/")[1]:e.userName.split("/")[0],size:"mini",image:e.profileUrl,spaced:"right","data-hj-suppress":""}),c.createElement(m.Z.Content,null,s,ce(e),ue(e),o&&c.createElement(m.Z.Subheader,{"data-componentid":"".concat(F,"-item-sub-heading")},a)))},title:"User"}];if(re===i.iK.ENABLED){var t={allowToggleVisibility:!1,dataIndex:"idpType",id:"idpType",key:"idpType",render:function(e){var n,t,i,s;return null!==(n=e[E.SCIMConfigs.scim.enterpriseSchema])&&void 0!==n&&n.idpType?(null===(t=e[E.SCIMConfigs.scim.enterpriseSchema])||void 0===t?void 0:t.idpType.split("/").length)>1?null===(s=e[E.SCIMConfigs.scim.enterpriseSchema])||void 0===s?void 0:s.idpType.split("/")[1]:null===(i=e[E.SCIMConfigs.scim.enterpriseSchema])||void 0===i?void 0:i.idpType:"N/A"},title:c.createElement(c.Fragment,null,c.createElement("div",{className:"header-with-popup"},c.createElement("span",null,Q("extensions:manage.users.list.columns.idpType")),c.createElement(l.GI,{trigger:c.createElement("div",{className:"inline"},c.createElement(p.Z,{disabled:!0,name:"info circle",className:"link pointing pl-1"})),content:Q("extensions:manage.users.list.popups.content.idpTypeContent"),position:"top center",size:"mini",hideOnScroll:!0,inverted:!0})))};e.push(t)}e.push({allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:""});var s=[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){var n,t=(null===(n=e.display.split("/"))||void 0===n?void 0:n.length)>1?e.display.split("/")[1]:e.display.split("/")[0];return c.createElement(m.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentid":"".concat(F,"-item-heading")},c.createElement(l.Yt,{"data-componentid":"users-list-item-image",name:t,size:"mini",spaced:"right","data-hj-suppress":""}),c.createElement(m.Z.Content,null,t))},title:"User"},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:""}];return n===T.AdminAccountTypes.INTERNAL?s:e}(),data:J.Resources,onColumnSelectionChange:L,onRowClick:function(e,n){le(n),b&&b(e,n)},placeholders:de(),selectable:P,showHeader:re===i.iK.ENABLED,transparent:!_&&null!==de(),"data-componentid":F}),H&&c.createElement(l.cV,{primaryActionLoading:te,"data-componentid":"".concat(F,"-confirmation-modal"),onClose:function(){return z(!1)},type:"negative",open:Z,assertionHint:Q("console:manage.features.user.deleteUser.confirmationModal.assertionHint"),assertionType:"checkbox",primaryAction:"Confirm",secondaryAction:"Cancel",onSecondaryActionClick:function(){z(!1),W(null)},onPrimaryActionClick:function(){ie(!0),function(e){var n,i,s=null!==(n=e[E.SCIMConfigs.scim.enterpriseSchema])&&void 0!==n&&n.userAccountType?null===(i=e[E.SCIMConfigs.scim.enterpriseSchema])||void 0===i?void 0:i.userAccountType:T.UserAccountTypes.CUSTOMER;if(s===T.UserAccountTypes.COLLABORATOR&&"id"in e)return(0,A.deleteGuestUser)(e.id).then((function(){j((0,r.V_)({description:Q("console:manage.features.invite.notifications.deleteInvite.success.description"),level:o.QU.SUCCESS,message:Q("console:manage.features.users.notifications.deleteUser.success.message")})),I()})).catch((function(e){e.response&&e.response.data&&e.response.data.description?j((0,r.V_)({description:e.response.data.description,level:o.QU.ERROR,message:Q("console:manage.features.users.notifications.deleteUser.error.message")})):j((0,r.V_)({description:Q("console:manage.features.users.notifications.deleteUser.genericError.description"),level:o.QU.ERROR,message:Q("console:manage.features.users.notifications.deleteUser.genericError.message")}))})).finally((function(){ie(!1),z(!1),X(void 0)}));if(s===T.UserAccountTypes.CUSTOMER&&"display"in e){var a={Operations:[{op:"remove",path:"users[display eq ".concat(e.display,"]"),value:{}}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]};return(0,v.dB)(t,a).then((function(){j((0,r.V_)({description:Q("console:manage.features.invite.notifications.deleteInvite.success.description"),level:o.QU.SUCCESS,message:Q("console:manage.features.users.notifications.deleteUser.success.message")})),I()})).catch((function(e){e.response&&e.response.data&&e.response.data.description?j((0,r.V_)({description:e.response.data.description,level:o.QU.ERROR,message:Q("console:manage.features.users.notifications.deleteUser.error.message")})):j((0,r.V_)({description:Q("console:manage.features.users.notifications.deleteUser.genericError.description"),level:o.QU.ERROR,message:Q("console:manage.features.users.notifications.deleteUser.genericError.message")}))})).finally((function(){ie(!1),z(!1),X(void 0)}))}if(s===T.UserAccountTypes.CUSTOMER&&"id"in e){var l={Operations:[{op:"remove",path:"users[value eq ".concat(e.id,"]"),value:{}}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]};(0,v.dB)(t,l).then((function(){j((0,r.V_)({description:Q("console:manage.features.users.notifications.revokeAdmin.success.description"),level:o.QU.SUCCESS,message:Q("console:manage.features.users.notifications.revokeAdmin.success.message")})),I()})).catch((function(e){e.response&&e.response.data&&e.response.data.description?j((0,r.V_)({description:e.response.data.description,level:o.QU.ERROR,message:Q("console:manage.features.users.notifications.revokeAdmin.error.message")})):j((0,r.V_)({description:Q("console:manage.features.users.notifications.revokeAdmin.genericError.description"),level:o.QU.ERROR,message:Q("console:manage.features.users.notifications.revokeAdmin.genericError.message")}))})).finally((function(){ie(!1),z(!1),X(void 0)}))}}(H)},closeOnDimmerClick:!1},c.createElement(l.cV.Header,{"data-componentid":"".concat(F,"-confirmation-modal-header")},Q("console:manage.features.user.deleteUser.confirmationModal.header")),c.createElement(l.cV.Message,{"data-componentid":"".concat(F,"-confirmation-modal-message"),attached:!0,negative:!0},Q("extensions:manage.guest.deleteUser.confirmationModal.message")),c.createElement(l.cV.Content,{"data-componentid":"".concat(F,"-confirmation-modal-content")},c.createElement("div",{className:"modal-alert-wrapper"}," ",G&&$),Q("extensions:manage.guest.deleteUser.confirmationModal.content"))))};C.defaultProps={selection:!0,showListItemActions:!0,showMetaContent:!0}}}]);