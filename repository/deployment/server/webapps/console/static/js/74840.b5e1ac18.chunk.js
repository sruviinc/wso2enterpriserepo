"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[74840],{74840:(e,t,n)=>{n.r(t),n.d(t,{CreateGroupWizard:()=>P});var r,o=n(14603),a=n(90268),i=n(13318),s=n(81816),l=n(99285),u=n(52983),c=n(9202),d=n(54221),f=n(21921),m=n(94635),p=n(74691),g=n(88171),v=n(81677),S=n(30640),b=n(27696),y=n(79232),h=n(13091),E=n(41487),A=n(49238),R=n(63793),C=n(99839);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==I(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===I(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,s=[],l=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw o}}return s}}(e,t)||U(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}!function(e){e.BASIC_DETAILS="BasicDetails",e.SUMMARY="summary"}(r||(r={}));var P=function(e){var t,n,I=e.closeWizard,O=e.initStep,j=e.requiredSteps,P=e.showStepper,B=e.submitStep,M=e["data-testid"],T=(0,c.$)().t,L=(0,d.I0)(),z=_((0,u.useState)(O),2),G=z[0],N=z[1],k=_((0,u.useState)(void 0),2),Z=k[0],Q=k[1],W=_((0,u.useState)(void 0),2),Y=W[0],x=W[1],V=_((0,u.useState)(void 0),2),q=V[0],F=V[1],K=_((0,u.useState)(null!==R.commonConfig&&void 0!==R.commonConfig&&R.commonConfig.primaryUserstoreOnly?C.PRIMARY_USERSTORE:C.CONSUMER_USERSTORE),2),$=K[0],H=K[1],X=_((0,u.useState)(!1),2),J=X[0],ee=X[1],te=_((0,i.cC)(),2),ne=te[0],re=te[1],oe=_((0,i.cC)(),2),ae=oe[0],ie=oe[1],se=_((0,u.useState)(!1),2),le=se[0],ue=se[1],ce=_((0,u.useState)(!0),2),de=ce[0],fe=ce[1],me=_((0,s.IK)(),3),pe=me[0],ge=me[1],ve=me[2],Se=b.lD.getInstance();(0,u.useEffect)((function(){F(Ae([r.BASIC_DETAILS,r.SUMMARY]))}),[]),(0,u.useEffect)((function(){void 0!==Z&&(N(G-1),Q(void 0))}),[Z]),(0,u.useEffect)((function(){le&&Y&&Y[r.BASIC_DETAILS]&&be(Y[r.BASIC_DETAILS])}),[Y&&Y[r.BASIC_DETAILS]]);var be=function(e){var t,n,r,i,s,l,u,c="";c="primary"!==(null==e?void 0:e.domain)?null!=e&&e.BasicDetails.basic?(null==e||null===(t=e.BasicDetails)||void 0===t||null===(n=t.basic)||void 0===n?void 0:n.domain)+"/"+(null==e||null===(r=e.BasicDetails)||void 0===r||null===(i=r.basic)||void 0===i?void 0:i.groupName):(null==e?void 0:e.domain)+"/"+(null==e?void 0:e.groupName):null!=e&&null!==(s=e.BasicDetails)&&void 0!==s&&s.basic?null==e||null===(l=e.BasicDetails)||void 0===l?void 0:l.groupName:null==e?void 0:e.groupName;var d=[],f=null==e||null===(u=e.BasicDetails)||void 0===u?void 0:u.users;(null==f?void 0:f.length)>0&&(null==f||f.forEach((function(e){null==d||d.push({display:e.userName,value:e.id})})));var m={displayName:c,members:d,schemas:["urn:ietf:params:scim:schemas:core:2.0:Group"]};ee(!0),(0,y.sS)(m).then((function(t){if(201===t.status){var n,r,i=t.data,s=[];if(null!=e&&null!==(n=e.RoleList)&&void 0!==n&&n.roles)null==e||null===(r=e.RoleList)||void 0===r||r.roles.forEach((function(e){null==s||s.push(e.id)}));var l={Operations:[{op:"add",value:{groups:[{display:i.displayName,value:i.id}]}}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]};if(s&&s.length>0){var u,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=U(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw a}}}}(s);try{for(c.s();!(u=c.n()).done;){var d=u.value;(0,A.ul)(d,l).catch((function(e){e.response&&401!==e.response.status?e.response&&e.response.data.detail?ge({description:T("console:manage.features.groups.notifications.createPermission.error.description",{description:e.response.data.detail}),level:o.QU.ERROR,message:T("console:manage.features.groups.notifications.createPermission.error.message")}):ge({description:T("console:manage.features.groups.notifications.createPermission.genericError.description"),level:o.QU.ERROR,message:T("console:manage.features.groups.notifications.createPermission.genericError.message")}):ge({description:T("console:manage.features.groups.notifications.createPermission.error.description"),level:o.QU.ERROR,message:T("console:manage.features.groups.notifications.createPermission.error.message")})}))}}catch(f){c.e(f)}finally{c.f()}}L((0,a.V_)({description:T("console:manage.features.groups.notifications.createGroup.success.description"),level:o.QU.SUCCESS,message:T("console:manage.features.groups.notifications.createGroup.success.message")}))}I(),S.m8.push(S.$x.getPaths().get("GROUP_EDIT").replace(":id",t.data.id))})).catch((function(e){e.response&&401!==e.response.status?e.response&&e.response.data.detail?(I(),L((0,a.V_)({description:T("console:manage.features.groups.notifications.createGroup.error.description",{description:e.response.data.detail}),level:o.QU.ERROR,message:T("console:manage.features.groups.notifications.createGroup.error.message")}))):(I(),L((0,a.V_)({description:T("console:manage.features.groups.notifications.createGroup.genericError.description"),level:o.QU.ERROR,message:T("console:manage.features.groups.notifications.createGroup.genericError.message")}))):(I(),L((0,a.V_)({description:T("console:manage.features.groups.notifications.createGroup.error.description"),level:o.QU.ERROR,message:T("console:manage.features.groups.notifications.createGroup.error.message")})))})).finally((function(){ee(!1)}))},ye=function(e){Se.publish("manage-groups-finish-create-new-group"),be(e)},he=function(){if(Y)return Y},Ee=function(){switch(G){case 0:re();break;case 1:ie()}},Ae=function(e){var t=function(e){var t=[];return e.forEach((function(e){e===r.BASIC_DETAILS?t.push(Re()):e===r.SUMMARY&&t.push(Ce())})),t};return t(j?(0,l.Z)(e,j):e)},Re=function(){return{content:u.createElement(u.Fragment,null,u.createElement(v.AddGroupUsers,{"data-testid":"new-group",isEdit:!1,triggerSubmit:ne,userStore:$,initialValues:Y&&Y[r.BASIC_DETAILS],onSubmit:function(e){return function(e,t){r.BASIC_DETAILS===t&&H(e.basic.domain),B===t||le||N(G+1),x(w(w({},Y),{},D({},t,e))),B===r.SUMMARY||B!==t||ye(w(w({},Y),{},D({},t,e)))}(e,r.BASIC_DETAILS)},onUserFetchRequestFinish:function(){return fe(!1)}})),icon:(0,E.i)().general,name:r.BASIC_DETAILS,title:T("console:manage.features.roles.addRoleWizard.wizardSteps.0")}},Ce=function(){return{content:u.createElement(h.EG,{"data-testid":"add-group-summary",triggerSubmit:ae,onSubmit:function(){return ye(Y)},summary:he()}),icon:(0,E.i)().summary,name:r.SUMMARY,title:T("console:manage.features.roles.addRoleWizard.wizardSteps.3")}};return u.createElement(f.Z,{open:!0,className:"wizard create-role-wizard",dimmer:"blurring",size:"small",onClose:I,closeOnDimmerClick:!1,closeOnEscape:!1,"data-testid":M},u.createElement(f.Z.Header,{className:"wizard-header"},T("console:manage.features.roles.addRoleWizard.heading",{type:"Group"}),Y&&null!==(t=Y[r.BASIC_DETAILS])&&void 0!==t&&t.groupName?" - "+(null===(n=Y[r.BASIC_DETAILS])||void 0===n?void 0:n.groupName):"",u.createElement(s.X6,{as:"h6"},"Create new group and add users to the group.")),P&&u.createElement(f.Z.Content,{className:"steps-container"},u.createElement(s.Rg.Group,{current:G},null==q?void 0:q.map((function(e,t){return u.createElement(s.Rg.Step,{key:t,icon:e.icon,title:e.title})})))),u.createElement(f.Z.Content,{className:"content-container",scrolling:!0},pe&&ve,function(){var e,t,n;if(!q)return null;switch(null===(e=q[G])||void 0===e?void 0:e.name){case r.BASIC_DETAILS:return null===(t=Re())||void 0===t?void 0:t.content;case r.SUMMARY:return null===(n=Ce())||void 0===n?void 0:n.content}}()),u.createElement(f.Z.Actions,null,u.createElement(m.Z,null,u.createElement(m.Z.Row,{column:1},u.createElement(m.Z.Column,{mobile:8,tablet:8,computer:8},u.createElement(s.Qj,{floated:"left",onClick:function(){return I()},"data-testid":"".concat(M,"-cancel-button")},T("common:cancel"))),u.createElement(m.Z.Column,{mobile:8,tablet:8,computer:8},G<(null==q?void 0:q.length)-1&&u.createElement(s.KM,{floated:"right",onClick:Ee,disabled:de,"data-testid":"".concat(M,"-next-button")},T("console:manage.features.roles.addRoleWizard.buttons.next"),u.createElement(p.Z,{name:"arrow right","data-testid":"".concat(M,"-next-button-icon")})),(null==q?void 0:q.length)>1&&0===G&&u.createElement(g.Z,{basic:!0,color:"orange",floated:"right",onClick:function(){ue(!0),re()},disabled:de,"data-testid":"".concat(M,"-initial-finish-button")},T("console:manage.features.roles.addRoleWizard.buttons.finish")),G===(null==q?void 0:q.length)-1&&u.createElement(s.KM,{floated:"right",onClick:Ee,"data-testid":"".concat(M,"-finish-button"),disabled:de||J,loading:J},T("console:manage.features.roles.addRoleWizard.buttons.finish")),(null==q?void 0:q.length)>1&&G>0&&u.createElement(s.Qj,{floated:"right",onClick:function(){Q(G)},"data-testid":"".concat(M,"-previous-button"),disabled:de},u.createElement(p.Z,{name:"arrow left","data-testid":"".concat(M,"-previous-button-icon")}),T("console:manage.features.roles.addRoleWizard.buttons.previous")))))))};P.defaultProps={initStep:0,requiredSteps:[r.BASIC_DETAILS,r.SUMMARY],showStepper:!1,submitStep:r.SUMMARY}}}]);